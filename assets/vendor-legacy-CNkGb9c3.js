!function(){function t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function e(e){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?t(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function n(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}System.register(["./maplibre-gl-legacy-9BsVnyDE.js"],(function(t,n){"use strict";var r,i;return{setters:[t=>{r=t.g,i=t.a}],execute:function(){t({$:function(t,e){e||(e={});var n,r,i,s=e.vargs||function(t){var e=t+"",n=e.indexOf("...");return n>=0&&(n<e.indexOf(")")||e.indexOf("arguments")>=0)}(t),o=[],a=new Map,u=e.maxAge>0&&e.maxAge<1/0?function(t){return r=setTimeout((function(){n?a.delete(t):o.splice(t,1)}),e.maxAge)}:0,c=e.equals?e.equals:0,l=e.maxArgs,h=e.serializer;1!==t.length||e.equals||s?i=c?function(){for(var e=l||arguments.length,n=o.length,r=-1;++r<n;)if(o[r].length===e){for(var i=-1;++i<e&&c(arguments[i],o[r][i]););if(i===e)return o[r].val}return o[r]=arguments,!u||u(r),arguments.val=t.apply(this,o[r])}:function(){for(var e=l||arguments.length,n=o.length,r=-1;++r<n;)if(o[r].length===e){for(var i=-1;++i<e&&arguments[i]===o[r][i];);if(i===e)return o[r].val}return o[r]=arguments,!u||u(r),arguments.val=t.apply(this,o[r])}:(i=function(e){var n;return h&&(e=h(e)),a.get(e)||(!u||u(e),a.set(e,n=t.call(this,e)),n)},n=1);return i.clear=function(){r&&clearTimeout(r),a.clear(),o=[]},i.keys=function(){return n?[...a.keys()]:o.slice()},i.values=function(){return n?[...a.values()]:o.map((t=>t.val))},i},E:H,a:function(t,e,...n){if(t=yr(t),t instanceof qh){const r=Fs.fromString(e,...n);return Mh(r),new Hh(t,null,r)}{if(!(t instanceof zh||t instanceof Hh))throw new ps(ds.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Fs.fromString(e,...n));return Mh(r),new Hh(t.firestore,null,r)}},c:function(){var t=1,e=1,n=Mn,r=a;function i(t){var e=n(t);if(Array.isArray(e))e=e.slice().sort(Fn);else{const n=function(t,e){let n,r;if(void 0===e)for(const i of t)null!=i&&(void 0===n?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let s of t)null!=(s=e(s,++i,t))&&(void 0===n?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)))}return[n,r]}(t,Hn);for(e=function(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,s,o]=r?Pn(e,t,n):Pn(t,e,n);if(!(s>=i))return[];const a=s-i+1,u=new Array(a);if(r)if(o<0)for(let c=0;c<a;++c)u[c]=(s-c)/-o;else for(let c=0;c<a;++c)u[c]=(s-c)*o;else if(o<0)for(let c=0;c<a;++c)u[c]=(i+c)/-o;else for(let c=0;c<a;++c)u[c]=(i+c)*o;return u}(...function(t,e,n){let r;for(;;){const i=Ln(t,e,n);if(i===r||0===i||!isFinite(i))return[t,e];i>0?(t=Math.floor(t/i)*i,e=Math.ceil(e/i)*i):i<0&&(t=Math.ceil(t*i)/i,e=Math.floor(e*i)/i),r=i}}(n[0],n[1],e),e);e[e.length-1]>=n[1];)e.pop();for(;e[1]<n[0];)e.shift()}return e.map((e=>s(t,e)))}function s(n,i){const s=null==i?NaN:+i;if(isNaN(s))throw new Error(`invalid value: ${i}`);var a=[],u=[];return function(n,r,i){var s,a,u,c,l,h,f=new Array,d=new Array;s=a=-1,c=Gn(n[0],r),zn[c<<1].forEach(p);for(;++s<t-1;)u=c,c=Gn(n[s+1],r),zn[u|c<<1].forEach(p);zn[c|0].forEach(p);for(;++a<e-1;){for(s=-1,c=Gn(n[a*t+t],r),l=Gn(n[a*t],r),zn[c<<1|l<<2].forEach(p);++s<t-1;)u=c,c=Gn(n[a*t+t+s+1],r),h=l,l=Gn(n[a*t+s+1],r),zn[u|c<<1|l<<2|h<<3].forEach(p);zn[c|l<<3].forEach(p)}s=-1,l=n[a*t]>=r,zn[l<<2].forEach(p);for(;++s<t-1;)h=l,l=Gn(n[a*t+s+1],r),zn[l<<2|h<<3].forEach(p);function p(t){var e,n,r=[t[0][0]+s,t[0][1]+a],u=[t[1][0]+s,t[1][1]+a],c=o(r),l=o(u);(e=d[c])?(n=f[l])?(delete d[e.end],delete f[n.start],e===n?(e.ring.push(u),i(e.ring)):f[e.start]=d[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete d[e.end],e.ring.push(u),d[e.end=l]=e):(e=f[l])?(n=d[c])?(delete f[e.start],delete d[n.end],e===n?(e.ring.push(u),i(e.ring)):f[n.start]=d[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete f[e.start],e.ring.unshift(r),f[e.start=c]=e):f[c]=d[l]={start:c,end:l,ring:[r,u]}}zn[l<<3].forEach(p)}(n,s,(function(t){r(t,n,s),function(t){var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];for(;++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?a.push([t]):u.push(t)})),u.forEach((function(t){for(var e,n=0,r=a.length;n<r;++n)if(-1!==jn((e=a[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:i,coordinates:a}}function o(e){return 2*e[0]+e[1]*(t+1)*4}function a(n,r,i){n.forEach((function(n){var s=n[0],o=n[1],a=0|s,u=0|o,c=Kn(r[u*t+a]);s>0&&s<t&&a===s&&(n[0]=Qn(s,Kn(r[u*t+a-1]),c,i)),o>0&&o<e&&u===o&&(n[1]=Qn(o,Kn(r[(u-1)*t+a]),c,i))}))}return i.contour=s,i.size=function(n){if(!arguments.length)return[t,e];var r=Math.floor(n[0]),s=Math.floor(n[1]);if(!(r>=0&&s>=0))throw new Error("invalid size");return t=r,e=s,i},i.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?Un(Vn.call(t)):Un(t),i):n},i.smooth=function(t){return arguments.length?(r=t?a:$n,i):r===a},i},d:lt,f:function(t,e,n={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Yn(t[0])||!Yn(t[1]))throw new Error("coordinates must contain numbers");return Wn({type:"Point",coordinates:t},e,n)},g:function(t,e){const n="object"==typeof t?t:function(t=wi){const e=Ei.get(t);if(!e&&t===wi&&or())return Ni();if(!e)throw Ai.create("no-app",{appName:t});return e}(),r="string"==typeof t?t:So,i=function(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});n&&n.triggerHeartbeat();return t.container.getProvider(e)}(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const t=sr("firestore");t&&function(t,e,n,r={}){var i;t=Fh(t,qh);const s=ur(e),o=t._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),u=`${e}:${n}`;s&&(async function(t){(await fetch(t,{credentials:"include"})).ok}(`https://${u}`),function(t,e){if("undefined"==typeof window||"undefined"==typeof document||!ur(window.location.host)||cr[t]===e||cr[t]||lr)return;function n(t){return`__firebase__banner__${t}`}cr[t]=e;const r="__firebase__banner",i=function(){const t={prod:[],emulator:[]};for(const e of Object.keys(cr))cr[e]?t.emulator.push(e):t.prod.push(e);return t}().prod.length>0;function s(){const t=document.getElementById(r);t&&t.remove()}function o(t){t.style.display="flex",t.style.background="#7faaf0",t.style.position="fixed",t.style.bottom="5px",t.style.left="5px",t.style.padding=".5em",t.style.borderRadius="5px",t.style.alignItems="center"}function a(t,e){t.setAttribute("width","24"),t.setAttribute("id",e),t.setAttribute("height","24"),t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("fill","none"),t.style.marginLeft="-6px"}function u(){const t=document.createElement("span");return t.style.cursor="pointer",t.style.marginLeft="16px",t.style.fontSize="24px",t.innerHTML=" &times;",t.onclick=()=>{lr=!0,s()},t}function c(t,e){t.setAttribute("id",e),t.innerText="Learn more",t.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",t.setAttribute("target","__blank"),t.style.paddingLeft="5px",t.style.textDecoration="underline"}function l(){const t=function(t){let e=document.getElementById(t),n=!1;e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0);return{created:n,element:e}}(r),e=n("text"),s=document.getElementById(e)||document.createElement("span"),l=n("learnmore"),h=document.getElementById(l)||document.createElement("a"),f=n("preprendIcon"),d=document.getElementById(f)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(t.created){const e=t.element;o(e),c(h,l);const n=u();a(d,f),e.append(d,s,h,n),document.body.appendChild(e)}i?(s.innerText="Preview backend disconnected.",d.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(d.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',s.innerText="Preview backend running in this workspace."),s.setAttribute("id",e)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",l):l()}("Firestore",!0)),o.host!==Uh&&o.host!==u&&as("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},o),{host:u,ssl:s,emulatorOptions:r});if(!gr(c,a)&&(t._setSettings(c),r.mockUserToken)){let e,n;if("string"==typeof r.mockUserToken)e=r.mockUserToken,n=es.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[er(JSON.stringify(n)),er(JSON.stringify(o)),a].join(".")}(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new ps(ds.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new es(s)}t._authCredentials=new _s(new ms(e,n))}}(i,...t)}return i},h:function(t,e={}){const n={type:"FeatureCollection"};e.id&&(n.id=e.id);e.bbox&&(n.bbox=e.bbox);return n.features=t,n},i:Ni,j:function(t,...e){var n,r,i;t=yr(t);let s={includeMetadataChanges:!1,source:"default"},o=0;"object"!=typeof e[o]||Wh(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Wh(e[o])){const t=e[o];e[o]=null===(n=t.next)||void 0===n?void 0:n.bind(t),e[o+1]=null===(r=t.error)||void 0===r?void 0:r.bind(t),e[o+2]=null===(i=t.complete)||void 0===i?void 0:i.bind(t)}let u,c,l;if(t instanceof zh)c=Fh(t.firestore,Yh),l=Ta(t._key.path),u={next:n=>{e[o]&&e[o](function(t,e,n){const r=n.docs.get(e._key),i=new Nf(t);return new Sf(t,i,e._key,r,new Cf(n.hasPendingWrites,n.fromCache),e.converter)}(c,t,n))},error:e[o+1],complete:e[o+2]};else{const n=Fh(t,$h);c=Fh(n.firestore,Yh),l=n._query;const r=new Nf(c);u={next:t=>{e[o]&&e[o](new Af(c,r,n,t))},error:e[o+1],complete:e[o+2]},function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new ps(ds.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query)}return function(t,e,n,r){const i=new Dh(r),s=new th(e,i,n);return t.asyncQueue.enqueueAndForget((async()=>async function(t,e){const n=fs(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.Da()&&e.va()&&(r=2):(s=new Gl,r=e.va()?0:1);try{switch(r){case 0:s.ba=await n.onListen(i,!0);break;case 1:s.ba=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(t){const n=ql(t,`Initialization of query '${Oa(e.query)}' failed`);return void e.onError(n)}n.queries.set(i,s),s.Sa.push(e),e.Fa(n.onlineState),s.ba&&e.Ma(s.ba)&&Xl(n)}(await Rh(t),s))),()=>{i.xu(),t.asyncQueue.enqueueAndForget((async()=>async function(t,e){const n=fs(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const t=s.Sa.indexOf(e);t>=0&&(s.Sa.splice(t,1),0===s.Sa.length?i=e.va()?0:1:!s.Da()&&e.va()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}(await Rh(t),s)))}}(function(t){if(t._terminated)throw new ps(ds.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||function(t){var e,n,r;const i=t._freezeSettings(),s=function(t,e,n,r){return new Co(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Ph(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new kh(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(t){const e=null==t?void 0:t._online.build();return{_offline:null==t?void 0:t._offline.build(e),_online:e}}(t._componentsProvider))}(t),t._firestoreClient}(c),l,a,u)},l:function(t){return vf._create("limit",t,"F")},o:function(t,e="asc"){const n=e,r=df("orderBy",t);return _f._create(r,n)},p:function(t,e,n={}){for(const r of t){if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(r[r.length-1].length!==r[0].length)throw new Error("First and last Position are not equivalent.");for(let t=0;t<r[r.length-1].length;t++)if(r[r.length-1][t]!==r[0][t])throw new Error("First and last Position are not equivalent.")}return Wn({type:"Polygon",coordinates:t},e,n)},q:function(t,e,...n){let r=[];e instanceof pf&&r.push(e),r=r.concat(n),function(t){const e=t.filter((t=>t instanceof yf)).length,n=t.filter((t=>t instanceof mf)).length;if(e>1||e>0&&n>0)throw new ps(ds.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t},r:function(t,e=0){if(e&&!(e>=0))throw new Error("precision must be a positive number");const n=Math.pow(10,e||0);return Math.round(t*n)/n},u:function(t,e,n,r,i,o){e||(e={});var a,u,c=e;if("ref"in c)for(u in c={},e)"ref"==u?a=e[u]:c[u]=e[u];var l={type:t,props:c,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--W,__i:-1,__u:0,__source:i,__self:o};if("function"==typeof t&&(a=t.defaultProps))for(u in a)void 0===c[u]&&(c[u]=a[u]);return s.vnode&&s.vnode(l),l},y:ft});var n,s,o,a,u,c,l,h,f,d,p,g,m={},y=[],_=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,v=Array.isArray;function w(t,e){for(var n in e)t[n]=e[n];return t}function b(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function E(t,e,r){var i,s,o,a={};for(o in e)"key"==o?i=e[o]:"ref"==o?s=e[o]:a[o]=e[o];if(arguments.length>2&&(a.children=arguments.length>3?n.call(arguments,2):r),"function"==typeof t&&null!=t.defaultProps)for(o in t.defaultProps)void 0===a[o]&&(a[o]=t.defaultProps[o]);return T(t,a,i,s,null)}function T(t,e,n,r,i){var a={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==i?++o:i,__i:-1,__u:0};return null==i&&null!=s.vnode&&s.vnode(a),a}function C(){return{current:null}}function S(t){return t.children}function I(t,e){this.props=t,this.context=e}function A(t,e){if(null==e)return t.__?A(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e)return n.__e;return"function"==typeof t.type?A(t):null}function D(t){var e,n;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e){t.__e=t.__c.base=n.__e;break}return D(t)}}function N(t){(!t.__d&&(t.__d=!0)&&a.push(t)&&!k.__r++||u!=s.debounceRendering)&&((u=s.debounceRendering)||c)(k)}function k(){for(var t,e,n,r,i,o,u,c=1;a.length;)a.length>c&&a.sort(l),t=a.shift(),c=a.length,t.__d&&(n=void 0,i=(r=(e=t).__v).__e,o=[],u=[],e.__P&&((n=w({},r)).__v=r.__v+1,s.vnode&&s.vnode(n),F(e.__P,n,r,e.__n,e.__P.namespaceURI,32&r.__u?[i]:null,o,null==i?A(r):i,!!(32&r.__u),u),n.__v=r.__v,n.__.__k[n.__i]=n,U(o,n,u),n.__e!=i&&D(n)));k.__r=0}function x(t,e,n,r,i,s,o,a,u,c,l){var h,f,d,p,g,_,w=r&&r.__k||y,b=e.length;for(u=function(t,e,n,r,i){var s,o,a,u,c,l=n.length,h=l,f=0;for(t.__k=new Array(i),s=0;s<i;s++)null!=(o=e[s])&&"boolean"!=typeof o&&"function"!=typeof o?(u=s+f,(o=t.__k[s]="string"==typeof o||"number"==typeof o||"bigint"==typeof o||o.constructor==String?T(null,o,null,null,null):v(o)?T(S,{children:o},null,null,null):null==o.constructor&&o.__b>0?T(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=t,o.__b=t.__b+1,a=null,-1!=(c=o.__i=P(o,n,u,h))&&(h--,(a=n[c])&&(a.__u|=2)),null==a||null==a.__v?(-1==c&&(i>l?f--:i<l&&f++),"function"!=typeof o.type&&(o.__u|=4)):c!=u&&(c==u-1?f--:c==u+1?f++:(c>u?f--:f++,o.__u|=4))):t.__k[s]=null;if(h)for(s=0;s<l;s++)null!=(a=n[s])&&!(2&a.__u)&&(a.__e==r&&(r=A(a)),$(a,a));return r}(n,e,w,u,b),h=0;h<b;h++)null!=(d=n.__k[h])&&(f=-1==d.__i?m:w[d.__i]||m,d.__i=h,_=F(t,d,f,i,s,o,a,u,c,l),p=d.__e,d.ref&&f.ref!=d.ref&&(f.ref&&q(f.ref,null,d),l.push(d.ref,d.__c||p,d)),null==g&&null!=p&&(g=p),4&d.__u||f.__k===d.__k?u=O(d,u,t):"function"==typeof d.type&&void 0!==_?u=_:p&&(u=p.nextSibling),d.__u&=-7);return n.__e=g,u}function O(t,e,n){var r,i;if("function"==typeof t.type){for(r=t.__k,i=0;r&&i<r.length;i++)r[i]&&(r[i].__=t,e=O(r[i],e,n));return e}t.__e!=e&&(e&&t.type&&!n.contains(e)&&(e=A(t)),n.insertBefore(t.__e,e||null),e=t.__e);do{e=e&&e.nextSibling}while(null!=e&&8==e.nodeType);return e}function R(t,e){return e=e||[],null==t||"boolean"==typeof t||(v(t)?t.some((function(t){R(t,e)})):e.push(t)),e}function P(t,e,n,r){var i,s,o=t.key,a=t.type,u=e[n];if(null===u&&null==t.key||u&&o==u.key&&a==u.type&&!(2&u.__u))return n;if(r>(null==u||2&u.__u?0:1))for(i=n-1,s=n+1;i>=0||s<e.length;){if(i>=0){if((u=e[i])&&!(2&u.__u)&&o==u.key&&a==u.type)return i;i--}if(s<e.length){if((u=e[s])&&!(2&u.__u)&&o==u.key&&a==u.type)return s;s++}}return-1}function L(t,e,n){"-"==e[0]?t.setProperty(e,null==n?"":n):t[e]=null==n?"":"number"!=typeof n||_.test(e)?n:n+"px"}function M(t,e,n,r,i){var s,o;t:if("style"==e)if("string"==typeof n)t.style.cssText=n;else{if("string"==typeof r&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||L(t.style,e,"");if(n)for(e in n)r&&n[e]==r[e]||L(t.style,e,n[e])}else if("o"==e[0]&&"n"==e[1])s=e!=(e=e.replace(h,"$1")),o=e.toLowerCase(),e=o in t||"onFocusOut"==e||"onFocusIn"==e?o.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+s]=n,n?r?n.u=r.u:(n.u=f,t.addEventListener(e,s?p:d,s)):t.removeEventListener(e,s?p:d,s);else{if("http://www.w3.org/2000/svg"==i)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=e&&"height"!=e&&"href"!=e&&"list"!=e&&"form"!=e&&"tabIndex"!=e&&"download"!=e&&"rowSpan"!=e&&"colSpan"!=e&&"role"!=e&&"popover"!=e&&e in t)try{t[e]=null==n?"":n;break t}catch(t){}"function"==typeof n||(null==n||!1===n&&"-"!=e[4]?t.removeAttribute(e):t.setAttribute(e,"popover"==e&&1==n?"":n))}}function V(t){return function(e){if(this.l){var n=this.l[e.type+t];if(null==e.t)e.t=f++;else if(e.t<n.u)return;return n(s.event?s.event(e):e)}}}function F(t,e,n,r,i,o,a,u,c,l){var h,f,d,p,g,m,y,_,E,T,C,A,D,N,k,O,R,P=e.type;if(null!=e.constructor)return null;128&n.__u&&(c=!!(32&n.__u),o=[u=e.__e=n.__e]),(h=s.__b)&&h(e);t:if("function"==typeof P)try{if(_=e.props,E="prototype"in P&&P.prototype.render,T=(h=P.contextType)&&r[h.__c],C=h?T?T.props.value:h.__:r,n.__c?y=(f=e.__c=n.__c).__=f.__E:(E?e.__c=f=new P(_,C):(e.__c=f=new I(_,C),f.constructor=P,f.render=z),T&&T.sub(f),f.props=_,f.state||(f.state={}),f.context=C,f.__n=r,d=f.__d=!0,f.__h=[],f._sb=[]),E&&null==f.__s&&(f.__s=f.state),E&&null!=P.getDerivedStateFromProps&&(f.__s==f.state&&(f.__s=w({},f.__s)),w(f.__s,P.getDerivedStateFromProps(_,f.__s))),p=f.props,g=f.state,f.__v=e,d)E&&null==P.getDerivedStateFromProps&&null!=f.componentWillMount&&f.componentWillMount(),E&&null!=f.componentDidMount&&f.__h.push(f.componentDidMount);else{if(E&&null==P.getDerivedStateFromProps&&_!==p&&null!=f.componentWillReceiveProps&&f.componentWillReceiveProps(_,C),!f.__e&&null!=f.shouldComponentUpdate&&!1===f.shouldComponentUpdate(_,f.__s,C)||e.__v==n.__v){for(e.__v!=n.__v&&(f.props=_,f.state=f.__s,f.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some((function(t){t&&(t.__=e)})),A=0;A<f._sb.length;A++)f.__h.push(f._sb[A]);f._sb=[],f.__h.length&&a.push(f);break t}null!=f.componentWillUpdate&&f.componentWillUpdate(_,f.__s,C),E&&null!=f.componentDidUpdate&&f.__h.push((function(){f.componentDidUpdate(p,g,m)}))}if(f.context=C,f.props=_,f.__P=t,f.__e=!1,D=s.__r,N=0,E){for(f.state=f.__s,f.__d=!1,D&&D(e),h=f.render(f.props,f.state,f.context),k=0;k<f._sb.length;k++)f.__h.push(f._sb[k]);f._sb=[]}else do{f.__d=!1,D&&D(e),h=f.render(f.props,f.state,f.context),f.state=f.__s}while(f.__d&&++N<25);f.state=f.__s,null!=f.getChildContext&&(r=w(w({},r),f.getChildContext())),E&&!d&&null!=f.getSnapshotBeforeUpdate&&(m=f.getSnapshotBeforeUpdate(p,g)),O=h,null!=h&&h.type===S&&null==h.key&&(O=j(h.props.children)),u=x(t,v(O)?O:[O],e,n,r,i,o,a,u,c,l),f.base=e.__e,e.__u&=-161,f.__h.length&&a.push(f),y&&(f.__E=f.__=null)}catch(t){if(e.__v=null,c||null!=o)if(t.then){for(e.__u|=c?160:128;u&&8==u.nodeType&&u.nextSibling;)u=u.nextSibling;o[o.indexOf(u)]=null,e.__e=u}else for(R=o.length;R--;)b(o[R]);else e.__e=n.__e,e.__k=n.__k;s.__e(t,e,n)}else null==o&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):u=e.__e=B(n.__e,e,n,r,i,o,a,c,l);return(h=s.diffed)&&h(e),128&e.__u?void 0:u}function U(t,e,n){for(var r=0;r<n.length;r++)q(n[r],n[++r],n[++r]);s.__c&&s.__c(e,t),t.some((function(e){try{t=e.__h,e.__h=[],t.some((function(t){t.call(e)}))}catch(t){s.__e(t,e.__v)}}))}function j(t){return"object"!=typeof t||null==t||t.__b&&t.__b>0?t:v(t)?t.map(j):w({},t)}function B(t,e,r,i,o,a,u,c,l){var h,f,d,p,g,y,_,w=r.props,E=e.props,T=e.type;if("svg"==T?o="http://www.w3.org/2000/svg":"math"==T?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),null!=a)for(h=0;h<a.length;h++)if((g=a[h])&&"setAttribute"in g==!!T&&(T?g.localName==T:3==g.nodeType)){t=g,a[h]=null;break}if(null==t){if(null==T)return document.createTextNode(E);t=document.createElementNS(o,T,E.is&&E),c&&(s.__m&&s.__m(e,a),c=!1),a=null}if(null==T)w===E||c&&t.data==E||(t.data=E);else{if(a=a&&n.call(t.childNodes),w=r.props||m,!c&&null!=a)for(w={},h=0;h<t.attributes.length;h++)w[(g=t.attributes[h]).name]=g.value;for(h in w)if(g=w[h],"children"==h);else if("dangerouslySetInnerHTML"==h)d=g;else if(!(h in E)){if("value"==h&&"defaultValue"in E||"checked"==h&&"defaultChecked"in E)continue;M(t,h,null,g,o)}for(h in E)g=E[h],"children"==h?p=g:"dangerouslySetInnerHTML"==h?f=g:"value"==h?y=g:"checked"==h?_=g:c&&"function"!=typeof g||w[h]===g||M(t,h,g,w[h],o);if(f)c||d&&(f.__html==d.__html||f.__html==t.innerHTML)||(t.innerHTML=f.__html),e.__k=[];else if(d&&(t.innerHTML=""),x("template"==e.type?t.content:t,v(p)?p:[p],e,r,i,"foreignObject"==T?"http://www.w3.org/1999/xhtml":o,a,u,a?a[0]:r.__k&&A(r,0),c,l),null!=a)for(h=a.length;h--;)b(a[h]);c||(h="value","progress"==T&&null==y?t.removeAttribute("value"):null!=y&&(y!==t[h]||"progress"==T&&!y||"option"==T&&y!=w[h])&&M(t,h,y,w[h],o),h="checked",null!=_&&_!=t[h]&&M(t,h,_,w[h],o))}return t}function q(t,e,n){try{if("function"==typeof t){var r="function"==typeof t.__u;r&&t.__u(),r&&null==e||(t.__u=t(e))}else t.current=e}catch(t){s.__e(t,n)}}function $(t,e,n){var r,i;if(s.unmount&&s.unmount(t),(r=t.ref)&&(r.current&&r.current!=t.__e||q(r,null,e)),null!=(r=t.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(t){s.__e(t,e)}r.base=r.__P=null}if(r=t.__k)for(i=0;i<r.length;i++)r[i]&&$(r[i],e,n||"function"!=typeof t.type);n||b(t.__e),t.__c=t.__=t.__e=void 0}function z(t,e,n){return this.constructor(t,n)}function H(t,e,r){var i,o,a,u;e==document&&(e=document.documentElement),s.__&&s.__(t,e),o=(i="function"==typeof r)?null:r&&r.__k||e.__k,a=[],u=[],F(e,t=(!i&&r||e).__k=E(S,null,[t]),o||m,m,e.namespaceURI,!i&&r?[r]:o?null:e.firstChild?n.call(e.childNodes):null,a,!i&&r?r:o?o.__e:e.firstChild,i,u),U(a,t,u)}function G(t,e){H(t,e,G)}function K(t,e,r){var i,s,o,a,u=w({},t.props);for(o in t.type&&t.type.defaultProps&&(a=t.type.defaultProps),e)"key"==o?i=e[o]:"ref"==o?s=e[o]:u[o]=void 0===e[o]&&null!=a?a[o]:e[o];return arguments.length>2&&(u.children=arguments.length>3?n.call(arguments,2):r),T(t.type,u,i||t.key,s||t.ref,null)}function Q(t){function e(t){var n,r;return this.getChildContext||(n=new Set,(r={})[e.__c]=this,this.getChildContext=function(){return r},this.componentWillUnmount=function(){n=null},this.shouldComponentUpdate=function(t){this.props.value!=t.value&&n.forEach((function(t){t.__e=!0,N(t)}))},this.sub=function(t){n.add(t);var e=t.componentWillUnmount;t.componentWillUnmount=function(){n&&n.delete(t),e&&e.call(t)}}),t.children}return e.__c="__cC"+g++,e.__=t,e.Provider=e.__l=(e.Consumer=function(t,e){return t.children(e)}).contextType=e,e}n=y.slice,s={__e:function(t,e,n,r){for(var i,s,o;e=e.__;)if((i=e.__c)&&!i.__)try{if((s=i.constructor)&&null!=s.getDerivedStateFromError&&(i.setState(s.getDerivedStateFromError(t)),o=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(t,r||{}),o=i.__d),o)return i.__E=i}catch(e){t=e}throw t}},o=0,I.prototype.setState=function(t,e){var n;n=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=w({},this.state),"function"==typeof t&&(t=t(w({},n),this.props)),t&&w(n,t),null!=t&&this.__v&&(e&&this._sb.push(e),N(this))},I.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),N(this))},I.prototype.render=S,a=[],c="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,l=function(t,e){return t.__v.__b-e.__v.__b},k.__r=0,h=/(PointerCapture)$|Capture$/i,f=0,d=V(!1),p=V(!0),g=0;var W=0;var Y,X,J,Z,tt=0,et=[],nt=s,rt=nt.__b,it=nt.__r,st=nt.diffed,ot=nt.__c,at=nt.unmount,ut=nt.__;function ct(t,e){nt.__h&&nt.__h(X,t,tt||e),tt=0;var n=X.__H||(X.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function lt(t){return tt=1,ht(At,t)}function ht(t,e,n){var r=ct(Y++,2);if(r.t=t,!r.__c&&(r.__=[n?n(e):At(void 0,e),function(t){var e=r.__N?r.__N[0]:r.__[0],n=r.t(e,t);e!==n&&(r.__N=[n,r.__[1]],r.__c.setState({}))}],r.__c=X,!X.__f)){var i=function(t,e,n){if(!r.__c.__H)return!0;var i=r.__c.__H.__.filter((function(t){return!!t.__c}));if(i.every((function(t){return!t.__N})))return!s||s.call(this,t,e,n);var o=r.__c.props!==t;return i.forEach((function(t){if(t.__N){var e=t.__[0];t.__=t.__N,t.__N=void 0,e!==t.__[0]&&(o=!0)}})),s&&s.call(this,t,e,n)||o};X.__f=!0;var s=X.shouldComponentUpdate,o=X.componentWillUpdate;X.componentWillUpdate=function(t,e,n){if(this.__e){var r=s;s=void 0,i(t,e,n),s=r}o&&o.call(this,t,e,n)},X.shouldComponentUpdate=i}return r.__N||r.__}function ft(t,e){var n=ct(Y++,3);!nt.__s&&It(n.__H,e)&&(n.__=t,n.u=e,X.__H.__h.push(n))}function dt(t,e){var n=ct(Y++,4);!nt.__s&&It(n.__H,e)&&(n.__=t,n.u=e,X.__h.push(n))}function pt(t){return tt=5,mt((function(){return{current:t}}),[])}function gt(t,e,n){tt=6,dt((function(){if("function"==typeof t){var n=t(e());return function(){t(null),n&&"function"==typeof n&&n()}}if(t)return t.current=e(),function(){return t.current=null}}),null==n?n:n.concat(t))}function mt(t,e){var n=ct(Y++,7);return It(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function yt(t,e){return tt=8,mt((function(){return t}),e)}function _t(t){var e=X.context[t.__c],n=ct(Y++,9);return n.c=t,e?(null==n.__&&(n.__=!0,e.sub(X)),e.props.value):t.__}function vt(t,e){nt.useDebugValue&&nt.useDebugValue(e?e(t):t)}function wt(){var t=ct(Y++,11);if(!t.__){for(var e=X.__v;null!==e&&!e.__m&&null!==e.__;)e=e.__;var n=e.__m||(e.__m=[0,0]);t.__="P"+n[0]+"-"+n[1]++}return t.__}function bt(){for(var t;t=et.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(Ct),t.__H.__h.forEach(St),t.__H.__h=[]}catch(Y){t.__H.__h=[],nt.__e(Y,t.__v)}}nt.__b=function(t){X=null,rt&&rt(t)},nt.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),ut&&ut(t,e)},nt.__r=function(t){it&&it(t),Y=0;var e=(X=t.__c).__H;e&&(J===X?(e.__h=[],X.__h=[],e.__.forEach((function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0}))):(e.__h.forEach(Ct),e.__h.forEach(St),e.__h=[],Y=0)),J=X},nt.diffed=function(t){st&&st(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(1!==et.push(e)&&Z===nt.requestAnimationFrame||((Z=nt.requestAnimationFrame)||Tt)(bt)),e.__H.__.forEach((function(t){t.u&&(t.__H=t.u),t.u=void 0}))),J=X=null},nt.__c=function(t,e){e.some((function(t){try{t.__h.forEach(Ct),t.__h=t.__h.filter((function(t){return!t.__||St(t)}))}catch(X){e.some((function(t){t.__h&&(t.__h=[])})),e=[],nt.__e(X,t.__v)}})),ot&&ot(t,e)},nt.unmount=function(t){at&&at(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach((function(t){try{Ct(t)}catch(t){e=t}})),n.__H=void 0,e&&nt.__e(e,n.__v))};var Et="function"==typeof requestAnimationFrame;function Tt(t){var e,n=function(){clearTimeout(r),Et&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,35);Et&&(e=requestAnimationFrame(n))}function Ct(t){var e=X,n=t.__c;"function"==typeof n&&(t.__c=void 0,n()),X=e}function St(t){var e=X;t.__c=t.__(),X=e}function It(t,e){return!t||t.length!==e.length||e.some((function(e,n){return e!==t[n]}))}function At(t,e){return"function"==typeof e?e(t):e}var Dt={};function Nt(t,e){for(var n in e)t[n]=e[n];return t}function kt(t,e){for(var n in t)if("__source"!==n&&!(n in e))return!0;for(var r in e)if("__source"!==r&&t[r]!==e[r])return!0;return!1}function xt(t,e){var n=e(),r=lt({t:{__:n,u:e}}),i=r[0].t,s=r[1];return dt((function(){i.__=n,i.u=e,Ot(i)&&s({t:i})}),[t,n,e]),ft((function(){return Ot(i)&&s({t:i}),t((function(){Ot(i)&&s({t:i})}))}),[t]),n}function Ot(t){var e,n,r=t.u,i=t.__;try{var s=r();return!((e=i)===(n=s)&&(0!==e||1/e==1/n)||e!=e&&n!=n)}catch(t){return!0}}function Rt(t){t()}function Pt(t){return t}function Lt(){return[!1,Rt]}var Mt=dt;function Vt(t,e){this.props=t,this.context=e}function Ft(t,e){function n(t){var n=this.props.ref,r=n==t.ref;return!r&&n&&(n.call?n(null):n.current=null),e?!e(this.props,t)||!r:kt(this.props,t)}function r(e){return this.shouldComponentUpdate=n,E(t,e)}return r.displayName="Memo("+(t.displayName||t.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r}(Vt.prototype=new I).isPureReactComponent=!0,Vt.prototype.shouldComponentUpdate=function(t,e){return kt(this.props,t)||kt(this.state,e)};var Ut=s.__b;s.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),Ut&&Ut(t)};var jt="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Bt(t){function e(e){var n=Nt({},e);return delete n.ref,t(n,e.ref||null)}return e.$$typeof=jt,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(t.displayName||t.name)+")",e}var qt=function(t,e){return null==t?null:R(R(t).map(e))},$t={map:qt,forEach:qt,count:function(t){return t?R(t).length:0},only:function(t){var e=R(t);if(1!==e.length)throw"Children.only";return e[0]},toArray:R},zt=s.__e;s.__e=function(t,e,n,r){if(t.then)for(var i,s=e;s=s.__;)if((i=s.__c)&&i.__c)return null==e.__e&&(e.__e=n.__e,e.__k=n.__k),i.__c(t,e);zt(t,e,n,r)};var Ht=s.unmount;function Gt(t,e,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach((function(t){"function"==typeof t.__c&&t.__c()})),t.__c.__H=null),null!=(t=Nt({},t)).__c&&(t.__c.__P===n&&(t.__c.__P=e),t.__c.__e=!0,t.__c=null),t.__k=t.__k&&t.__k.map((function(t){return Gt(t,e,n)}))),t}function Kt(t,e,n){return t&&n&&(t.__v=null,t.__k=t.__k&&t.__k.map((function(t){return Kt(t,e,n)})),t.__c&&t.__c.__P===e&&(t.__e&&n.appendChild(t.__e),t.__c.__e=!0,t.__c.__P=n)),t}function Qt(){this.__u=0,this.o=null,this.__b=null}function Wt(t){var e=t.__.__c;return e&&e.__a&&e.__a(t)}function Yt(t){var e,n,r;function i(i){if(e||(e=t()).then((function(t){n=t.default||t}),(function(t){r=t})),r)throw r;if(!n)throw e;return E(n,i)}return i.displayName="Lazy",i.__f=!0,i}function Xt(){this.i=null,this.l=null}s.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&32&t.__u&&(t.type=null),Ht&&Ht(t)},(Qt.prototype=new I).__c=function(t,e){var n=e.__c,r=this;null==r.o&&(r.o=[]),r.o.push(n);var i=Wt(r.__v),s=!1,o=function(){s||(s=!0,n.__R=null,i?i(a):a())};n.__R=o;var a=function(){if(! --r.__u){if(r.state.__a){var t=r.state.__a;r.__v.__k[0]=Kt(t,t.__c.__P,t.__c.__O)}var e;for(r.setState({__a:r.__b=null});e=r.o.pop();)e.forceUpdate()}};r.__u++||32&e.__u||r.setState({__a:r.__b=r.__v.__k[0]}),t.then(o,o)},Qt.prototype.componentWillUnmount=function(){this.o=[]},Qt.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=Gt(this.__b,n,r.__O=r.__P)}this.__b=null}var i=e.__a&&E(S,null,t.fallback);return i&&(i.__u&=-33),[E(S,null,e.__a?null:t.children),i]};var Jt=function(t,e,n){if(++n[1]===n[0]&&t.l.delete(e),t.props.revealOrder&&("t"!==t.props.revealOrder[0]||!t.l.size))for(n=t.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;t.i=n=n[2]}};function Zt(t){return this.getChildContext=function(){return t.context},t.children}function te(t){var e=this,n=t.h;if(e.componentWillUnmount=function(){H(null,e.v),e.v=null,e.h=null},e.h&&e.h!==n&&e.componentWillUnmount(),!e.v){for(var r=e.__v;null!==r&&!r.__m&&null!==r.__;)r=r.__;e.h=n,e.v={nodeType:1,parentNode:n,childNodes:[],__k:{__m:r.__m},contains:function(){return!0},insertBefore:function(t,n){this.childNodes.push(t),e.h.insertBefore(t,n)},removeChild:function(t){this.childNodes.splice(this.childNodes.indexOf(t)>>>1,1),e.h.removeChild(t)}}}H(E(Zt,{context:e.context},t.__v),e.v)}function ee(t,e){var n=E(te,{__v:t,h:e});return n.containerInfo=e,n}(Xt.prototype=new I).__a=function(t){var e=this,n=Wt(e.__v),r=e.l.get(t);return r[0]++,function(i){var s=function(){e.props.revealOrder?(r.push(i),Jt(e,t,r)):i()};n?n(s):s()}},Xt.prototype.render=function(t){this.i=null,this.l=new Map;var e=R(t.children);t.revealOrder&&"b"===t.revealOrder[0]&&e.reverse();for(var n=e.length;n--;)this.l.set(e[n],this.i=[1,0,this.i]);return t.children},Xt.prototype.componentDidUpdate=Xt.prototype.componentDidMount=function(){var t=this;this.l.forEach((function(e,n){Jt(t,n,e)}))};var ne="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,re=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,ie=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,se=/[A-Z0-9]/g,oe="undefined"!=typeof document,ae=function(t){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/:/fil|che|ra/).test(t)};function ue(t,e,n){return null==e.__k&&(e.textContent=""),H(t,e),"function"==typeof n&&n(),t?t.__c:null}function ce(t,e,n){return G(t,e),"function"==typeof n&&n(),t?t.__c:null}I.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(t){Object.defineProperty(I.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})}));var le=s.event;function he(){}function fe(){return this.cancelBubble}function de(){return this.defaultPrevented}s.event=function(t){return le&&(t=le(t)),t.persist=he,t.isPropagationStopped=fe,t.isDefaultPrevented=de,t.nativeEvent=t};var pe,ge={enumerable:!1,configurable:!0,get:function(){return this.class}},me=s.vnode;s.vnode=function(t){"string"==typeof t.type&&function(t){var e=t.props,n=t.type,r={},i=-1===n.indexOf("-");for(var s in e){var o=e[s];if(!("value"===s&&"defaultValue"in e&&null==o||oe&&"children"===s&&"noscript"===n||"class"===s||"className"===s)){var a=s.toLowerCase();"defaultValue"===s&&"value"in e&&null==e.value?s="value":"download"===s&&!0===o?o="":"translate"===a&&"no"===o?o=!1:"o"===a[0]&&"n"===a[1]?"ondoubleclick"===a?s="ondblclick":"onchange"!==a||"input"!==n&&"textarea"!==n||ae(e.type)?"onfocus"===a?s="onfocusin":"onblur"===a?s="onfocusout":ie.test(s)&&(s=a):a=s="oninput":i&&re.test(s)?s=s.replace(se,"-$&").toLowerCase():null===o&&(o=void 0),"oninput"===a&&r[s=a]&&(s="oninputCapture"),r[s]=o}}"select"==n&&r.multiple&&Array.isArray(r.value)&&(r.value=R(e.children).forEach((function(t){t.props.selected=-1!=r.value.indexOf(t.props.value)}))),"select"==n&&null!=r.defaultValue&&(r.value=R(e.children).forEach((function(t){t.props.selected=r.multiple?-1!=r.defaultValue.indexOf(t.props.value):r.defaultValue==t.props.value}))),e.class&&!e.className?(r.class=e.class,Object.defineProperty(r,"className",ge)):(e.className&&!e.class||e.class&&e.className)&&(r.class=r.className=e.className),t.props=r}(t),t.$$typeof=ne,me&&me(t)};var ye=s.__r;s.__r=function(t){ye&&ye(t),pe=t.__c};var _e=s.diffed;s.diffed=function(t){_e&&_e(t);var e=t.props,n=t.__e;null!=n&&"textarea"===t.type&&"value"in e&&e.value!==n.value&&(n.value=null==e.value?"":e.value),pe=null};var ve={ReactCurrentDispatcher:{current:{readContext:function(t){return pe.__n[t.__c].props.value},useCallback:yt,useContext:_t,useDebugValue:vt,useDeferredValue:Pt,useEffect:ft,useId:wt,useImperativeHandle:gt,useInsertionEffect:Mt,useLayoutEffect:dt,useMemo:mt,useReducer:ht,useRef:pt,useState:lt,useSyncExternalStore:xt,useTransition:Lt}}};function we(t){return E.bind(null,t)}function be(t){return!!t&&t.$$typeof===ne}function Ee(t){return be(t)&&t.type===S}function Te(t){return!!t&&!!t.displayName&&("string"==typeof t.displayName||t.displayName instanceof String)&&t.displayName.startsWith("Memo(")}function Ce(t){return be(t)?K.apply(null,arguments):t}function Se(t){return!!t.__k&&(H(null,t),!0)}function Ie(t){return t&&(t.base||1===t.nodeType&&t)||null}var Ae=function(t,e){return t(e)},De=function(t,e){return t(e)},Ne=S,ke=be,xe={useState:lt,useId:wt,useReducer:ht,useEffect:ft,useLayoutEffect:dt,useInsertionEffect:Mt,useTransition:Lt,useDeferredValue:Pt,useSyncExternalStore:xt,startTransition:Rt,useRef:pt,useImperativeHandle:gt,useMemo:mt,useCallback:yt,useContext:_t,useDebugValue:vt,version:"18.3.1",Children:$t,render:ue,hydrate:ce,unmountComponentAtNode:Se,createPortal:ee,createElement:E,createContext:Q,createFactory:we,cloneElement:Ce,createRef:C,Fragment:S,isValidElement:be,isElement:ke,isFragment:Ee,isMemo:Te,findDOMNode:Ie,Component:I,PureComponent:Vt,memo:Ft,forwardRef:Bt,flushSync:De,unstable_batchedUpdates:Ae,StrictMode:Ne,Suspense:Qt,SuspenseList:Xt,lazy:Yt,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:ve};const Oe=Object.freeze(Object.defineProperty({__proto__:null,Children:$t,Component:I,Fragment:S,PureComponent:Vt,StrictMode:Ne,Suspense:Qt,SuspenseList:Xt,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:ve,cloneElement:Ce,createContext:Q,createElement:E,createFactory:we,createPortal:ee,createRef:C,default:xe,findDOMNode:Ie,flushSync:De,forwardRef:Bt,hydrate:ce,isElement:ke,isFragment:Ee,isMemo:Te,isValidElement:be,lazy:Yt,memo:Ft,render:ue,startTransition:Rt,unmountComponentAtNode:Se,unstable_batchedUpdates:Ae,useCallback:yt,useContext:_t,useDebugValue:vt,useDeferredValue:Pt,useEffect:ft,useErrorBoundary:function(t){var e=ct(Y++,10),n=lt();return e.__=t,X.componentDidCatch||(X.componentDidCatch=function(t,r){e.__&&e.__(t,r),n[1](t)}),[n[0],function(){n[1](void 0)}]},useId:wt,useImperativeHandle:gt,useInsertionEffect:Mt,useLayoutEffect:dt,useMemo:mt,useReducer:ht,useRef:pt,useState:lt,useSyncExternalStore:xt,useTransition:Lt,version:"18.3.1"},Symbol.toStringTag,{value:"Module"})),Re=r(Oe);var Pe;function Le(){if(Pe)return Dt;Pe=1,Object.defineProperty(Dt,"__esModule",{value:!0});var t=Re;return Dt.default=function(e,n){var r=t.useRef((function(){}));t.useEffect((function(){r.current=e})),t.useEffect((function(){if(null!==n){var t=setInterval((function(){return r.current()}),n||0);return function(){return clearInterval(t)}}}),[n])},Dt}t("e",i(Le()));var Me={},Ve=function(t,e){return Ve=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Ve(t,e)};function Fe(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Ve(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Ue=function(){return Ue=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Ue.apply(this,arguments)};function je(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function Be(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(o=(s<3?i(o):s>3?i(e,n,o):i(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o}function qe(t,e){return function(n,r){e(n,r,t)}}function $e(t,e,n,r,i,s){function o(t){if(void 0!==t&&"function"!=typeof t)throw new TypeError("Function expected");return t}for(var a,u=r.kind,c="getter"===u?"get":"setter"===u?"set":"value",l=!e&&t?r.static?t:t.prototype:null,h=e||(l?Object.getOwnPropertyDescriptor(l,r.name):{}),f=!1,d=n.length-1;d>=0;d--){var p={};for(var g in r)p[g]="access"===g?{}:r[g];for(var g in r.access)p.access[g]=r.access[g];p.addInitializer=function(t){if(f)throw new TypeError("Cannot add initializers after decoration has completed");s.push(o(t||null))};var m=(0,n[d])("accessor"===u?{get:h.get,set:h.set}:h[c],p);if("accessor"===u){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(a=o(m.get))&&(h.get=a),(a=o(m.set))&&(h.set=a),(a=o(m.init))&&i.unshift(a)}else(a=o(m))&&("field"===u?i.unshift(a):h[c]=a)}l&&Object.defineProperty(l,r.name,h),f=!0}function ze(t,e,n){for(var r=arguments.length>2,i=0;i<e.length;i++)n=r?e[i].call(t,n):e[i].call(t);return r?n:void 0}function He(t){return"symbol"==typeof t?t:"".concat(t)}function Ge(t,e,n){return"symbol"==typeof e&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:n?"".concat(n," ",e):e})}function Ke(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function Qe(t,e,n,r){return new(n||(n=Promise))((function(i,s){function o(t){try{u(r.next(t))}catch(rt){s(rt)}}function a(t){try{u(r.throw(t))}catch(rt){s(rt)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}u((r=r.apply(t,e||[])).next())}))}function We(t,e){var n,r,i,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(rt){a=[6,rt],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}var Ye=Object.create?function(t,e,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]};function Xe(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||Ye(e,t,n)}function Je(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ze(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function tn(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ze(arguments[e]));return t}function en(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}function nn(t,e,n){if(n||2===arguments.length)for(var r,i=0,s=e.length;i<s;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function rn(t){return this instanceof rn?(this.v=t,this):new rn(t)}function sn(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),s=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",(function(t){return function(e){return Promise.resolve(e).then(t,c)}})),r[Symbol.asyncIterator]=function(){return this},r;function o(t,e){i[t]&&(r[t]=function(e){return new Promise((function(n,r){s.push([t,e,n,r])>1||a(t,e)}))},e&&(r[t]=e(r[t])))}function a(t,e){try{!function(t){t.value instanceof rn?Promise.resolve(t.value.v).then(u,c):l(s[0][2],t)}(i[t](e))}catch(rt){l(s[0][3],rt)}}function u(t){a("next",t)}function c(t){a("throw",t)}function l(t,e){t(e),s.shift(),s.length&&a(s[0][0],s[0][1])}}function on(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:rn(t[r](e)),done:!1}:i?i(e):e}:i}}function an(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=Je(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){(function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)})(r,i,(e=t[n](e)).done,e.value)}))}}}function un(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var cn=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e},ln=function(t){return ln=Object.getOwnPropertyNames||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[e.length]=n);return e},ln(t)};function hn(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n=ln(t),r=0;r<n.length;r++)"default"!==n[r]&&Ye(e,t,n[r]);return cn(e,t),e}function fn(t){return t&&t.__esModule?t:{default:t}}function dn(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}function pn(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n}function gn(t,e){if(null===e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof t?e===t:t.has(e)}function mn(t,e,n){if(null!=e){if("object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],n&&(i=r)}if("function"!=typeof r)throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(rt){return Promise.reject(rt)}}),t.stack.push({value:e,dispose:r,async:n})}else n&&t.stack.push({async:!0});return e}var yn="function"==typeof SuppressedError?SuppressedError:function(t,e,n){var r=new Error(n);return r.name="SuppressedError",r.error=t,r.suppressed=e,r};function _n(t){function e(e){t.error=t.hasError?new yn(e,t.error,"An error was suppressed during disposal."):e,t.hasError=!0}var n,r=0;return function i(){for(;n=t.stack.pop();)try{if(!n.async&&1===r)return r=0,t.stack.push(n),Promise.resolve().then(i);if(n.dispose){var s=n.dispose.call(n.value);if(n.async)return r|=2,Promise.resolve(s).then(i,(function(t){return e(t),i()}))}else r|=1}catch(rt){e(rt)}if(1===r)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}()}function vn(t,e){return"string"==typeof t&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,(function(t,n,r,i,s){return n?e?".jsx":".js":!r||i&&s?r+i+"."+s.toLowerCase()+"js":t})):t}const wn={__extends:Fe,__assign:Ue,__rest:je,__decorate:Be,__param:qe,__esDecorate:$e,__runInitializers:ze,__propKey:He,__setFunctionName:Ge,__metadata:Ke,__awaiter:Qe,__generator:We,__createBinding:Ye,__exportStar:Xe,__values:Je,__read:Ze,__spread:tn,__spreadArrays:en,__spreadArray:nn,__await:rn,__asyncGenerator:sn,__asyncDelegator:on,__asyncValues:an,__makeTemplateObject:un,__importStar:hn,__importDefault:fn,__classPrivateFieldGet:dn,__classPrivateFieldSet:pn,__classPrivateFieldIn:gn,__addDisposableResource:mn,__disposeResources:_n,__rewriteRelativeImportExtension:vn},bn=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:mn,get __assign(){return Ue},__asyncDelegator:on,__asyncGenerator:sn,__asyncValues:an,__await:rn,__awaiter:Qe,__classPrivateFieldGet:dn,__classPrivateFieldIn:gn,__classPrivateFieldSet:pn,__createBinding:Ye,__decorate:Be,__disposeResources:_n,__esDecorate:$e,__exportStar:Xe,__extends:Fe,__generator:We,__importDefault:fn,__importStar:hn,__makeTemplateObject:un,__metadata:Ke,__param:qe,__propKey:He,__read:Ze,__rest:je,__rewriteRelativeImportExtension:vn,__runInitializers:ze,__setFunctionName:Ge,__spread:tn,__spreadArray:nn,__spreadArrays:en,__values:Je,default:wn},Symbol.toStringTag,{value:"Module"})),En=r(bn);var Tn,Cn,Sn,In={},An={};function Dn(){if(Tn)return An;Tn=1,Object.defineProperty(An,"__esModule",{value:!0});var t=Re;return An.default=function(e){t.useEffect(e,[])},An}function Nn(){if(Cn)return In;Cn=1,Object.defineProperty(In,"__esModule",{value:!0});var t=Re,e=En.__importDefault(Dn());return In.default=function(n){var r=t.useRef(n);r.current=n,e.default((function(){return function(){return r.current()}}))},In}function kn(){if(Sn)return Me;Sn=1,Object.defineProperty(Me,"__esModule",{value:!0});var t=Re,e=En.__importDefault(Nn());return Me.default=function(n){var r=t.useRef(0),i=t.useState(n),s=i[0],o=i[1],a=t.useCallback((function(t){cancelAnimationFrame(r.current),r.current=requestAnimationFrame((function(){o(t)}))}),[]);return e.default((function(){cancelAnimationFrame(r.current)})),[s,a]},Me}t("b",i(kn()));const xn=Math.sqrt(50),On=Math.sqrt(10),Rn=Math.sqrt(2);function Pn(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),o=s>=xn?10:s>=On?5:s>=Rn?2:1;let a,u,c;return i<0?(c=Math.pow(10,-i)/o,a=Math.round(t*c),u=Math.round(e*c),a/c<t&&++a,u/c>e&&--u,c=-c):(c=Math.pow(10,i)*o,a=Math.round(t/c),u=Math.round(e/c),a*c<t&&++a,u*c>e&&--u),u<a&&.5<=n&&n<2?Pn(t,e,2*n):[a,u,c]}function Ln(t,e,n){return Pn(t=+t,e=+e,n=+n)[2]}function Mn(t){return Math.max(1,Math.ceil(Math.log(function(t){let e=0;for(let n of t)null!=n&&(n=+n)>=n&&++e;return e}(t))/Math.LN2)+1)}var Vn=Array.prototype.slice;function Fn(t,e){return t-e}const Un=t=>()=>t;function jn(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=Bn(t,e[r]))return n;return 0}function Bn(t,e){for(var n=e[0],r=e[1],i=-1,s=0,o=t.length,a=o-1;s<o;a=s++){var u=t[s],c=u[0],l=u[1],h=t[a],f=h[0],d=h[1];if(qn(u,h,e))return 0;l>r!=d>r&&n<(f-c)*(r-l)/(d-l)+c&&(i=-i)}return i}function qn(t,e,n){var r;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&function(t,e,n){return t<=e&&e<=n||n<=e&&e<=t}(t[r=+(t[0]===e[0])],n[r],e[r])}function $n(){}var zn=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Hn(t){return isFinite(t)?t:NaN}function Gn(t,e){return null!=t&&+t>=e}function Kn(t){return null==t||isNaN(t=+t)?-1/0:t}function Qn(t,e,n,r){const i=r-e,s=n-e,o=isFinite(i)||isFinite(s)?i/s:Math.sign(i)/Math.sign(s);return isNaN(o)?t:t+o-.5}function Wn(t,e,n={}){const r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function Yn(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}var Xn={};const Jn=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},Zn={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const e=t[i],s=i+1<t.length,o=s?t[i+1]:0,a=i+2<t.length,u=a?t[i+2]:0,c=e>>2,l=(3&e)<<4|o>>4;let h=(15&o)<<2|u>>6,f=63&u;a||(f=64,s||(h=64)),r.push(n[c],n[l],n[h],n[f])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Jn(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const e=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0;++i;const o=i<t.length?n[t.charAt(i)]:64;++i;const a=i<t.length?n[t.charAt(i)]:64;if(++i,null==e||null==s||null==o||null==a)throw new tr;const u=e<<2|s>>4;if(r.push(u),64!==o){const t=s<<4&240|o>>2;if(r.push(t),64!==a){const t=o<<6&192|a;r.push(t)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class tr extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const er=function(t){return function(t){const e=Jn(t);return Zn.encodeByteArray(e,!0)}(t).replace(/\./g,"")};const nr=()=>function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,rr=()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(rt){return}const e=t&&function(t){try{return Zn.decodeString(t,!0)}catch(rt){console.error("base64Decode failed: ",rt)}return null}(t[1]);return e&&JSON.parse(e)},ir=()=>{try{return nr()||(()=>{if("undefined"==typeof process)return;const t=Xn.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||rr()}catch(rt){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${rt}`)}},sr=t=>{const e=(t=>{var e,n;return null===(n=null===(e=ir())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]})(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),r]:[e.substring(0,n),r]},or=()=>{var t;return null===(t=ir())||void 0===t?void 0:t.config};class ar{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function ur(t){return t.endsWith(".cloudworkstations.dev")}const cr={};let lr=!1;function hr(){return!function(){var t;const e=null===(t=ir())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(rt){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}class fr extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,fr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,dr.prototype.create)}}class dr{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},r=`${this.service}/${t}`,i=this.errors[t],s=i?function(t,e){return t.replace(pr,((t,n)=>{const r=e[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new fr(r,o,n)}}const pr=/\{\$([^}]+)}/g;function gr(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const n=t[i],s=e[i];if(mr(n)&&mr(s)){if(!gr(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function mr(t){return null!==t&&"object"==typeof t}function yr(t){return t&&t._delegate?t._delegate:t}class _r{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const vr="[DEFAULT]";class wr{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new ar;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(rt){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(rt){if(r)return null;throw rt}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:vr})}catch(rt){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(rt){}}}}clearInstance(t=vr){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=vr){return this.instances.has(t)}getOptions(t=vr){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(t,e){var n;const r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&t(s,r),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(r){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=t,r===vr?void 0:r),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(i){}var r;return n||null}normalizeInstanceIdentifier(t=vr){return this.component?this.component.multipleInstances?t:vr:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class br{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new wr(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}var Er;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(Er||(Er={}));const Tr={debug:Er.DEBUG,verbose:Er.VERBOSE,info:Er.INFO,warn:Er.WARN,error:Er.ERROR,silent:Er.SILENT},Cr=Er.INFO,Sr={[Er.DEBUG]:"log",[Er.VERBOSE]:"log",[Er.INFO]:"info",[Er.WARN]:"warn",[Er.ERROR]:"error"},Ir=(t,e,...n)=>{if(e<t.logLevel)return;const r=(new Date).toISOString(),i=Sr[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${r}]  ${t.name}:`,...n)};class Ar{constructor(t){this.name=t,this._logLevel=Cr,this._logHandler=Ir,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Er))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?Tr[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Er.DEBUG,...t),this._logHandler(this,Er.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Er.VERBOSE,...t),this._logHandler(this,Er.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Er.INFO,...t),this._logHandler(this,Er.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Er.WARN,...t),this._logHandler(this,Er.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Er.ERROR,...t),this._logHandler(this,Er.ERROR,...t)}}let Dr,Nr;const kr=new WeakMap,xr=new WeakMap,Or=new WeakMap,Rr=new WeakMap,Pr=new WeakMap;let Lr={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return xr.get(t);if("objectStoreNames"===e)return t.objectStoreNames||Or.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Fr(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function Mr(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Nr||(Nr=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Ur(this),e),Fr(kr.get(this))}:function(...e){return Fr(t.apply(Ur(this),e))}:function(e,...n){const r=t.call(Ur(this),e,...n);return Or.set(r,e.sort?e.sort():[e]),Fr(r)}}function Vr(t){return"function"==typeof t?Mr(t):(t instanceof IDBTransaction&&function(t){if(xr.has(t))return;const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",s),t.removeEventListener("abort",s)},i=()=>{e(),r()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",s),t.addEventListener("abort",s)}));xr.set(t,e)}(t),e=t,(Dr||(Dr=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>e instanceof t))?new Proxy(t,Lr):t);var e}function Fr(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",s)},i=()=>{e(Fr(t.result)),r()},s=()=>{n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&kr.set(e,t)})).catch((()=>{})),Pr.set(e,t),e}(t);if(Rr.has(t))return Rr.get(t);const e=Vr(t);return e!==t&&(Rr.set(t,e),Pr.set(e,t)),e}const Ur=t=>Pr.get(t);const jr=["get","getKey","getAll","getAllKeys","count"],Br=["put","add","delete","clear"],qr=new Map;function $r(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(qr.get(e))return qr.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=Br.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!jr.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),i&&s.done]))[0]};return qr.set(e,s),s}Lr=(t=>e(e({},t),{},{get:(e,n,r)=>$r(e,n)||t.get(e,n,r),has:(e,n)=>!!$r(e,n)||t.has(e,n)}))(Lr);class zr{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const Hr="@firebase/app",Gr="0.13.1",Kr=new Ar("@firebase/app"),Qr="@firebase/app-compat",Wr="@firebase/analytics-compat",Yr="@firebase/analytics",Xr="@firebase/app-check-compat",Jr="@firebase/app-check",Zr="@firebase/auth",ti="@firebase/auth-compat",ei="@firebase/database",ni="@firebase/data-connect",ri="@firebase/database-compat",ii="@firebase/functions",si="@firebase/functions-compat",oi="@firebase/installations",ai="@firebase/installations-compat",ui="@firebase/messaging",ci="@firebase/messaging-compat",li="@firebase/performance",hi="@firebase/performance-compat",fi="@firebase/remote-config",di="@firebase/remote-config-compat",pi="@firebase/storage",gi="@firebase/storage-compat",mi="@firebase/firestore",yi="@firebase/ai",_i="@firebase/firestore-compat",vi="firebase",wi="[DEFAULT]",bi={[Hr]:"fire-core",[Qr]:"fire-core-compat",[Yr]:"fire-analytics",[Wr]:"fire-analytics-compat",[Jr]:"fire-app-check",[Xr]:"fire-app-check-compat",[Zr]:"fire-auth",[ti]:"fire-auth-compat",[ei]:"fire-rtdb",[ni]:"fire-data-connect",[ri]:"fire-rtdb-compat",[ii]:"fire-fn",[si]:"fire-fn-compat",[oi]:"fire-iid",[ai]:"fire-iid-compat",[ui]:"fire-fcm",[ci]:"fire-fcm-compat",[li]:"fire-perf",[hi]:"fire-perf-compat",[fi]:"fire-rc",[di]:"fire-rc-compat",[pi]:"fire-gcs",[gi]:"fire-gcs-compat",[mi]:"fire-fst",[_i]:"fire-fst-compat",[yi]:"fire-vertex","fire-js":"fire-js",[vi]:"fire-js-all"},Ei=new Map,Ti=new Map,Ci=new Map;function Si(t,e){try{t.container.addComponent(e)}catch(rt){Kr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,rt)}}function Ii(t){const e=t.name;if(Ci.has(e))return Kr.debug(`There were multiple attempts to register component ${e}.`),!1;Ci.set(e,t);for(const n of Ei.values())Si(n,t);for(const n of Ti.values())Si(n,t);return!0}const Ai=new dr("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Di{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new _r("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Ai.create("app-deleted",{appName:this._name})}}function Ni(t,e={}){let n=t;if("object"!=typeof e){e={name:e}}const r=Object.assign({name:wi,automaticDataCollectionEnabled:!0},e),i=r.name;if("string"!=typeof i||!i)throw Ai.create("bad-app-name",{appName:String(i)});if(n||(n=or()),!n)throw Ai.create("no-options");const s=Ei.get(i);if(s){if(gr(n,s.options)&&gr(r,s.config))return s;throw Ai.create("duplicate-app",{appName:i})}const o=new br(i);for(const u of Ci.values())o.addComponent(u);const a=new Di(n,r,o);return Ei.set(i,a),a}function ki(t,e,n){var r;let i=null!==(r=bi[t])&&void 0!==r?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${i}" with version "${e}":`];return s&&t.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void Kr.warn(t.join(" "))}Ii(new _r(`${i}-version`,(()=>({library:i,version:e})),"VERSION"))}const xi="firebase-heartbeat-store";let Oi=null;function Ri(){return Oi||(Oi=function(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Fr(o);return r&&o.addEventListener("upgradeneeded",(t=>{r(Fr(o.result),t.oldVersion,t.newVersion,Fr(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{s&&t.addEventListener("close",(()=>s())),i&&t.addEventListener("versionchange",(t=>i(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}("firebase-heartbeat-database",1,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(xi)}catch(rt){console.warn(rt)}}}).catch((t=>{throw Ai.create("idb-open",{originalErrorMessage:t.message})}))),Oi}async function Pi(t,e){try{const n=(await Ri()).transaction(xi,"readwrite"),r=n.objectStore(xi);await r.put(e,Li(t)),await n.done}catch(rt){if(rt instanceof fr)Kr.warn(rt.message);else{const e=Ai.create("idb-set",{originalErrorMessage:null==rt?void 0:rt.message});Kr.warn(e.message)}}}function Li(t){return`${t.name}!${t.options.appId}`}class Mi{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Fi(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Vi();if(null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((t=>t.date===r)))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const t=function(t){if(0===t.length)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(t,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(rt){Kr.warn(rt)}}async getHeartbeatsHeader(){var t;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=Vi(),{heartbeatsToSend:n,unsentEntries:r}=function(t,e=1024){const n=[];let r=t.slice();for(const i of t){const t=n.find((t=>t.agent===i.agent));if(t){if(t.dates.push(i.date),Ui(n)>e){t.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Ui(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=er(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(rt){return Kr.warn(rt),""}}}function Vi(){return(new Date).toISOString().substring(0,10)}class Fi{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!function(){try{return"object"==typeof indexedDB}catch(rt){return!1}}()&&new Promise(((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(n){e(n)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await Ri()).transaction(xi),n=await e.objectStore(xi).get(Li(t));return await e.done,n}catch(rt){if(rt instanceof fr)Kr.warn(rt.message);else{const e=Ai.create("idb-get",{originalErrorMessage:null==rt?void 0:rt.message});Kr.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Pi(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Pi(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function Ui(t){return er(JSON.stringify({version:2,heartbeats:t})).length}var ji;ji="",Ii(new _r("platform-logger",(t=>new zr(t)),"PRIVATE")),Ii(new _r("heartbeat",(t=>new Mi(t)),"PRIVATE")),ki(Hr,Gr,ji),ki(Hr,Gr,"esm2017"),ki("fire-js","");ki("firebase","11.9.1","app");var Bi,qi,$i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};(function(){var t;function e(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(t,e,n){n||(n=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}function r(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=0|t[i];r&&s==e||(n[i]=s,r=!1)}this.g=n}!function(t,e){function n(){}n.prototype=e.prototype,t.D=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.C=function(t,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return e.prototype[n].apply(t,i)}}(e,(function(){this.blockSize=-1})),e.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},e.prototype.u=function(t,e){void 0===e&&(e=t.length);for(var r=e-this.blockSize,i=this.B,s=this.h,o=0;o<e;){if(0==s)for(;o<=r;)n(this,t,o),o+=this.blockSize;if("string"==typeof t){for(;o<e;)if(i[s++]=t.charCodeAt(o++),s==this.blockSize){n(this,i),s=0;break}}else for(;o<e;)if(i[s++]=t[o++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=e},e.prototype.v=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.o;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.u(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};var i={};function s(t){return-128<=t&&128>t?function(t,e){var n=i;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(t){return new r([0|t],0>t?-1:0)})):new r([0|t],0>t?-1:0)}function o(t){if(isNaN(t)||!isFinite(t))return a;if(0>t)return f(o(-t));for(var e=[],n=1,i=0;t>=n;i++)e[i]=t/n|0,n*=4294967296;return new r(e,0)}var a=s(0),u=s(1),c=s(16777216);function l(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function h(t){return-1==t.h}function f(t){for(var e=t.g.length,n=[],i=0;i<e;i++)n[i]=~t.g[i];return new r(n,~t.h).add(u)}function d(t,e){return t.add(f(e))}function p(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function g(t,e){this.g=t,this.h=e}function m(t,e){if(l(e))throw Error("division by zero");if(l(t))return new g(a,a);if(h(t))return e=m(f(t),e),new g(f(e.g),f(e.h));if(h(e))return e=m(t,f(e)),new g(f(e.g),e.h);if(30<t.g.length){if(h(t)||h(e))throw Error("slowDivide_ only works with positive integers.");for(var n=u,r=e;0>=r.l(t);)n=y(n),r=y(r);var i=_(n,1),s=_(r,1);for(r=_(r,2),n=_(n,2);!l(r);){var c=s.add(r);0>=c.l(t)&&(i=i.add(n),s=c),r=_(r,1),n=_(n,1)}return e=d(t,i.j(e)),new g(i,e)}for(i=a;0<=t.l(e);){for(n=Math.max(1,Math.floor(t.m()/e.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(s=o(n)).j(e);h(c)||0<c.l(t);)c=(s=o(n-=r)).j(e);l(s)&&(s=u),i=i.add(s),t=d(t,c)}return new g(i,t)}function y(t){for(var e=t.g.length+1,n=[],i=0;i<e;i++)n[i]=t.i(i)<<1|t.i(i-1)>>>31;return new r(n,t.h)}function _(t,e){var n=e>>5;e%=32;for(var i=t.g.length-n,s=[],o=0;o<i;o++)s[o]=0<e?t.i(o+n)>>>e|t.i(o+n+1)<<32-e:t.i(o+n);return new r(s,t.h)}(t=r.prototype).m=function(){if(h(this))return-f(this).m();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.i(n);t+=(0<=r?r:4294967296+r)*e,e*=4294967296}return t},t.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(l(this))return"0";if(h(this))return"-"+f(this).toString(t);for(var e=o(Math.pow(t,6)),n=this,r="";;){var i=m(n,e).g,s=((0<(n=d(n,i.j(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(l(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},t.i=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},t.l=function(t){return h(t=d(this,t))?-1:l(t)?0:1},t.abs=function(){return h(this)?f(this):this},t.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0,s=0;s<=e;s++){var o=i+(65535&this.i(s))+(65535&t.i(s)),a=(o>>>16)+(this.i(s)>>>16)+(t.i(s)>>>16);i=a>>>16,o&=65535,a&=65535,n[s]=a<<16|o}return new r(n,-2147483648&n[n.length-1]?-1:0)},t.j=function(t){if(l(this)||l(t))return a;if(h(this))return h(t)?f(this).j(f(t)):f(f(this).j(t));if(h(t))return f(this.j(f(t)));if(0>this.l(c)&&0>t.l(c))return o(this.m()*t.m());for(var e=this.g.length+t.g.length,n=[],i=0;i<2*e;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<t.g.length;s++){var u=this.i(i)>>>16,d=65535&this.i(i),g=t.i(s)>>>16,m=65535&t.i(s);n[2*i+2*s]+=d*m,p(n,2*i+2*s),n[2*i+2*s+1]+=u*m,p(n,2*i+2*s+1),n[2*i+2*s+1]+=d*g,p(n,2*i+2*s+1),n[2*i+2*s+2]+=u*g,p(n,2*i+2*s+2)}for(i=0;i<e;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=e;i<2*e;i++)n[i]=0;return new r(n,0)},t.A=function(t){return m(this,t).h},t.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.i(i)&t.i(i);return new r(n,this.h&t.h)},t.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.i(i)|t.i(i);return new r(n,this.h|t.h)},t.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.i(i)^t.i(i);return new r(n,this.h^t.h)},e.prototype.digest=e.prototype.v,e.prototype.reset=e.prototype.s,e.prototype.update=e.prototype.u,qi=e,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=o,r.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return f(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=o(Math.pow(n,8)),i=a,s=0;s<e.length;s+=8){var u=Math.min(8,e.length-s),c=parseInt(e.substring(s,s+u),n);8>u?(u=o(Math.pow(n,u)),i=i.j(u).add(o(c))):i=(i=i.j(r)).add(o(c))}return i},Bi=r}).apply(void 0!==$i?$i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var zi,Hi,Gi,Ki,Qi,Wi,Yi,Xi,Ji="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){return t==Array.prototype||t==Object.prototype||(t[e]=n.value),t};var n=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Ji&&Ji];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(t,r){if(r)t:{var i=n;t=t.split(".");for(var s=0;s<t.length-1;s++){var o=t[s];if(!(o in i))break t;i=i[o]}(r=r(s=i[t=t[t.length-1]]))!=s&&null!=r&&e(i,t,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",(function(t){return t||function(){return function(t,e){t instanceof String&&(t+="");var n=0,r=!1,i={next:function(){if(!r&&n<t.length){var i=n++;return{value:e(i,t[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(t,e){return e}))}}));var r=r||{},i=this||self;function s(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function o(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function a(t,e,n){return t.call.apply(t.bind,arguments)}function u(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function c(t,e,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:u).apply(null,arguments)}function l(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function h(t,e){function n(){}n.prototype=e.prototype,t.aa=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Qb=function(t,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return e.prototype[n].apply(t,i)}}function f(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function d(t,e){for(let n=1;n<arguments.length;n++){const e=arguments[n];if(s(e)){const n=t.length||0,r=e.length||0;t.length=n+r;for(let i=0;i<r;i++)t[n+i]=e[i]}else t.push(e)}}function p(t){return/^[\s\xa0]*$/.test(t)}function g(){var t=i.navigator;return t&&(t=t.userAgent)?t:""}function m(t){return m[" "](t),t}m[" "]=function(){};var y=!(-1==g().indexOf("Gecko")||-1!=g().toLowerCase().indexOf("webkit")&&-1==g().indexOf("Edge")||-1!=g().indexOf("Trident")||-1!=g().indexOf("MSIE")||-1!=g().indexOf("Edge"));function _(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function v(t){const e={};for(const n in t)e[n]=t[n];return e}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(t,e){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)t[n]=r[n];for(let e=0;e<w.length;e++)n=w[e],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function E(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function T(t){i.setTimeout((()=>{throw t}),0)}function C(){var t=N;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var S=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new I),(t=>t.reset()));class I{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}let A,D=!1,N=new class{constructor(){this.h=this.g=null}add(t,e){const n=S.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},k=()=>{const t=i.Promise.resolve(void 0);A=()=>{t.then(x)}};var x=()=>{for(var t;t=C();){try{t.h.call(t.g)}catch(nt){T(nt)}var e=S;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}D=!1};function O(){this.s=this.s,this.C=this.C}function R(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}O.prototype.s=!1,O.prototype.ma=function(){this.s||(this.s=!0,this.N())},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},R.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};i.addEventListener("test",t,e),i.removeEventListener("test",t,e)}catch(nt){}return t}();function L(t,e){if(R.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(y){t:{try{m(e.nodeName);var i=!0;break t}catch(et){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:M[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&L.aa.h.call(this)}}h(L,R);var M={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var V="closure_listenable_"+(1e6*Math.random()|0),F=0;function U(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ha=i,this.key=++F,this.da=this.fa=!1}function j(t){t.da=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function B(t){this.src=t,this.g={},this.h=0}function q(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],s=Array.prototype.indexOf.call(i,e,void 0);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(j(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function $(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.da&&s.listener==e&&s.capture==!!n&&s.ha==r)return i}return-1}B.prototype.add=function(t,e,n,r,i){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=$(t,e,r,i);return-1<o?(e=t[o],n||(e.fa=!1)):((e=new U(e,this.src,s,!!r,i)).fa=n,t.push(e)),e};var z="closure_lm_"+(1e6*Math.random()|0),H={};function G(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)G(t,e[s],n,r,i);return null}return n=Z(n),t&&t[V]?t.K(e,n,!!o(r)&&!!r.capture,i):function(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var a=o(i)?!!i.capture:!!i,u=X(t);if(u||(t[z]=u=new B(t)),n=u.add(e,n,r,a,s),n.proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}const e=Y;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)P||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(W(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}(t,e,n,!1,r,i)}function K(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)K(t,e[s],n,r,i);else r=o(r)?!!r.capture:!!r,n=Z(n),t&&t[V]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=$(s=t.g[e],n,r,i))&&(j(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--)))):t&&(t=X(t))&&(e=t.g[e.toString()],t=-1,e&&(t=$(e,n,r,i)),(n=-1<t?e[t]:null)&&Q(n))}function Q(t){if("number"!=typeof t&&t&&!t.da){var e=t.src;if(e&&e[V])q(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(W(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=X(e))?(q(n,t),0==n.h&&(n.src=null,e[z]=null)):j(t)}}}function W(t){return t in H?H[t]:H[t]="on"+t}function Y(t,e){if(t.da)t=!0;else{e=new L(e,this);var n=t.listener,r=t.ha||t.src;t.fa&&Q(t),t=n.call(r,e)}return t}function X(t){return(t=t[z])instanceof B?t:null}var J="__closure_events_fn_"+(1e9*Math.random()>>>0);function Z(t){return"function"==typeof t?t:(t[J]||(t[J]=function(e){return t.handleEvent(e)}),t[J])}function tt(){O.call(this),this.i=new B(this),this.M=this,this.F=null}function st(t,e){var n,r=t.F;if(r)for(n=[];r;r=r.F)n.push(r);if(t=t.M,r=e.type||e,"string"==typeof e)e=new R(e,t);else if(e instanceof R)e.target=e.target||t;else{var i=e;b(e=new R(r,t),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=ut(o,r,!0,e)&&i}if(i=ut(o=e.g=t,r,!0,e)&&i,i=ut(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)i=ut(o=e.g=n[s],r,!1,e)&&i}function ut(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.da&&o.capture==n){var a=o.listener,u=o.ha||o.src;o.fa&&q(t.i,o),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}function ct(t,e,n){if("function"==typeof t)n&&(t=c(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=c(t.handleEvent,t)}return 2147483647<Number(e)?-1:i.setTimeout(t,e||0)}function ht(t){t.g=ct((()=>{t.g=null,t.i&&(t.i=!1,ht(t))}),t.l);const e=t.h;t.h=null,t.m.apply(null,e)}h(tt,O),tt.prototype[V]=!0,tt.prototype.removeEventListener=function(t,e,n,r){K(this,t,e,n,r)},tt.prototype.N=function(){if(tt.aa.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)j(n[r]);delete e.g[t],e.h--}}this.F=null},tt.prototype.K=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},tt.prototype.L=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};class ft extends O{constructor(t,e){super(),this.m=t,this.l=e,this.h=null,this.i=!1,this.g=null}j(t){this.h=arguments,this.g?this.i=!0:ht(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function dt(t){O.call(this),this.h=t,this.g={}}h(dt,O);var pt=[];function gt(t){_(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Q(t)}),t),t.g={}}dt.prototype.N=function(){dt.aa.N.call(this),gt(this)},dt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var mt=i.JSON.stringify,yt=i.JSON.parse,_t=class{stringify(t){return i.JSON.stringify(t,void 0)}parse(t){return i.JSON.parse(t,void 0)}};function vt(){}function wt(t){return t.h||(t.h=t.i())}function bt(){}vt.prototype.h=null;var Et={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Tt(){R.call(this,"d")}function Ct(){R.call(this,"c")}h(Tt,R),h(Ct,R);var St={},It=null;function At(){return It=It||new tt}function Dt(t){R.call(this,St.La,t)}function Nt(t){const e=At();st(e,new Dt(e))}function kt(t,e){R.call(this,St.STAT_EVENT,t),this.stat=e}function xt(t){const e=At();st(e,new kt(e,t))}function Ot(t,e){R.call(this,St.Ma,t),this.size=e}function Rt(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return i.setTimeout((function(){t()}),e)}function Lt(){this.g=!0}function Mt(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return mt(n)}catch(at){return e}}(t,n)+(r?" "+r:"")}))}St.La="serverreachability",h(Dt,R),St.STAT_EVENT="statevent",h(kt,R),St.Ma="timingevent",h(Ot,R),Lt.prototype.xa=function(){this.g=!1},Lt.prototype.info=function(){};var Vt,Ft={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ut={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function jt(){}function Bt(t,e,n,r){this.j=t,this.i=e,this.l=n,this.R=r||1,this.U=new dt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new qt}function qt(){this.i=null,this.g="",this.h=!1}h(jt,vt),jt.prototype.g=function(){return new XMLHttpRequest},jt.prototype.i=function(){return{}},Vt=new jt;var $t={},zt={};function Ht(t,e,n){t.L=1,t.v=ye(fe(e)),t.m=n,t.P=!0,Gt(t,null)}function Gt(t,e){t.F=Date.now(),Wt(t),t.A=fe(t.v);var n=t.A,r=t.R;Array.isArray(r)||(r=[String(r)]),ke(n.i,"t",r),t.C=0,n=t.j.J,t.h=new qt,t.g=_n(t.j,n?e:null,!t.m),0<t.O&&(t.M=new ft(c(t.Y,t,t.g),t.O)),e=t.U,n=t.g,r=t.ca;var i="readystatechange";Array.isArray(i)||(i&&(pt[0]=i.toString()),i=pt);for(var s=0;s<i.length;s++){var o=G(n,i[s],r||e.handleEvent,!1,e.h||e);if(!o)break;e.g[o.key]=o}e=t.H?v(t.H):{},t.m?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.m,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Nt(),function(t,e,n,r,i,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o}))}(t.i,t.u,t.A,t.l,t.R,t.m)}function Kt(t){return!!t.g&&("GET"==t.u&&2!=t.L&&t.j.Ca)}function Qt(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?zt:(n=Number(e.substring(n,r)),isNaN(n)?$t:(r+=1)+n>e.length?zt:(e=e.slice(r,r+n),t.C=r+n,e))}function Wt(t){t.S=Date.now()+t.I,Yt(t,t.I)}function Yt(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Rt(c(t.ba,t),e)}function Xt(t){t.B&&(i.clearTimeout(t.B),t.B=null)}function Jt(t){0==t.j.G||t.J||dn(t.j,t)}function Zt(t){Xt(t);var e=t.M;e&&"function"==typeof e.ma&&e.ma(),t.M=null,gt(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.ma())}function te(t,e){try{var n=t.j;if(0!=n.G&&(n.g==t||se(n.h,t)))if(!t.K&&se(n.h,t)&&3==n.G){try{var r=n.Da.g.parse(e)}catch(ot){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;fn(n),en(n)}cn(n),xt(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=Rt(c(n.Za,n),6e3));if(1>=ie(n.h)&&n.ca){try{n.ca()}catch(ot){}n.ca=void 0}}else gn(n,11)}else if((t.K||n.g==t)&&fn(n),!p(e))for(i=n.Da.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const e=c[3];null!=e&&(n.la=e,n.j.info("VER="+n.la));const i=c[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const l=c[5];null!=l&&"number"==typeof l&&0<l&&(r=1.5*l,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=r.h;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(oe(s,s.h),s.h=null))}if(r.D){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(r.ya=t,me(r.I,r.D,t))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-t.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=t;if((r=n).qa=yn(r,r.J?r.ia:null,r.W),o.K){ae(r.h,o);var a=o,u=r.L;u&&(a.I=u),a.B&&(Xt(a),Wt(a)),r.g=o}else un(r);0<n.i.length&&rn(n)}else"stop"!=c[0]&&"close"!=c[0]||gn(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?gn(n,7):tn(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Nt()}catch(ot){}}Bt.prototype.ca=function(t){t=t.target;const e=this.M;e&&3==Ye(t)?e.j():this.Y(t)},Bt.prototype.Y=function(t){try{if(t==this.g)t:{const f=Ye(this.g);var e=this.g.Ba();this.g.Z();if(!(3>f)&&(3!=f||this.g&&(this.h.h||this.g.oa()||Xe(this.g)))){this.J||4!=f||7==e||Nt(),Xt(this);var n=this.g.Z();this.X=n;e:if(Kt(this)){var r=Xe(this.g);t="";var s=r.length,o=4==Ye(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Zt(this),Jt(this);var a="";break e}this.h.i=new i.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:!(o&&e==s-1)});r.length=0,this.h.g+=t,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(t,e,n,r,i,s,o){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.i,this.u,this.A,this.l,this.R,f,n),this.o){if(this.T&&!this.K){e:{if(this.g){var u,c=this.g;if((u=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(u)){var l=u;break e}}l=null}if(!(n=l)){this.o=!1,this.s=3,xt(12),Zt(this),Jt(this);break t}Mt(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,te(this,n)}if(this.P){let t;for(n=!0;!this.J&&this.C<a.length;){if(t=Qt(this,a),t==zt){4==f&&(this.s=4,xt(14),n=!1),Mt(this.i,this.l,null,"[Incomplete Response]");break}if(t==$t){this.s=4,xt(15),Mt(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}Mt(this.i,this.l,t,null),te(this,t)}if(Kt(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=f||0!=a.length||this.h.h||(this.s=1,xt(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),ln(h),h.M=!0,xt(11))}}else Mt(this.i,this.l,a,"[Invalid Chunked Response]"),Zt(this),Jt(this)}else Mt(this.i,this.l,a,null),te(this,a);4==f&&Zt(this),this.o&&!this.J&&(4==f?dn(this.j,this):(this.o=!1,Wt(this)))}else(function(t){const e={};t=(t.g&&2<=Ye(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<t.length;r++){if(p(t[r]))continue;var n=E(t[r]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,xt(12)):(this.s=0,xt(13)),Zt(this),Jt(this)}}}catch(Pt){}},Bt.prototype.cancel=function(){this.J=!0,Zt(this)},Bt.prototype.ba=function(){this.B=null;const t=Date.now();0<=t-this.S?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.i,this.A),2!=this.L&&(Nt(),xt(17)),Zt(this),this.s=2,Jt(this)):Yt(this,this.S-t)};var ee=class{constructor(t,e){this.g=t,this.map=e}};function ne(t){this.l=t||10,i.PerformanceNavigationTiming?t=0<(t=i.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function re(t){return!!t.h||!!t.g&&t.g.size>=t.j}function ie(t){return t.h?1:t.g?t.g.size:0}function se(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function oe(t,e){t.g?t.g.add(e):t.h=e}function ae(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function ue(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return f(t.i)}function ce(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(s(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.na&&"function"==typeof t.na)return t.na();if(!t.V||"function"!=typeof t.V){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(s(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}(t),r=function(t){if(t.V&&"function"==typeof t.V)return t.V();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(s(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}ne.prototype.cancel=function(){if(this.i=ue(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var le=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function he(t){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,t instanceof he){this.h=t.h,de(this,t.j),this.o=t.o,this.g=t.g,pe(this,t.s),this.l=t.l;var e=t.i,n=new Ie;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),ge(this,n),this.m=t.m}else t&&(e=String(t).match(le))?(this.h=!1,de(this,e[1]||"",!0),this.o=_e(e[2]||""),this.g=_e(e[3]||"",!0),pe(this,e[4]),this.l=_e(e[5]||"",!0),ge(this,e[6]||"",!0),this.m=_e(e[7]||"")):(this.h=!1,this.i=new Ie(null,this.h))}function fe(t){return new he(t)}function de(t,e,n){t.j=n?_e(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function pe(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.s=e}else t.s=null}function ge(t,e,n){e instanceof Ie?(t.i=e,function(t,e){e&&!t.j&&(Ae(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(De(this,e),ke(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=ve(e,Ce)),t.i=new Ie(e,t.h))}function me(t,e,n){t.i.set(e,n)}function ye(t){return me(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function _e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ve(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,we),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function we(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}he.prototype.toString=function(){var t=[],e=this.j;e&&t.push(ve(e,be,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.o)&&t.push(ve(e,be,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(ve(n,"/"==n.charAt(0)?Te:Ee,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.m)&&t.push("#",ve(n,Se)),t.join("")};var be=/[#\/\?@]/g,Ee=/[#\?:]/g,Te=/[#\?]/g,Ce=/[#\?@]/g,Se=/#/g;function Ie(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ae(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function De(t,e){Ae(t),e=xe(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Ne(t,e){return Ae(t),e=xe(t,e),t.g.has(e)}function ke(t,e,n){De(t,e),0<n.length&&(t.i=null,t.g.set(xe(t,e),f(n)),t.h+=n.length)}function xe(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Oe(t,e,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(et){}}function Re(){this.g=new _t}function Pe(t,e,n){const r=n||"";try{ce(t,(function(t,n){let i=t;o(t)&&(i=mt(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(rt){throw e.push(r+"type="+encodeURIComponent("_badmap")),rt}}function Le(t){this.l=t.Ub||null,this.j=t.eb||!1}function Me(t,e){tt.call(this),this.D=t,this.o=e,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Ve(t){t.j.read().then(t.Pa.bind(t)).catch(t.ga.bind(t))}function Fe(t){t.readyState=4,t.l=null,t.j=null,t.v=null,Ue(t)}function Ue(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function je(t){let e="";return _(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Be(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=je(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):me(t,e,n))}function qe(t){tt.call(this),this.headers=new Map,this.o=t||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(t=Ie.prototype).add=function(t,e){Ae(this),this.i=null,t=xe(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},t.forEach=function(t,e){Ae(this),this.g.forEach((function(n,r){n.forEach((function(n){t.call(e,n,r,this)}),this)}),this)},t.na=function(){Ae(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let t=0;t<i.length;t++)n.push(e[r])}return n},t.V=function(t){Ae(this);let e=[];if("string"==typeof t)Ne(this,t)&&(e=e.concat(this.g.get(xe(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},t.set=function(t,e){return Ae(this),this.i=null,Ne(this,t=xe(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},t.get=function(t,e){return t&&0<(t=this.V(t)).length?String(t[0]):e},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.V(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")},h(Le,vt),Le.prototype.g=function(){return new Me(this.l,this.j)},Le.prototype.i=function(t){return function(){return t}}({}),h(Me,tt),(t=Me.prototype).open=function(t,e){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=t,this.A=e,this.readyState=1,Ue(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.u,method:this.B,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||i).fetch(new Request(this.A,e)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Fe(this)),this.readyState=0},t.Sa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Ue(this)),this.g&&(this.readyState=3,Ue(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==i.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ve(this)}else t.text().then(this.Ra.bind(this),this.ga.bind(this))},t.Pa=function(t){if(this.g){if(this.o&&t.value)this.response.push(t.value);else if(!this.o){var e=t.value?t.value:new Uint8Array(0);(e=this.v.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Fe(this):Ue(this),3==this.readyState&&Ve(this)}},t.Ra=function(t){this.g&&(this.response=this.responseText=t,Fe(this))},t.Qa=function(t){this.g&&(this.response=t,Fe(this))},t.ga=function(){this.g&&Fe(this)},t.setRequestHeader=function(t,e){this.u.append(t,e)},t.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Me.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}}),h(qe,tt);var $e=/^https?$/i,ze=["POST","PUT"];function He(t,e){t.h=!1,t.g&&(t.j=!0,t.g.abort(),t.j=!1),t.l=e,t.m=5,Ge(t),Qe(t)}function Ge(t){t.A||(t.A=!0,st(t,"complete"),st(t,"error"))}function Ke(t){if(t.h&&void 0!==r&&(!t.v[1]||4!=Ye(t)||2!=t.Z()))if(t.u&&4==Ye(t))ct(t.Ea,0,t);else if(st(t,"readystatechange"),4==Ye(t)){t.h=!1;try{const r=t.Z();t:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var s;if(s=0===r){var o=String(t.D).match(le)[1]||null;!o&&i.self&&i.self.location&&(o=i.self.location.protocol.slice(0,-1)),s=!$e.test(o?o.toLowerCase():"")}n=s}if(n)st(t,"complete"),st(t,"success");else{t.m=6;try{var a=2<Ye(t)?t.g.statusText:""}catch(at){a=""}t.l=a+" ["+t.Z()+"]",Ge(t)}}finally{Qe(t)}}}function Qe(t,e){if(t.g){We(t);const n=t.g,r=t.v[0]?()=>{}:null;t.g=null,t.v=null,e||st(t,"ready");try{n.onreadystatechange=r}catch(rt){}}}function We(t){t.I&&(i.clearTimeout(t.I),t.I=null)}function Ye(t){return t.g?t.g.readyState:0}function Xe(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.H){case"":case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Je(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Ze(t){this.Aa=0,this.i=[],this.j=new Lt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Je("failFast",!1,t),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Je("baseRetryDelayMs",5e3,t),this.cb=Je("retryDelaySeedMs",1e4,t),this.Wa=Je("forwardChannelMaxRetries",2,t),this.wa=Je("forwardChannelRequestTimeoutMs",2e4,t),this.pa=t&&t.xmlHttpFactory||void 0,this.Xa=t&&t.Tb||void 0,this.Ca=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.h=new ne(t&&t.concurrentRequestLimit),this.Da=new Re,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=t&&t.Rb||!1,t&&t.xa&&this.j.xa(),t&&t.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&t&&t.detectBufferingProxy||!1,this.ja=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.ja=t.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function tn(t){if(nn(t),3==t.G){var e=t.U++,n=fe(t.I);if(me(n,"SID",t.K),me(n,"RID",e),me(n,"TYPE","terminate"),on(t,n),(e=new Bt(t,t.j,e)).L=2,e.v=ye(fe(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(e.v.toString(),"")}catch(lt){}!n&&i.Image&&((new Image).src=e.v,n=!0),n||(e.g=_n(e.j,null),e.g.ea(e.v)),e.F=Date.now(),Wt(e)}mn(t)}function en(t){t.g&&(ln(t),t.g.cancel(),t.g=null)}function nn(t){en(t),t.u&&(i.clearTimeout(t.u),t.u=null),fn(t),t.h.cancel(),t.s&&("number"==typeof t.s&&i.clearTimeout(t.s),t.s=null)}function rn(t){if(!re(t.h)&&!t.s){t.s=!0;var e=t.Ga;A||k(),D||(A(),D=!0),N.add(e,t),t.B=0}}function sn(t,e){var n;n=e?e.l:t.U++;const r=fe(t.I);me(r,"SID",t.K),me(r,"RID",n),me(r,"AID",t.T),on(t,r),t.m&&t.o&&Be(r,t.m,t.o),n=new Bt(t,t.j,n,t.B+1),null===t.m&&(n.H=t.o),e&&(t.i=e.D.concat(t.i)),e=an(t,n,1e3),n.I=Math.round(.5*t.wa)+Math.round(.5*t.wa*Math.random()),oe(t.h,n),Ht(n,r,e)}function on(t,e){t.H&&_(t.H,(function(t,n){me(e,n,t)})),t.l&&ce({},(function(t,n){me(e,n,t)}))}function an(t,e,n){n=Math.min(t.i.length,n);var r=t.l?c(t.l.Na,t.l,t):null;t:{var i=t.i;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=i[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=i[o].g;const a=i[o].map;if(n-=e,0>n)e=Math.max(0,i[o].g-100),s=!1;else try{Pe(a,t,"req"+n+"_")}catch(Pt){r&&r(a)}}if(s){r=t.join("&");break t}}}return t=t.i.splice(0,n),e.D=t,r}function un(t){if(!t.g&&!t.u){t.Y=1;var e=t.Fa;A||k(),D||(A(),D=!0),N.add(e,t),t.v=0}}function cn(t){return!(t.g||t.u||3<=t.v)&&(t.Y++,t.u=Rt(c(t.Fa,t),pn(t,t.v)),t.v++,!0)}function ln(t){null!=t.A&&(i.clearTimeout(t.A),t.A=null)}function hn(t){t.g=new Bt(t,t.j,"rpc",t.Y),null===t.m&&(t.g.H=t.o),t.g.O=0;var e=fe(t.qa);me(e,"RID","rpc"),me(e,"SID",t.K),me(e,"AID",t.T),me(e,"CI",t.F?"0":"1"),!t.F&&t.ja&&me(e,"TO",t.ja),me(e,"TYPE","xmlhttp"),on(t,e),t.m&&t.o&&Be(e,t.m,t.o),t.L&&(t.g.I=t.L);var n=t.g;t=t.ia,n.L=1,n.v=ye(fe(e)),n.m=null,n.P=!0,Gt(n,t)}function fn(t){null!=t.C&&(i.clearTimeout(t.C),t.C=null)}function dn(t,e){var n=null;if(t.g==e){fn(t),ln(t),t.g=null;var r=2}else{if(!se(t.h,e))return;n=e.D,ae(t.h,e),r=1}if(0!=t.G)if(e.o)if(1==r){n=e.m?e.m.length:0,e=Date.now()-e.F;var i=t.B;st(r=At(),new Ot(r,n)),rn(t)}else un(t);else if(3==(i=e.s)||0==i&&0<e.X||!(1==r&&function(t,e){return!(ie(t.h)>=t.h.j-(t.s?1:0)||(t.s?(t.i=e.D.concat(t.i),0):1==t.G||2==t.G||t.B>=(t.Va?0:t.Wa)||(t.s=Rt(c(t.Ga,t,e),pn(t,t.B)),t.B++,0)))}(t,e)||2==r&&cn(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),i){case 1:gn(t,5);break;case 4:gn(t,10);break;case 3:gn(t,6);break;default:gn(t,2)}}function pn(t,e){let n=t.Ta+Math.floor(Math.random()*t.cb);return t.isActive()||(n*=2),n*e}function gn(t,e){if(t.j.info("Error code "+e),2==e){var n=c(t.fb,t),r=t.Xa;const e=!r;r=new he(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||de(r,"https"),ye(r),e?function(t,e){const n=new Lt;if(i.Image){const r=new Image;r.onload=l(Oe,n,"TestLoadImage: loaded",!0,e,r),r.onerror=l(Oe,n,"TestLoadImage: error",!1,e,r),r.onabort=l(Oe,n,"TestLoadImage: abort",!1,e,r),r.ontimeout=l(Oe,n,"TestLoadImage: timeout",!1,e,r),i.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(r.toString(),n):function(t,e){new Lt;const n=new AbortController,r=setTimeout((()=>{n.abort(),Oe(0,0,!1,e)}),1e4);fetch(t,{signal:n.signal}).then((t=>{clearTimeout(r),t.ok?Oe(0,0,!0,e):Oe(0,0,!1,e)})).catch((()=>{clearTimeout(r),Oe(0,0,!1,e)}))}(r.toString(),n)}else xt(2);t.G=0,t.l&&t.l.sa(e),mn(t),nn(t)}function mn(t){if(t.G=0,t.ka=[],t.l){const e=ue(t.h);0==e.length&&0==t.i.length||(d(t.ka,e),d(t.ka,t.i),t.h.i.length=0,f(t.i),t.i.length=0),t.l.ra()}}function yn(t,e,n){var r=n instanceof he?fe(n):new he(n);if(""!=r.g)e&&(r.g=e+"."+r.g),pe(r,r.s);else{var s=i.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var o=new he(null);r&&de(o,r),e&&(o.g=e),s&&pe(o,s),n&&(o.l=n),r=o}return n=t.D,e=t.ya,n&&e&&me(r,n,e),me(r,"VER",t.la),on(t,r),r}function _n(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ca&&!t.pa?new qe(new Le({eb:n})):new qe(t.pa)).Ha(t.J),e}function vn(){}function wn(){}function bn(t,e){tt.call(this),this.g=new Ze(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.o=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.va&&(t?t["X-WebChannel-Client-Profile"]=e.va:t={"X-WebChannel-Client-Profile":e.va}),this.g.S=t,(t=e&&e.Sb)&&!p(t)&&(this.g.m=t),this.v=e&&e.supportsCrossDomainXhr||!1,this.u=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!p(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Cn(this)}function En(t){Tt.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Tn(){Ct.call(this),this.status=1}function Cn(t){this.g=t}(t=qe.prototype).Ha=function(t){this.J=t},t.ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Vt.g(),this.v=this.o?wt(this.o):wt(Vt),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(e,String(t),!0),this.B=!1}catch(et){return void He(this,et)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const t of r.keys())n.set(t,r.get(t))}r=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),s=i.FormData&&t instanceof i.FormData,!(0<=Array.prototype.indexOf.call(ze,e,void 0))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{We(this),this.u=!0,this.g.send(t),this.u=!1}catch(et){He(this,et)}},t.abort=function(t){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=t||7,st(this,"complete"),st(this,"abort"),Qe(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Qe(this,!0)),qe.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ke(this):this.bb())},t.bb=function(){Ke(this)},t.isActive=function(){return!!this.g},t.Z=function(){try{return 2<Ye(this)?this.g.status:-1}catch(it){return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch(it){return""}},t.Oa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),yt(e)}},t.Ba=function(){return this.m},t.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(t=Ze.prototype).la=8,t.G=1,t.connect=function(t,e,n,r){xt(0),this.W=t,this.H=e||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=yn(this,null,this.W),rn(this)},t.Ga=function(t){if(this.s)if(this.s=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const i=new Bt(this,this.j,t);let s=this.o;if(this.S&&(s?(s=v(s),b(s,this.S)):s=this.S),null!==this.m||this.O||(i.H=s,s=null),this.P)t:{for(var e=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=n;break t}if(4096===e||n===this.i.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=an(this,i,e),me(n=fe(this.I),"RID",t),me(n,"CVER",22),this.D&&me(n,"X-HTTP-Session-Id",this.D),on(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(je(s)))+"&"+e:this.m&&Be(n,this.m,s)),oe(this.h,i),this.Ua&&me(n,"TYPE","init"),this.P?(me(n,"$req",e),me(n,"SID","null"),i.T=!0,Ht(i,n,null)):Ht(i,n,e),this.G=2}}else 3==this.G&&(t?sn(this,t):0==this.i.length||re(this.h)||sn(this))},t.Fa=function(){if(this.u=null,hn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var t=2*this.R;this.j.info("BP detection timer enabled: "+t),this.A=Rt(c(this.ab,this),t)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,xt(10),en(this),hn(this))},t.Za=function(){null!=this.C&&(this.C=null,en(this),cn(this),xt(19))},t.fb=function(t){t?(this.j.info("Successfully pinged google.com"),xt(2)):(this.j.info("Failed to ping google.com"),xt(1))},t.isActive=function(){return!!this.l&&this.l.isActive(this)},(t=vn.prototype).ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){},wn.prototype.g=function(t,e){return new bn(t,e)},h(bn,tt),bn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},bn.prototype.close=function(){tn(this.g)},bn.prototype.o=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.u&&((n={}).__data__=mt(t),t=n);e.i.push(new ee(e.Ya++,t)),3==e.G&&rn(e)},bn.prototype.N=function(){this.g.l=null,delete this.j,tn(this.g),delete this.g,bn.aa.N.call(this)},h(En,Tt),h(Tn,Ct),h(Cn,vn),Cn.prototype.ua=function(){st(this.g,"a")},Cn.prototype.ta=function(t){st(this.g,new En(t))},Cn.prototype.sa=function(t){st(this.g,new Tn)},Cn.prototype.ra=function(){st(this.g,"b")},wn.prototype.createWebChannel=wn.prototype.g,bn.prototype.send=bn.prototype.o,bn.prototype.open=bn.prototype.m,bn.prototype.close=bn.prototype.close,Xi=function(){return new wn},Yi=function(){return At()},Wi=St,Qi={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ft.NO_ERROR=0,Ft.TIMEOUT=8,Ft.HTTP_ERROR=6,Ki=Ft,Ut.COMPLETE="complete",Gi=Ut,bt.EventType=Et,Et.OPEN="a",Et.CLOSE="b",Et.ERROR="c",Et.MESSAGE="d",tt.prototype.listen=tt.prototype.K,Hi=bt,qe.prototype.listenOnce=qe.prototype.L,qe.prototype.getLastError=qe.prototype.Ka,qe.prototype.getLastErrorCode=qe.prototype.Ba,qe.prototype.getStatus=qe.prototype.Z,qe.prototype.getResponseJson=qe.prototype.Oa,qe.prototype.getResponseText=qe.prototype.oa,qe.prototype.send=qe.prototype.ea,qe.prototype.setWithCredentials=qe.prototype.Ha,zi=qe}).apply(void 0!==Ji?Ji:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});const Zi="@firebase/firestore",ts="4.7.17";class es{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}es.UNAUTHENTICATED=new es(null),es.GOOGLE_CREDENTIALS=new es("google-credentials-uid"),es.FIRST_PARTY=new es("first-party-uid"),es.MOCK_USER=new es("mock-user");let ns="11.9.0";const rs=new Ar("@firebase/firestore");function is(){return rs.logLevel}function ss(t,...e){if(rs.logLevel<=Er.DEBUG){const n=e.map(us);rs.debug(`Firestore (${ns}): ${t}`,...n)}}function os(t,...e){if(rs.logLevel<=Er.ERROR){const n=e.map(us);rs.error(`Firestore (${ns}): ${t}`,...n)}}function as(t,...e){if(rs.logLevel<=Er.WARN){const n=e.map(us);rs.warn(`Firestore (${ns}): ${t}`,...n)}}function us(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(Y){return t}}function cs(t,e,n){let r="Unexpected state";"string"==typeof e?r=e:n=e,ls(t,r,n)}function ls(t,e,n){let r=`FIRESTORE (${ns}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(t){r+=" CONTEXT: "+n}throw os(r),new Error(r)}function hs(t,e,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,t||ls(e,i,r)}function fs(t,e){return t}const ds={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ps extends fr{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class gs{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class ms{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class ys{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(es.UNAUTHENTICATED)))}shutdown(){}}class _s{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class vs{constructor(t){this.t=t,this.currentUser=es.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){hs(void 0===this.o,42304);let n=this.i;const r=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let i=new gs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new gs,t.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const e=i;t.enqueueRetryable((async()=>{await e.promise,await r(this.currentUser)}))},o=t=>{ss("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(ss("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new gs)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(ss("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(hs("string"==typeof e.accessToken,31837,{l:e}),new ms(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return hs(null===t||"string"==typeof t,2055,{h:t}),new es(t)}}class ws{constructor(t,e,n){this.P=t,this.T=e,this.I=n,this.type="FirstParty",this.user=es.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class bs{constructor(t,e,n){this.P=t,this.T=e,this.I=n}getToken(){return Promise.resolve(new ws(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(es.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Es{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ts{constructor(t,e){var n;this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,null!=(n=t)&&void 0!==n.settings&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){hs(void 0===this.o,3512);const n=t=>{null!=t.error&&ss("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.m;return this.m=t.token,ss("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const r=t=>{ss("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((t=>r(t))),setTimeout((()=>{if(!this.appCheck){const t=this.V.getImmediate({optional:!0});t?r(t):ss("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Es(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(hs("string"==typeof t.token,44558,{tokenResult:t}),this.m=t.token,new Es(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Cs(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}function Ss(){return new TextEncoder}class Is{static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=Cs(40);for(let r=0;r<n.length;++r)e.length<20&&n[r]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return e}}function As(t,e){return t<e?-1:t>e?1:0}function Ds(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),i=e.codePointAt(n);if(r!==i){if(r<128&&i<128)return As(r,i);{const s=Ss(),o=ks(s.encode(Ns(t,n)),s.encode(Ns(e,n)));return 0!==o?o:As(r,i)}}n+=r>65535?2:1}return As(t.length,e.length)}function Ns(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function ks(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return As(t[n],e[n]);return As(t.length,e.length)}function xs(t,e,n){return t.length===e.length&&t.every(((t,r)=>n(t,e[r])))}const Os=-62135596800,Rs=1e6;class Ps{static now(){return Ps.fromMillis(Date.now())}static fromDate(t){return Ps.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor((t-1e3*e)*Rs);return new Ps(e,n)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new ps(ds.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new ps(ds.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<Os)throw new ps(ds.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new ps(ds.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Rs}_compareTo(t){return this.seconds===t.seconds?As(this.nanoseconds,t.nanoseconds):As(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds-Os;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ls{static fromTimestamp(t){return new Ls(t)}static min(){return new Ls(new Ps(0,0))}static max(){return new Ls(new Ps(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ms="__name__";class Vs{constructor(t,e,n){void 0===e?e=0:e>t.length&&cs(637,{offset:e,range:t.length}),void 0===n?n=t.length-e:n>t.length-e&&cs(1746,{length:n,range:t.length-e}),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Vs.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Vs?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=Vs.compareSegments(t.get(r),e.get(r));if(0!==n)return n}return As(t.length,e.length)}static compareSegments(t,e){const n=Vs.isNumericId(t),r=Vs.isNumericId(e);return n&&!r?-1:!n&&r?1:n&&r?Vs.extractNumericId(t).compare(Vs.extractNumericId(e)):Ds(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Bi.fromString(t.substring(4,t.length-2))}}class Fs extends Vs{construct(t,e,n){return new Fs(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new ps(ds.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new Fs(e)}static emptyPath(){return new Fs([])}}const Us=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class js extends Vs{construct(t,e,n){return new js(t,e,n)}static isValidIdentifier(t){return Us.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),js.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Ms}static keyField(){return new js([Ms])}static fromServerFormat(t){const e=[];let n="",r=0;const i=()=>{if(0===n.length)throw new ps(ds.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;r<t.length;){const e=t[r];if("\\"===e){if(r+1===t.length)throw new ps(ds.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[r+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new ps(ds.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,r+=2}else"`"===e?(s=!s,r++):"."!==e||s?(n+=e,r++):(i(),r++)}if(i(),s)throw new ps(ds.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new js(e)}static emptyPath(){return new js([])}}class Bs{constructor(t){this.path=t}static fromPath(t){return new Bs(Fs.fromString(t))}static fromName(t){return new Bs(Fs.fromString(t).popFirst(5))}static empty(){return new Bs(Fs.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Fs.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Fs.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Bs(new Fs(t.slice()))}}function qs(t){return new $s(t.readTime,t.key,-1)}class $s{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new $s(Ls.min(),Bs.empty(),-1)}static max(){return new $s(Ls.max(),Bs.empty(),-1)}}function zs(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=Bs.comparator(t.documentKey,e.documentKey),0!==n?n:As(t.largestBatchId,e.largestBatchId))}const Hs="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Gs{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Ks(t){if(t.code!==ds.FAILED_PRECONDITION||t.message!==Hs)throw t;ss("LocalStore","Unexpectedly lost primary lease")}class Qs{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&cs(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Qs(((n,r)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,r)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,r)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Qs?e:Qs.resolve(e)}catch(t){return Qs.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Qs.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Qs.reject(e)}static resolve(t){return new Qs(((e,n)=>{e(t)}))}static reject(t){return new Qs(((e,n)=>{n(t)}))}static waitFor(t){return new Qs(((e,n)=>{let r=0,i=0,s=!1;t.forEach((t=>{++r,t.next((()=>{++i,s&&i===r&&e()}),(t=>n(t)))})),s=!0,i===r&&e()}))}static or(t){let e=Qs.resolve(!1);for(const n of t)e=e.next((t=>t?Qs.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,r)=>{n.push(e.call(this,t,r))})),this.waitFor(n)}static mapArray(t,e){return new Qs(((n,r)=>{const i=t.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const u=a;e(t[u]).next((t=>{s[u]=t,++o,o===i&&n(s)}),(t=>r(t)))}}))}static doWhile(t,e){return new Qs(((n,r)=>{const i=()=>{!0===t()?e().next((()=>{i()}),r):n()};i()}))}}function Ws(t){return"IndexedDbTransactionError"===t.name}class Ys{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.ue(t),this.ce=t=>e.writeSequenceNumber(t))}ue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ce&&this.ce(t),t}}Ys.le=-1;function Xs(t){return null==t}function Js(t){return 0===t&&1/t==-1/0}function Zs(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const e=t.charAt(i);switch(e){case"\0":n+="";break;case"":n+="";break;default:n+=e}}return n}function to(t){return t+""}function eo(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function no(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ro(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class io{constructor(t,e){this.comparator=t,this.root=e||oo.EMPTY}insert(t,e){return new io(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,oo.BLACK,null,null))}remove(t){return new io(this.comparator,this.root.remove(t,this.comparator).copy(null,null,oo.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new so(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new so(this.root,t,this.comparator,!1)}getReverseIterator(){return new so(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new so(this.root,t,this.comparator,!0)}}class so{constructor(t,e,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?n(t.key,e):1,e&&r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class oo{constructor(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:oo.RED,this.left=null!=r?r:oo.EMPTY,this.right=null!=i?i:oo.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,r,i){return new oo(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let r=this;const i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return oo.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===e(t,r.key)){if(r.right.isEmpty())return oo.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,oo.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,oo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw cs(43730,{key:this.key,value:this.value});if(this.right.isRed())throw cs(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw cs(27949);return t+(this.isRed()?0:1)}}oo.EMPTY=null,oo.RED=!0,oo.BLACK=!1,oo.EMPTY=new class{constructor(){this.size=0}get key(){throw cs(57766)}get value(){throw cs(16141)}get color(){throw cs(16727)}get left(){throw cs(29726)}get right(){throw cs(36894)}copy(t,e,n,r,i){return this}insert(t,e,n){return new oo(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ao{constructor(t){this.comparator=t,this.data=new io(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new uo(this.data.getIterator())}getIteratorFrom(t){return new uo(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof ao))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,r=n.getNext().key;if(0!==this.comparator(t,r))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new ao(this.comparator);return e.data=t,e}}class uo{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class co{constructor(t){this.fields=t,t.sort(js.comparator)}static empty(){return new co([])}unionWith(t){let e=new ao(js.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new co(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return xs(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class lo extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ho{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new lo("Invalid base64 string: "+t):t}}(t);return new ho(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new ho(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return As(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}ho.EMPTY_BYTE_STRING=new ho("");const fo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function po(t){if(hs(!!t,39018),"string"==typeof t){let e=0;const n=fo.exec(t);if(hs(!!n,46558,{timestamp:t}),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:go(t.seconds),nanos:go(t.nanos)}}function go(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function mo(t){return"string"==typeof t?ho.fromBase64String(t):ho.fromUint8Array(t)}const yo="server_timestamp",_o="__type__",vo="__previous_value__",wo="__local_write_time__";function bo(t){var e,n;return(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{})[_o])||void 0===n?void 0:n.stringValue)===yo}function Eo(t){const e=t.mapValue.fields[vo];return bo(e)?Eo(e):e}function To(t){const e=po(t.mapValue.fields[wo].timestampValue);return new Ps(e.seconds,e.nanos)}class Co{constructor(t,e,n,r,i,s,o,a,u,c){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=u,this.isUsingEmulator=c}}const So="(default)";class Io{constructor(t,e){this.projectId=t,this.database=e||So}static empty(){return new Io("","")}get isDefaultDatabase(){return this.database===So}isEqual(t){return t instanceof Io&&t.projectId===this.projectId&&t.database===this.database}}const Ao="__type__",Do="__max__",No={},ko="__vector__",xo="value";function Oo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?bo(t)?4:function(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Do}(t)?9007199254740991:function(t){var e,n;return(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{})[Ao])||void 0===n?void 0:n.stringValue)===ko}(t)?10:11:cs(28295,{value:t})}function Ro(t,e){if(t===e)return!0;const n=Oo(t);if(n!==Oo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return To(t).isEqual(To(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=po(t.timestampValue),r=po(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return mo(t.bytesValue).isEqual(mo(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return go(t.geoPointValue.latitude)===go(e.geoPointValue.latitude)&&go(t.geoPointValue.longitude)===go(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return go(t.integerValue)===go(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=go(t.doubleValue),r=go(e.doubleValue);return n===r?Js(n)===Js(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return xs(t.arrayValue.values||[],e.arrayValue.values||[],Ro);case 10:case 11:return function(t,e){const n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(eo(n)!==eo(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ro(n[i],r[i])))return!1;return!0}(t,e);default:return cs(52216,{left:t})}}function Po(t,e){return void 0!==(t.values||[]).find((t=>Ro(t,e)))}function Lo(t,e){if(t===e)return 0;const n=Oo(t),r=Oo(e);if(n!==r)return As(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return As(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=go(t.integerValue||t.doubleValue),r=go(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Mo(t.timestampValue,e.timestampValue);case 4:return Mo(To(t),To(e));case 5:return Ds(t.stringValue,e.stringValue);case 6:return function(t,e){const n=mo(t),r=mo(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),r=e.split("/");for(let i=0;i<n.length&&i<r.length;i++){const t=As(n[i],r[i]);if(0!==t)return t}return As(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=As(go(t.latitude),go(e.latitude));return 0!==n?n:As(go(t.longitude),go(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Vo(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n,r,i,s;const o=t.fields||{},a=e.fields||{},u=null===(n=o[xo])||void 0===n?void 0:n.arrayValue,c=null===(r=a[xo])||void 0===r?void 0:r.arrayValue,l=As((null===(i=null==u?void 0:u.values)||void 0===i?void 0:i.length)||0,(null===(s=null==c?void 0:c.values)||void 0===s?void 0:s.length)||0);return 0!==l?l:Vo(u,c)}(t.mapValue,e.mapValue);case 11:return function(t,e){if(t===No&&e===No)return 0;if(t===No)return 1;if(e===No)return-1;const n=t.fields||{},r=Object.keys(n),i=e.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const t=Ds(r[o],s[o]);if(0!==t)return t;const e=Lo(n[r[o]],i[s[o]]);if(0!==e)return e}return As(r.length,s.length)}(t.mapValue,e.mapValue);default:throw cs(23264,{Pe:n})}}function Mo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return As(t,e);const n=po(t),r=po(e),i=As(n.seconds,r.seconds);return 0!==i?i:As(n.nanos,r.nanos)}function Vo(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const t=Lo(n[i],r[i]);if(t)return t}return As(n.length,r.length)}function Fo(t){return Uo(t)}function Uo(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=po(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return mo(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return Bs.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return`geo(${t.latitude},${t.longitude})`}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const r of t.values||[])n?n=!1:e+=",",e+=Uo(r);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",r=!0;for(const i of e)r?r=!1:n+=",",n+=`${i}:${Uo(t.fields[i])}`;return n+"}"}(t.mapValue):cs(61005,{value:t})}function jo(t){switch(Oo(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Eo(t);return e?16+jo(e):16;case 5:return 2*t.stringValue.length;case 6:return mo(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(t){return(t.values||[]).reduce(((t,e)=>t+jo(e)),0)}(t.arrayValue);case 10:case 11:return function(t){let e=0;return no(t.fields,((t,n)=>{e+=t.length+jo(n)})),e}(t.mapValue);default:throw cs(13486,{value:t})}}function Bo(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function qo(t){return!!t&&"integerValue"in t}function $o(t){return!!t&&"arrayValue"in t}function zo(t){return!!t&&"nullValue"in t}function Ho(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Go(t){return!!t&&"mapValue"in t}function Ko(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return no(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Ko(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ko(t.arrayValue.values[n]);return e}return Object.assign({},t)}class Qo{constructor(t){this.value=t}static empty(){return new Qo({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Go(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ko(e)}setAll(t){let e=js.emptyPath(),n={},r=[];t.forEach(((t,i)=>{if(!e.isImmediateParentOf(i)){const t=this.getFieldsMap(e);this.applyChanges(t,n,r),n={},r=[],e=i.popLast()}t?n[i.lastSegment()]=Ko(t):r.push(i.lastSegment())}));const i=this.getFieldsMap(e);this.applyChanges(i,n,r)}delete(t){const e=this.field(t.popLast());Go(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Ro(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let r=e.mapValue.fields[t.get(n)];Go(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,n){no(e,((e,n)=>t[e]=n));for(const r of n)delete t[r]}clone(){return new Qo(Ko(this.value))}}class Wo{constructor(t,e,n,r,i,s,o){this.key=t,this.documentType=e,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(t){return new Wo(t,0,Ls.min(),Ls.min(),Ls.min(),Qo.empty(),0)}static newFoundDocument(t,e,n,r){return new Wo(t,1,e,Ls.min(),n,r,0)}static newNoDocument(t,e){return new Wo(t,2,e,Ls.min(),Ls.min(),Qo.empty(),0)}static newUnknownDocument(t,e){return new Wo(t,3,e,Ls.min(),Ls.min(),Qo.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Ls.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Qo.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Qo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ls.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Wo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Wo(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Yo{constructor(t,e){this.position=t,this.inclusive=e}}function Xo(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(r=s.field.isKeyField()?Bs.comparator(Bs.fromName(o.referenceValue),n.key):Lo(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Jo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ro(t.position[n],e.position[n]))return!1;return!0}class Zo{constructor(t,e="asc"){this.field=t,this.dir=e}}function ta(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class ea{}class na extends ea{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new ca(t,e,n):"array-contains"===e?new da(t,n):"in"===e?new pa(t,n):"not-in"===e?new ga(t,n):"array-contains-any"===e?new ma(t,n):new na(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new la(t,n):new ha(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&void 0===e.nullValue&&this.matchesComparison(Lo(e,this.value)):null!==e&&Oo(this.value)===Oo(e)&&this.matchesComparison(Lo(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return cs(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ra extends ea{constructor(t,e){super(),this.filters=t,this.op=e,this.Te=null}static create(t,e){return new ra(t,e)}matches(t){return ia(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.Te||(this.Te=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function ia(t){return"and"===t.op}function sa(t){return function(t){for(const e of t.filters)if(e instanceof ra)return!1;return!0}(t)&&ia(t)}function oa(t){if(t instanceof na)return t.field.canonicalString()+t.op.toString()+Fo(t.value);if(sa(t))return t.filters.map((t=>oa(t))).join(",");{const e=t.filters.map((t=>oa(t))).join(",");return`${t.op}(${e})`}}function aa(t,e){return t instanceof na?function(t,e){return e instanceof na&&t.op===e.op&&t.field.isEqual(e.field)&&Ro(t.value,e.value)}(t,e):t instanceof ra?function(t,e){return e instanceof ra&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,r)=>t&&aa(n,e.filters[r])),!0)}(t,e):void cs(19439)}function ua(t){return t instanceof na?function(t){return`${t.field.canonicalString()} ${t.op} ${Fo(t.value)}`}(t):t instanceof ra?function(t){return t.op.toString()+" {"+t.getFilters().map(ua).join(" ,")+"}"}(t):"Filter"}class ca extends na{constructor(t,e,n){super(t,e,n),this.key=Bs.fromName(n.referenceValue)}matches(t){const e=Bs.comparator(t.key,this.key);return this.matchesComparison(e)}}class la extends na{constructor(t,e){super(t,"in",e),this.keys=fa("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class ha extends na{constructor(t,e){super(t,"not-in",e),this.keys=fa("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function fa(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Bs.fromName(t.referenceValue)))}class da extends na{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return $o(e)&&Po(e.arrayValue,this.value)}}class pa extends na{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Po(this.value.arrayValue,e)}}class ga extends na{constructor(t,e){super(t,"not-in",e)}matches(t){if(Po(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&void 0===e.nullValue&&!Po(this.value.arrayValue,e)}}class ma extends na{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!$o(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Po(this.value.arrayValue,t)))}}class ya{constructor(t,e=null,n=[],r=[],i=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.Ie=null}}function _a(t,e=null,n=[],r=[],i=null,s=null,o=null){return new ya(t,e,n,r,i,s,o)}function va(t){const e=fs(t);if(null===e.Ie){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>oa(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),Xs(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Fo(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Fo(t))).join(",")),e.Ie=t}return e.Ie}function wa(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!ta(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!aa(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Jo(t.startAt,e.startAt)&&Jo(t.endAt,e.endAt)}function ba(t){return Bs.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class Ea{constructor(t,e=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function Ta(t){return new Ea(t)}function Ca(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function Sa(t){return null!==t.collectionGroup}function Ia(t){const e=fs(t);if(null===e.Ee){e.Ee=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ee.push(i),t.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",r=function(t){let e=new ao(js.comparator);return t.filters.forEach((t=>{t.getFlattenedFilters().forEach((t=>{t.isInequality()&&(e=e.add(t.field))}))})),e}(e);r.forEach((r=>{t.has(r.canonicalString())||r.isKeyField()||e.Ee.push(new Zo(r,n))})),t.has(js.keyField().canonicalString())||e.Ee.push(new Zo(js.keyField(),n))}return e.Ee}function Aa(t){const e=fs(t);return e.de||(e.de=function(t,e){if("F"===t.limitType)return _a(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((t=>{const e="desc"===t.dir?"asc":"desc";return new Zo(t.field,e)}));const n=t.endAt?new Yo(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Yo(t.startAt.position,t.startAt.inclusive):null;return _a(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}(e,Ia(t))),e.de}function Da(t,e){const n=t.filters.concat([e]);return new Ea(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Na(t,e,n){return new Ea(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ka(t,e){return wa(Aa(t),Aa(e))&&t.limitType===e.limitType}function xa(t){return`${va(Aa(t))}|lt:${t.limitType}`}function Oa(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>ua(t))).join(", ")}]`),Xs(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Fo(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Fo(t))).join(",")),`Target(${e})`}(Aa(t))}; limitType=${t.limitType})`}function Ra(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Bs.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of Ia(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const r=Xo(t,e,n);return t.inclusive?r<=0:r<0}(t.startAt,Ia(t),e))&&!(t.endAt&&!function(t,e,n){const r=Xo(t,e,n);return t.inclusive?r>=0:r>0}(t.endAt,Ia(t),e))}(t,e)}function Pa(t){return(e,n)=>{let r=!1;for(const i of Ia(t)){const t=La(i,e,n);if(0!==t)return t;r=r||i.field.isKeyField()}return 0}}function La(t,e,n){const r=t.field.isKeyField()?Bs.comparator(e.key,n.key):function(t,e,n){const r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Lo(r,i):cs(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return cs(19790,{direction:t.dir})}}class Ma{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),r=this.inner[n];if(void 0===r)return this.inner[n]=[[t,e]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(t){no(this.inner,((e,n)=>{for(const[r,i]of n)t(r,i)}))}isEmpty(){return ro(this.inner)}size(){return this.innerSize}}const Va=new io(Bs.comparator);function Fa(){return Va}const Ua=new io(Bs.comparator);function ja(...t){let e=Ua;for(const n of t)e=e.insert(n.key,n);return e}function Ba(t){let e=Ua;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function qa(){return za()}function $a(){return za()}function za(){return new Ma((t=>t.toString()),((t,e)=>t.isEqual(e)))}const Ha=new ao(Bs.comparator);function Ga(...t){let e=Ha;for(const n of t)e=e.add(n);return e}const Ka=new ao(As);function Qa(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Js(e)?"-0":e}}function Wa(t){return{integerValue:""+t}}function Ya(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!Js(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?Wa(e):Qa(t,e)}class Xa{constructor(){this._=void 0}}function Ja(t,e,n){return t instanceof tu?function(t,e){const n={fields:{[_o]:{stringValue:yo},[wo]:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&bo(e)&&(e=Eo(e)),e&&(n.fields[vo]=e),{mapValue:n}}(n,e):t instanceof eu?nu(t,e):t instanceof ru?iu(t,e):function(t,e){const n=function(t,e){return t instanceof su?function(t){return qo(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}(t,e),r=ou(n)+ou(t.Re);return qo(n)&&qo(t.Re)?Wa(r):Qa(t.serializer,r)}(t,e)}function Za(t,e,n){return t instanceof eu?nu(t,e):t instanceof ru?iu(t,e):n}class tu extends Xa{}class eu extends Xa{constructor(t){super(),this.elements=t}}function nu(t,e){const n=au(e);for(const r of t.elements)n.some((t=>Ro(t,r)))||n.push(r);return{arrayValue:{values:n}}}class ru extends Xa{constructor(t){super(),this.elements=t}}function iu(t,e){let n=au(e);for(const r of t.elements)n=n.filter((t=>!Ro(t,r)));return{arrayValue:{values:n}}}class su extends Xa{constructor(t,e){super(),this.serializer=t,this.Re=e}}function ou(t){return go(t.integerValue||t.doubleValue)}function au(t){return $o(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class uu{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new uu}static exists(t){return new uu(void 0,t)}static updateTime(t){return new uu(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function cu(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class lu{}function hu(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new wu(t.key,uu.none()):new gu(t.key,t.data,uu.none());{const n=t.data,r=Qo.empty();let i=new ao(js.comparator);for(let t of e.fields)if(!i.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?r.delete(t):r.set(t,e),i=i.add(t)}return new mu(t.key,r,new co(i.toArray()),uu.none())}}function fu(t,e,n){t instanceof gu?function(t,e,n){const r=t.value.clone(),i=_u(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof mu?function(t,e,n){if(!cu(t.precondition,e))return void e.convertToUnknownDocument(n.version);const r=_u(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(yu(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function du(t,e,n,r){return t instanceof gu?function(t,e,n,r){if(!cu(t.precondition,e))return n;const i=t.value.clone(),s=vu(t.fieldTransforms,r,e);return i.setAll(s),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}(t,e,n,r):t instanceof mu?function(t,e,n,r){if(!cu(t.precondition,e))return n;const i=vu(t.fieldTransforms,r,e),s=e.data;return s.setAll(yu(t)),s.setAll(i),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,r):function(t,e,n){return cu(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function pu(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&xs(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof eu&&e instanceof eu||t instanceof ru&&e instanceof ru?xs(t.elements,e.elements,Ro):t instanceof su&&e instanceof su?Ro(t.Re,e.Re):t instanceof tu&&e instanceof tu}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class gu extends lu{constructor(t,e,n,r=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class mu extends lu{constructor(t,e,n,r,i=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function yu(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}})),e}function _u(t,e,n){const r=new Map;hs(t.length===n.length,32656,{Ve:n.length,me:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,Za(o,a,n[i]))}return r}function vu(t,e,n){const r=new Map;for(const i of t){const t=i.transform,s=n.data.field(i.field);r.set(i.field,Ja(t,s,e))}return r}class wu extends lu{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class bu{constructor(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let r=0;r<this.mutations.length;r++){const e=this.mutations[r];e.key.isEqual(t.key)&&fu(e,t,n[r])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=du(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=du(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=$a();return this.mutations.forEach((r=>{const i=t.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=e.has(r.key)?null:o;const a=hu(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(Ls.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),Ga())}isEqual(t){return this.batchId===t.batchId&&xs(this.mutations,t.mutations,((t,e)=>pu(t,e)))&&xs(this.baseMutations,t.baseMutations,((t,e)=>pu(t,e)))}}class Eu{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Tu{constructor(t,e){this.count=t,this.unchangedNames=e}}var Cu,Su;function Iu(t){if(void 0===t)return os("GRPC error has no .code"),ds.UNKNOWN;switch(t){case Cu.OK:return ds.OK;case Cu.CANCELLED:return ds.CANCELLED;case Cu.UNKNOWN:return ds.UNKNOWN;case Cu.DEADLINE_EXCEEDED:return ds.DEADLINE_EXCEEDED;case Cu.RESOURCE_EXHAUSTED:return ds.RESOURCE_EXHAUSTED;case Cu.INTERNAL:return ds.INTERNAL;case Cu.UNAVAILABLE:return ds.UNAVAILABLE;case Cu.UNAUTHENTICATED:return ds.UNAUTHENTICATED;case Cu.INVALID_ARGUMENT:return ds.INVALID_ARGUMENT;case Cu.NOT_FOUND:return ds.NOT_FOUND;case Cu.ALREADY_EXISTS:return ds.ALREADY_EXISTS;case Cu.PERMISSION_DENIED:return ds.PERMISSION_DENIED;case Cu.FAILED_PRECONDITION:return ds.FAILED_PRECONDITION;case Cu.ABORTED:return ds.ABORTED;case Cu.OUT_OF_RANGE:return ds.OUT_OF_RANGE;case Cu.UNIMPLEMENTED:return ds.UNIMPLEMENTED;case Cu.DATA_LOSS:return ds.DATA_LOSS;default:return cs(39323,{code:t})}}(Su=Cu||(Cu={}))[Su.OK=0]="OK",Su[Su.CANCELLED=1]="CANCELLED",Su[Su.UNKNOWN=2]="UNKNOWN",Su[Su.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Su[Su.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Su[Su.NOT_FOUND=5]="NOT_FOUND",Su[Su.ALREADY_EXISTS=6]="ALREADY_EXISTS",Su[Su.PERMISSION_DENIED=7]="PERMISSION_DENIED",Su[Su.UNAUTHENTICATED=16]="UNAUTHENTICATED",Su[Su.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Su[Su.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Su[Su.ABORTED=10]="ABORTED",Su[Su.OUT_OF_RANGE=11]="OUT_OF_RANGE",Su[Su.UNIMPLEMENTED=12]="UNIMPLEMENTED",Su[Su.INTERNAL=13]="INTERNAL",Su[Su.UNAVAILABLE=14]="UNAVAILABLE",Su[Su.DATA_LOSS=15]="DATA_LOSS";const Au=new Bi([4294967295,4294967295],0);function Du(t){const e=Ss().encode(t),n=new qi;return n.update(e),new Uint8Array(n.digest())}function Nu(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Bi([n,r],0),new Bi([i,s],0)]}class ku{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new xu(`Invalid padding: ${e}`);if(n<0)throw new xu(`Invalid hash count: ${n}`);if(t.length>0&&0===this.hashCount)throw new xu(`Invalid hash count: ${n}`);if(0===t.length&&0!==e)throw new xu(`Invalid padding when bitmap length is 0: ${e}`);this.pe=8*t.length-e,this.ye=Bi.fromNumber(this.pe)}we(t,e,n){let r=t.add(e.multiply(Bi.fromNumber(n)));return 1===r.compare(Au)&&(r=new Bi([r.getBits(0),r.getBits(1)],0)),r.modulo(this.ye).toNumber()}be(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(0===this.pe)return!1;const e=Du(t),[n,r]=Nu(e);for(let i=0;i<this.hashCount;i++){const t=this.we(n,r,i);if(!this.be(t))return!1}return!0}static create(t,e,n){const r=t%8==0?0:8-t%8,i=new Uint8Array(Math.ceil(t/8)),s=new ku(i,r,e);return n.forEach((t=>s.insert(t))),s}insert(t){if(0===this.pe)return;const e=Du(t),[n,r]=Nu(e);for(let i=0;i<this.hashCount;i++){const t=this.we(n,r,i);this.Se(t)}}Se(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class xu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Ou{constructor(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const r=new Map;return r.set(t,Ru.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new Ou(Ls.min(),r,new io(As),Fa(),Ga())}}class Ru{constructor(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new Ru(n,e,Ga(),Ga(),Ga())}}class Pu{constructor(t,e,n,r){this.De=t,this.removedTargetIds=e,this.key=n,this.ve=r}}class Lu{constructor(t,e){this.targetId=t,this.Ce=e}}class Mu{constructor(t,e,n=ho.EMPTY_BYTE_STRING,r=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}}class Vu{constructor(){this.Fe=0,this.Me=ju(),this.xe=ho.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return 0!==this.Fe}get Le(){return this.Ne}ke(t){t.approximateByteSize()>0&&(this.Ne=!0,this.xe=t)}qe(){let t=Ga(),e=Ga(),n=Ga();return this.Me.forEach(((r,i)=>{switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:cs(38017,{changeType:i})}})),new Ru(this.xe,this.Oe,t,e,n)}Qe(){this.Ne=!1,this.Me=ju()}$e(t,e){this.Ne=!0,this.Me=this.Me.insert(t,e)}Ue(t){this.Ne=!0,this.Me=this.Me.remove(t)}Ke(){this.Fe+=1}We(){this.Fe-=1,hs(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class Fu{constructor(t){this.ze=t,this.je=new Map,this.He=Fa(),this.Je=Uu(),this.Ye=Uu(),this.Ze=new io(As)}Xe(t){for(const e of t.De)t.ve&&t.ve.isFoundDocument()?this.et(e,t.ve):this.tt(e,t.key,t.ve);for(const e of t.removedTargetIds)this.tt(e,t.key,t.ve)}nt(t){this.forEachTarget(t,(e=>{const n=this.rt(e);switch(t.state){case 0:this.it(e)&&n.ke(t.resumeToken);break;case 1:n.We(),n.Be||n.Qe(),n.ke(t.resumeToken);break;case 2:n.We(),n.Be||this.removeTarget(e);break;case 3:this.it(e)&&(n.Ge(),n.ke(t.resumeToken));break;case 4:this.it(e)&&(this.st(e),n.ke(t.resumeToken));break;default:cs(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.je.forEach(((t,n)=>{this.it(n)&&e(n)}))}ot(t){const e=t.targetId,n=t.Ce.count,r=this._t(e);if(r){const i=r.target;if(ba(i))if(0===n){const t=new Bs(i.path);this.tt(e,t,Wo.newNoDocument(t,Ls.min()))}else hs(1===n,20013,{expectedCount:n});else{const r=this.ut(e);if(r!==n){const n=this.ct(t),i=n?this.lt(n,t,r):1;if(0!==i){this.st(e);const t=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(e,t)}}}}}ct(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=e;let s,o;try{s=mo(n).toUint8Array()}catch(t){if(t instanceof lo)return as("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw t}try{o=new ku(s,r,i)}catch(t){return as(t instanceof xu?"BloomFilter error: ":"Applying bloom filter failed: ",t),null}return 0===o.pe?null:o}lt(t,e,n){return e.Ce.count===n-this.Tt(t,e.targetId)?0:2}Tt(t,e){const n=this.ze.getRemoteKeysForTarget(e);let r=0;return n.forEach((n=>{const i=this.ze.Pt(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;t.mightContain(s)||(this.tt(e,n,null),r++)})),r}It(t){const e=new Map;this.je.forEach(((n,r)=>{const i=this._t(r);if(i){if(n.current&&ba(i.target)){const e=new Bs(i.target.path);this.Et(e).has(r)||this.dt(r,e)||this.tt(r,e,Wo.newNoDocument(e,t))}n.Le&&(e.set(r,n.qe()),n.Qe())}}));let n=Ga();this.Ye.forEach(((t,e)=>{let r=!0;e.forEachWhile((t=>{const e=this._t(t);return!e||"TargetPurposeLimboResolution"===e.purpose||(r=!1,!1)})),r&&(n=n.add(t))})),this.He.forEach(((e,n)=>n.setReadTime(t)));const r=new Ou(t,e,this.Ze,this.He,n);return this.He=Fa(),this.Je=Uu(),this.Ye=Uu(),this.Ze=new io(As),r}et(t,e){if(!this.it(t))return;const n=this.dt(t,e.key)?2:0;this.rt(t).$e(e.key,n),this.He=this.He.insert(e.key,e),this.Je=this.Je.insert(e.key,this.Et(e.key).add(t)),this.Ye=this.Ye.insert(e.key,this.At(e.key).add(t))}tt(t,e,n){if(!this.it(t))return;const r=this.rt(t);this.dt(t,e)?r.$e(e,1):r.Ue(e),this.Ye=this.Ye.insert(e,this.At(e).delete(t)),this.Ye=this.Ye.insert(e,this.At(e).add(t)),n&&(this.He=this.He.insert(e,n))}removeTarget(t){this.je.delete(t)}ut(t){const e=this.rt(t).qe();return this.ze.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ke(t){this.rt(t).Ke()}rt(t){let e=this.je.get(t);return e||(e=new Vu,this.je.set(t,e)),e}At(t){let e=this.Ye.get(t);return e||(e=new ao(As),this.Ye=this.Ye.insert(t,e)),e}Et(t){let e=this.Je.get(t);return e||(e=new ao(As),this.Je=this.Je.insert(t,e)),e}it(t){const e=null!==this._t(t);return e||ss("WatchChangeAggregator","Detected inactive target",t),e}_t(t){const e=this.je.get(t);return e&&e.Be?null:this.ze.Rt(t)}st(t){this.je.set(t,new Vu),this.ze.getRemoteKeysForTarget(t).forEach((e=>{this.tt(t,e,null)}))}dt(t,e){return this.ze.getRemoteKeysForTarget(t).has(e)}}function Uu(){return new io(Bs.comparator)}function ju(){return new io(Bs.comparator)}const Bu={asc:"ASCENDING",desc:"DESCENDING"},qu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$u={and:"AND",or:"OR"};class zu{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Hu(t,e){return t.useProto3Json||Xs(e)?e:{value:e}}function Gu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ku(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Qu(t){return hs(!!t,49232),Ls.fromTimestamp(function(t){const e=po(t);return new Ps(e.seconds,e.nanos)}(t))}function Wu(t,e){return Yu(t,e).canonicalString()}function Yu(t,e){const n=function(t){return new Fs(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function Xu(t){const e=Fs.fromString(t);return hs(fc(e),10190,{key:e.toString()}),e}function Ju(t,e){const n=Xu(e);if(n.get(1)!==t.databaseId.projectId)throw new ps(ds.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ps(ds.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Bs(ec(n))}function Zu(t,e){return Wu(t.databaseId,e)}function tc(t){return new Fs(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ec(t){return hs(t.length>4&&"documents"===t.get(4),29091,{key:t.toString()}),t.popFirst(5)}function nc(t,e){return{documents:[Zu(t,e.path)]}}function rc(t,e){const n={structuredQuery:{}},r=e.path;let i;null!==e.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Zu(t,i);const s=function(t){if(0!==t.length)return hc(ra.create(t,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:cc(t.field),direction:oc(t.dir)}}(t)))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Hu(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(t){return{before:t.inclusive,values:t.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),{gt:n,parent:i}}function ic(t){let e=function(t){const e=Xu(t);return 4===e.length?Fs.emptyPath():ec(e)}(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){hs(1===r,65062);const t=n.from[0];t.allDescendants?i=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function(t){const e=sc(t);return e instanceof ra&&sa(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map((t=>function(t){return new Zo(lc(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Xs(e)?null:e}(n.limit));let u=null;n.startAt&&(u=function(t){const e=!!t.before,n=t.values||[];return new Yo(n,e)}(n.startAt));let c=null;return n.endAt&&(c=function(t){const e=!t.before,n=t.values||[];return new Yo(n,e)}(n.endAt)),function(t,e,n,r,i,s,o,a){return new Ea(t,e,n,r,i,s,o,a)}(e,i,o,s,a,"F",u,c)}function sc(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=lc(t.unaryFilter.field);return na.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=lc(t.unaryFilter.field);return na.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=lc(t.unaryFilter.field);return na.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=lc(t.unaryFilter.field);return na.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return cs(61313);default:return cs(60726)}}(t):void 0!==t.fieldFilter?function(t){return na.create(lc(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return cs(58110);default:return cs(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return ra.create(t.compositeFilter.filters.map((t=>sc(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return cs(1026)}}(t.compositeFilter.op))}(t):cs(30097,{filter:t})}function oc(t){return Bu[t]}function ac(t){return qu[t]}function uc(t){return $u[t]}function cc(t){return{fieldPath:t.canonicalString()}}function lc(t){return js.fromServerFormat(t.fieldPath)}function hc(t){return t instanceof na?function(t){if("=="===t.op){if(Ho(t.value))return{unaryFilter:{field:cc(t.field),op:"IS_NAN"}};if(zo(t.value))return{unaryFilter:{field:cc(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ho(t.value))return{unaryFilter:{field:cc(t.field),op:"IS_NOT_NAN"}};if(zo(t.value))return{unaryFilter:{field:cc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cc(t.field),op:ac(t.op),value:t.value}}}(t):t instanceof ra?function(t){const e=t.getFilters().map((t=>hc(t)));return 1===e.length?e[0]:{compositeFilter:{op:uc(t.op),filters:e}}}(t):cs(54877,{filter:t})}function fc(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class dc{constructor(t,e,n,r,i=Ls.min(),s=Ls.min(),o=ho.EMPTY_BYTE_STRING,a=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(t){return new dc(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new dc(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new dc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new dc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class pc{constructor(t){this.wt=t}}function gc(t){const e=ic({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Na(e,e.limit,"L"):e}class mc{constructor(){this.Cn=new yc}addToCollectionParentIndex(t,e){return this.Cn.add(e),Qs.resolve()}getCollectionParents(t,e){return Qs.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return Qs.resolve()}deleteFieldIndex(t,e){return Qs.resolve()}deleteAllFieldIndexes(t){return Qs.resolve()}createTargetIndexes(t,e){return Qs.resolve()}getDocumentsMatchingTarget(t,e){return Qs.resolve(null)}getIndexType(t,e){return Qs.resolve(0)}getFieldIndexes(t,e){return Qs.resolve([])}getNextCollectionGroupToUpdate(t){return Qs.resolve(null)}getMinOffset(t,e){return Qs.resolve($s.min())}getMinOffsetFromCollectionGroup(t,e){return Qs.resolve($s.min())}updateCollectionGroup(t,e,n){return Qs.resolve()}updateIndexEntries(t,e){return Qs.resolve()}}class yc{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new ao(Fs.comparator),i=!r.has(n);return this.index[e]=r.add(n),i}has(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)}getEntries(t){return(this.index[t]||new ao(Fs.comparator)).toArray()}}const _c={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},vc=41943040;class wc{static withCacheSize(t){return new wc(t,wc.DEFAULT_COLLECTION_PERCENTILE,wc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}}wc.DEFAULT_COLLECTION_PERCENTILE=10,wc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wc.DEFAULT=new wc(vc,wc.DEFAULT_COLLECTION_PERCENTILE,wc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wc.DISABLED=new wc(-1,0,0);class bc{constructor(t){this.ur=t}next(){return this.ur+=2,this.ur}static cr(){return new bc(0)}static lr(){return new bc(-1)}}const Ec="LruGarbageCollector";function Tc([t,e],[n,r]){const i=As(t,n);return 0===i?As(e,r):i}class Cc{constructor(t){this.Er=t,this.buffer=new ao(Tc),this.dr=0}Ar(){return++this.dr}Rr(t){const e=[t,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(e);else{const t=this.buffer.last();Tc(e,t)<0&&(this.buffer=this.buffer.delete(t).add(e))}}get maxValue(){return this.buffer.last()[0]}}class Sc{constructor(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.Vr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return null!==this.Vr}mr(t){ss(Ec,`Garbage collection scheduled in ${t}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ws(t)?ss(Ec,"Ignoring IndexedDB error during garbage collection: ",t):await Ks(t)}await this.mr(3e5)}))}}class Ic{constructor(t,e){this.gr=t,this.params=e}calculateTargetCount(t,e){return this.gr.pr(t).next((t=>Math.floor(e/100*t)))}nthSequenceNumber(t,e){if(0===e)return Qs.resolve(Ys.le);const n=new Cc(e);return this.gr.forEachTarget(t,(t=>n.Rr(t.sequenceNumber))).next((()=>this.gr.yr(t,(t=>n.Rr(t))))).next((()=>n.maxValue))}removeTargets(t,e,n){return this.gr.removeTargets(t,e,n)}removeOrphanedDocuments(t,e){return this.gr.removeOrphanedDocuments(t,e)}collect(t,e){return-1===this.params.cacheSizeCollectionThreshold?(ss("LruGarbageCollector","Garbage collection skipped; disabled"),Qs.resolve(_c)):this.getCacheSize(t).next((n=>n<this.params.cacheSizeCollectionThreshold?(ss("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),_c):this.wr(t,e)))}getCacheSize(t){return this.gr.getCacheSize(t)}wr(t,e){let n,r,i,s,o,a,u;const c=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((e=>(e>this.params.maximumSequenceNumbersToCollect?(ss("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${e}`),r=this.params.maximumSequenceNumbersToCollect):r=e,s=Date.now(),this.nthSequenceNumber(t,r)))).next((r=>(n=r,o=Date.now(),this.removeTargets(t,n,e)))).next((e=>(i=e,a=Date.now(),this.removeOrphanedDocuments(t,n)))).next((t=>(u=Date.now(),is()<=Er.DEBUG&&ss("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-c}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(a-o)+"ms\n"+`\tRemoved ${t} documents in `+(u-a)+"ms\n"+`Total Duration: ${u-c}ms`),Qs.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t}))))}}class Ac{constructor(){this.changes=new Ma((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Wo.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Qs.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class Dc{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class Nc{constructor(t,e,n,r){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=r}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((r=>(n=r,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&du(n.mutation,t,co.empty(),Ps.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,Ga()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=Ga()){const r=qa();return this.populateOverlays(t,r,e).next((()=>this.computeViews(t,e,r,n).next((t=>{let e=ja();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=qa();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,Ga())))}populateOverlays(t,e,n){const r=[];return n.forEach((t=>{e.has(t)||r.push(t)})),this.documentOverlayCache.getOverlays(t,r).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,r){let i=Fa();const s=za(),o=za();return e.forEach(((t,e)=>{const o=n.get(e.key);r.has(e.key)&&(void 0===o||o.mutation instanceof mu)?i=i.insert(e.key,e):void 0!==o?(s.set(e.key,o.mutation.getFieldMask()),du(o.mutation,e,o.mutation.getFieldMask(),Ps.now())):s.set(e.key,co.empty())})),this.recalculateAndSaveOverlays(t,i).next((t=>(t.forEach(((t,e)=>s.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new Dc(e,null!==(n=s.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=za();let r=new io(((t,e)=>t-e)),i=Ga();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const i of t)i.keys().forEach((t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||co.empty();o=i.applyToLocalView(s,o),n.set(t,o);const a=(r.get(i.batchId)||Ga()).add(t);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,u=r.value,c=$a();u.forEach((t=>{if(!i.has(t)){const r=hu(e.get(t),n.get(t));null!==r&&c.set(t,r),i=i.add(t)}})),s.push(this.documentOverlayCache.saveOverlays(t,a,c))}return Qs.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n,r){return function(t){return Bs.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):Sa(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,r):this.getDocumentsMatchingCollectionQuery(t,e,n,r)}getNextDocuments(t,e,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,r-i.size):Qs.resolve(qa());let o=-1,a=i;return s.next((e=>Qs.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(e)?Qs.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,i))).next((()=>this.computeViews(t,a,e,Ga()))).next((t=>({batchId:o,changes:Ba(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Bs(e)).next((t=>{let e=ja();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,r){const i=e.collectionGroup;let s=ja();return this.indexManager.getCollectionParents(t,i).next((o=>Qs.forEach(o,(o=>{const a=function(t,e){return new Ea(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(i));return this.getDocumentsMatchingCollectionQuery(t,a,n,r).next((t=>{t.forEach(((t,e)=>{s=s.insert(t,e)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(t,e,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,i,r)))).next((t=>{i.forEach(((e,n)=>{const r=n.getKey();null===t.get(r)&&(t=t.insert(r,Wo.newInvalidDocument(r)))}));let n=ja();return t.forEach(((t,r)=>{const s=i.get(t);void 0!==s&&du(s.mutation,r,co.empty(),Ps.now()),Ra(e,r)&&(n=n.insert(t,r))})),n}))}}class kc{constructor(t){this.serializer=t,this.kr=new Map,this.qr=new Map}getBundleMetadata(t,e){return Qs.resolve(this.kr.get(e))}saveBundleMetadata(t,e){return this.kr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:Qu(t.createTime)}}(e)),Qs.resolve()}getNamedQuery(t,e){return Qs.resolve(this.qr.get(e))}saveNamedQuery(t,e){return this.qr.set(e.name,function(t){return{name:t.name,query:gc(t.bundledQuery),readTime:Qu(t.readTime)}}(e)),Qs.resolve()}}class xc{constructor(){this.overlays=new io(Bs.comparator),this.Qr=new Map}getOverlay(t,e){return Qs.resolve(this.overlays.get(e))}getOverlays(t,e){const n=qa();return Qs.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,r)=>{this.St(t,e,r)})),Qs.resolve()}removeOverlaysForBatchId(t,e,n){const r=this.Qr.get(n);return void 0!==r&&(r.forEach((t=>this.overlays=this.overlays.remove(t))),this.Qr.delete(n)),Qs.resolve()}getOverlaysForCollection(t,e,n){const r=qa(),i=e.length+1,s=new Bs(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===i&&t.largestBatchId>n&&r.set(t.getKey(),t)}return Qs.resolve(r)}getOverlaysForCollectionGroup(t,e,n,r){let i=new io(((t,e)=>t-e));const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=i.get(t.largestBatchId);null===e&&(e=qa(),i=i.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=qa(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=r)););return Qs.resolve(o)}St(t,e,n){const r=this.overlays.get(n.key);if(null!==r){const t=this.Qr.get(r.largestBatchId).delete(n.key);this.Qr.set(r.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new Eu(e,n));let i=this.Qr.get(e);void 0===i&&(i=Ga(),this.Qr.set(e,i)),this.Qr.set(e,i.add(n.key))}}class Oc{constructor(){this.sessionToken=ho.EMPTY_BYTE_STRING}getSessionToken(t){return Qs.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,Qs.resolve()}}class Rc{constructor(){this.$r=new ao(Pc.Ur),this.Kr=new ao(Pc.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(t,e){const n=new Pc(t,e);this.$r=this.$r.add(n),this.Kr=this.Kr.add(n)}Gr(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.zr(new Pc(t,e))}jr(t,e){t.forEach((t=>this.removeReference(t,e)))}Hr(t){const e=new Bs(new Fs([])),n=new Pc(e,t),r=new Pc(e,t+1),i=[];return this.Kr.forEachInRange([n,r],(t=>{this.zr(t),i.push(t.key)})),i}Jr(){this.$r.forEach((t=>this.zr(t)))}zr(t){this.$r=this.$r.delete(t),this.Kr=this.Kr.delete(t)}Yr(t){const e=new Bs(new Fs([])),n=new Pc(e,t),r=new Pc(e,t+1);let i=Ga();return this.Kr.forEachInRange([n,r],(t=>{i=i.add(t.key)})),i}containsKey(t){const e=new Pc(t,0),n=this.$r.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Pc{constructor(t,e){this.key=t,this.Zr=e}static Ur(t,e){return Bs.comparator(t.key,e.key)||As(t.Zr,e.Zr)}static Wr(t,e){return As(t.Zr,e.Zr)||Bs.comparator(t.key,e.key)}}class Lc{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.nr=1,this.Xr=new ao(Pc.Ur)}checkEmpty(t){return Qs.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,r){const i=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new bu(i,e,n,r);this.mutationQueue.push(s);for(const o of r)this.Xr=this.Xr.add(new Pc(o.key,i)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return Qs.resolve(s)}lookupMutationBatch(t,e){return Qs.resolve(this.ei(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,r=this.ti(n),i=r<0?0:r;return Qs.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Qs.resolve(0===this.mutationQueue.length?-1:this.nr-1)}getAllMutationBatches(t){return Qs.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Pc(e,0),r=new Pc(e,Number.POSITIVE_INFINITY),i=[];return this.Xr.forEachInRange([n,r],(t=>{const e=this.ei(t.Zr);i.push(e)})),Qs.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new ao(As);return e.forEach((t=>{const e=new Pc(t,0),r=new Pc(t,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([e,r],(t=>{n=n.add(t.Zr)}))})),Qs.resolve(this.ni(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,r=n.length+1;let i=n;Bs.isDocumentKey(i)||(i=i.child(""));const s=new Pc(new Bs(i),0);let o=new ao(As);return this.Xr.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(o=o.add(t.Zr)),!0)}),s),Qs.resolve(this.ni(o))}ni(t){const e=[];return t.forEach((t=>{const n=this.ei(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){hs(0===this.ri(e.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Xr;return Qs.forEach(e.mutations,(r=>{const i=new Pc(r.key,e.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)})).next((()=>{this.Xr=n}))}sr(t){}containsKey(t,e){const n=new Pc(e,0),r=this.Xr.firstAfterOrEqual(n);return Qs.resolve(e.isEqual(r&&r.key))}performConsistencyCheck(t){return this.mutationQueue.length,Qs.resolve()}ri(t,e){return this.ti(t)}ti(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ei(t){const e=this.ti(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Mc{constructor(t){this.ii=t,this.docs=new io(Bs.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,r=this.docs.get(n),i=r?r.size:0,s=this.ii(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Qs.resolve(n?n.document.mutableCopy():Wo.newInvalidDocument(e))}getEntries(t,e){let n=Fa();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Wo.newInvalidDocument(t))})),Qs.resolve(n)}getDocumentsMatchingQuery(t,e,n,r){let i=Fa();const s=e.path,o=new Bs(s.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!s.isPrefixOf(t.path))break;t.path.length>s.length+1||zs(qs(o),n)<=0||(r.has(o.key)||Ra(e,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Qs.resolve(i)}getAllFromCollectionGroup(t,e,n,r){cs(9500)}si(t,e){return Qs.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Vc(this)}getSize(t){return Qs.resolve(this.size)}}class Vc extends Ac{constructor(t){super(),this.Br=t}applyChanges(t){const e=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?e.push(this.Br.addEntry(t,r)):this.Br.removeEntry(n)})),Qs.waitFor(e)}getFromCache(t,e){return this.Br.getEntry(t,e)}getAllFromCache(t,e){return this.Br.getEntries(t,e)}}class Fc{constructor(t){this.persistence=t,this.oi=new Ma((t=>va(t)),wa),this.lastRemoteSnapshotVersion=Ls.min(),this.highestTargetId=0,this._i=0,this.ai=new Rc,this.targetCount=0,this.ui=bc.cr()}forEachTarget(t,e){return this.oi.forEach(((t,n)=>e(n))),Qs.resolve()}getLastRemoteSnapshotVersion(t){return Qs.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Qs.resolve(this._i)}allocateTargetId(t){return this.highestTargetId=this.ui.next(),Qs.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this._i&&(this._i=e),Qs.resolve()}Tr(t){this.oi.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ui=new bc(e),this.highestTargetId=e),t.sequenceNumber>this._i&&(this._i=t.sequenceNumber)}addTargetData(t,e){return this.Tr(e),this.targetCount+=1,Qs.resolve()}updateTargetData(t,e){return this.Tr(e),Qs.resolve()}removeTargetData(t,e){return this.oi.delete(e.target),this.ai.Hr(e.targetId),this.targetCount-=1,Qs.resolve()}removeTargets(t,e,n){let r=0;const i=[];return this.oi.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.oi.delete(s),i.push(this.removeMatchingKeysForTargetId(t,o.targetId)),r++)})),Qs.waitFor(i).next((()=>r))}getTargetCount(t){return Qs.resolve(this.targetCount)}getTargetData(t,e){const n=this.oi.get(e)||null;return Qs.resolve(n)}addMatchingKeys(t,e,n){return this.ai.Gr(e,n),Qs.resolve()}removeMatchingKeys(t,e,n){this.ai.jr(e,n);const r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((e=>{i.push(r.markPotentiallyOrphaned(t,e))})),Qs.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.ai.Hr(e),Qs.resolve()}getMatchingKeysForTargetId(t,e){const n=this.ai.Yr(e);return Qs.resolve(n)}containsKey(t,e){return Qs.resolve(this.ai.containsKey(e))}}class Uc{constructor(t,e){this.ci={},this.overlays={},this.li=new Ys(0),this.hi=!1,this.hi=!0,this.Pi=new Oc,this.referenceDelegate=t(this),this.Ti=new Fc(this),this.indexManager=new mc,this.remoteDocumentCache=function(t){return new Mc(t)}((t=>this.referenceDelegate.Ii(t))),this.serializer=new pc(e),this.Ei=new kc(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new xc,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.ci[t.toKey()];return n||(n=new Lc(e,this.referenceDelegate),this.ci[t.toKey()]=n),n}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(t,e,n){ss("MemoryPersistence","Starting transaction:",t);const r=new jc(this.li.next());return this.referenceDelegate.di(),n(r).next((t=>this.referenceDelegate.Ai(r).next((()=>t)))).toPromise().then((t=>(r.raiseOnCommittedEvent(),t)))}Ri(t,e){return Qs.or(Object.values(this.ci).map((n=>()=>n.containsKey(t,e))))}}class jc extends Gs{constructor(t){super(),this.currentSequenceNumber=t}}class Bc{constructor(t){this.persistence=t,this.Vi=new Rc,this.mi=null}static fi(t){return new Bc(t)}get gi(){if(this.mi)return this.mi;throw cs(60996)}addReference(t,e,n){return this.Vi.addReference(n,e),this.gi.delete(n.toString()),Qs.resolve()}removeReference(t,e,n){return this.Vi.removeReference(n,e),this.gi.add(n.toString()),Qs.resolve()}markPotentiallyOrphaned(t,e){return this.gi.add(e.toString()),Qs.resolve()}removeTarget(t,e){this.Vi.Hr(e.targetId).forEach((t=>this.gi.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.gi.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}di(){this.mi=new Set}Ai(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Qs.forEach(this.gi,(n=>{const r=Bs.fromPath(n);return this.pi(t,r).next((t=>{t||e.removeEntry(r,Ls.min())}))})).next((()=>(this.mi=null,e.apply(t))))}updateLimboDocument(t,e){return this.pi(t,e).next((t=>{t?this.gi.delete(e.toString()):this.gi.add(e.toString())}))}Ii(t){return 0}pi(t,e){return Qs.or([()=>Qs.resolve(this.Vi.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ri(t,e)])}}class qc{constructor(t,e){this.persistence=t,this.yi=new Ma((t=>function(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=to(e)),e=Zs(t.get(n),e);return to(e)}(t.path)),((t,e)=>t.isEqual(e))),this.garbageCollector=function(t,e){return new Ic(t,e)}(this,e)}static fi(t,e){return new qc(t,e)}di(){}Ai(t){return Qs.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}pr(t){const e=this.br(t);return this.persistence.getTargetCache().getTargetCount(t).next((t=>e.next((e=>t+e))))}br(t){let e=0;return this.yr(t,(t=>{e++})).next((()=>e))}yr(t,e){return Qs.forEach(this.yi,((n,r)=>this.Dr(t,n,r).next((t=>t?Qs.resolve():e(r)))))}removeTargets(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)}removeOrphanedDocuments(t,e){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.si(t,(r=>this.Dr(t,r,e).next((t=>{t||(n++,i.removeEntry(r,Ls.min()))})))).next((()=>i.apply(t))).next((()=>n))}markPotentiallyOrphaned(t,e){return this.yi.set(e,t.currentSequenceNumber),Qs.resolve()}removeTarget(t,e){const n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)}addReference(t,e,n){return this.yi.set(n,t.currentSequenceNumber),Qs.resolve()}removeReference(t,e,n){return this.yi.set(n,t.currentSequenceNumber),Qs.resolve()}updateLimboDocument(t,e){return this.yi.set(e,t.currentSequenceNumber),Qs.resolve()}Ii(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=jo(t.data.value)),e}Dr(t,e,n){return Qs.or([()=>this.persistence.Ri(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const t=this.yi.get(e);return Qs.resolve(void 0!==t&&t>n)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class $c{constructor(t,e,n,r){this.targetId=t,this.fromCache=e,this.ds=n,this.As=r}static Rs(t,e){let n=Ga(),r=Ga();for(const i of e.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new $c(t,e.fromCache,n,r)}}class zc{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class Hc{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=hr()?8:function(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")>0?6:4}initialize(t,e){this.ys=t,this.indexManager=e,this.Vs=!0}getDocumentsMatchingQuery(t,e,n,r){const i={result:null};return this.ws(t,e).next((t=>{i.result=t})).next((()=>{if(!i.result)return this.bs(t,e,r,n).next((t=>{i.result=t}))})).next((()=>{if(i.result)return;const n=new zc;return this.Ss(t,e,n).next((r=>{if(i.result=r,this.fs)return this.Ds(t,e,n,r.size)}))})).next((()=>i.result))}Ds(t,e,n,r){return n.documentReadCount<this.gs?(is()<=Er.DEBUG&&ss("QueryEngine","SDK will not create cache indexes for query:",Oa(e),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),Qs.resolve()):(is()<=Er.DEBUG&&ss("QueryEngine","Query:",Oa(e),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.ps*r?(is()<=Er.DEBUG&&ss("QueryEngine","The SDK decides to create cache indexes for query:",Oa(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Aa(e))):Qs.resolve())}ws(t,e){if(Ca(e))return Qs.resolve(null);let n=Aa(e);return this.indexManager.getIndexType(t,n).next((r=>0===r?null:(null!==e.limit&&1===r&&(e=Na(e,null,"F"),n=Aa(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((r=>{const i=Ga(...r);return this.ys.getDocuments(t,i).next((r=>this.indexManager.getMinOffset(t,n).next((n=>{const s=this.vs(e,r);return this.Cs(e,s,i,n.readTime)?this.ws(t,Na(e,null,"F")):this.Fs(t,s,e,n)}))))})))))}bs(t,e,n,r){return Ca(e)||r.isEqual(Ls.min())?Qs.resolve(null):this.ys.getDocuments(t,n).next((i=>{const s=this.vs(e,i);return this.Cs(e,s,n,r)?Qs.resolve(null):(is()<=Er.DEBUG&&ss("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Oa(e)),this.Fs(t,s,e,function(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ls.fromTimestamp(1e9===r?new Ps(n+1,0):new Ps(n,r));return new $s(i,Bs.empty(),e)}(r,-1)).next((t=>t)))}))}vs(t,e){let n=new ao(Pa(t));return e.forEach(((e,r)=>{Ra(t,r)&&(n=n.add(r))})),n}Cs(t,e,n,r){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(t,e,n){return is()<=Er.DEBUG&&ss("QueryEngine","Using full collection scan to execute query:",Oa(e)),this.ys.getDocumentsMatchingQuery(t,e,$s.min(),n)}Fs(t,e,n,r){return this.ys.getDocumentsMatchingQuery(t,n,r).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}const Gc="LocalStore",Kc=3e8;class Qc{constructor(t,e,n,r){this.persistence=t,this.Ms=e,this.serializer=r,this.xs=new io(As),this.Os=new Ma((t=>va(t)),wa),this.Ns=new Map,this.Bs=t.getRemoteDocumentCache(),this.Ti=t.getTargetCache(),this.Ei=t.getBundleCache(),this.Ls(n)}Ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Nc(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.xs)))}}async function Wc(t,e){const n=fs(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let r;return n.mutationQueue.getAllMutationBatches(t).next((i=>(r=i,n.Ls(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const i=[],s=[];let o=Ga();for(const t of r){i.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({ks:t,removedBatchIds:i,addedBatchIds:s})))}))}))}function Yc(t){const e=fs(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Ti.getLastRemoteSnapshotVersion(t)))}function Xc(t,e){const n=fs(t),r=e.snapshotVersion;let i=n.xs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const s=n.Bs.newChangeBuffer({trackRemovals:!0});i=n.xs;const o=[];e.targetChanges.forEach(((s,a)=>{const u=i.get(a);if(!u)return;o.push(n.Ti.removeMatchingKeys(t,s.removedDocuments,a).next((()=>n.Ti.addMatchingKeys(t,s.addedDocuments,a))));let c=u.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(a)?c=c.withResumeToken(ho.EMPTY_BYTE_STRING,Ls.min()).withLastLimboFreeSnapshotVersion(Ls.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),function(t,e,n){if(0===t.resumeToken.approximateByteSize())return!0;if(e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=Kc)return!0;return n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(u,c,s)&&o.push(n.Ti.updateTargetData(t,c))}));let a=Fa(),u=Ga();if(e.documentUpdates.forEach((r=>{e.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),o.push(function(t,e,n){let r=Ga(),i=Ga();return n.forEach((t=>r=r.add(t))),e.getEntries(t,r).next((t=>{let r=Fa();return n.forEach(((n,s)=>{const o=t.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(Ls.min())?(e.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(s),r=r.insert(n,s)):ss(Gc,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{qs:r,Qs:i}}))}(t,s,e.documentUpdates).next((t=>{a=t.qs,u=t.Qs}))),!r.isEqual(Ls.min())){const e=n.Ti.getLastRemoteSnapshotVersion(t).next((e=>n.Ti.setTargetsMetadata(t,t.currentSequenceNumber,r)));o.push(e)}return Qs.waitFor(o).next((()=>s.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,a,u))).next((()=>a))})).then((t=>(n.xs=i,t)))}async function Jc(t,e,n){const r=fs(t),i=r.xs.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(t=>r.persistence.referenceDelegate.removeTarget(t,i)))}catch(t){if(!Ws(t))throw t;ss(Gc,`Failed to update sequence numbers for target ${e}: ${t}`)}r.xs=r.xs.remove(e),r.Os.delete(i.target)}function Zc(t,e,n){const r=fs(t);let i=Ls.min(),s=Ga();return r.persistence.runTransaction("Execute query","readwrite",(t=>function(t,e,n){const r=fs(t),i=r.Os.get(n);return void 0!==i?Qs.resolve(r.xs.get(i)):r.Ti.getTargetData(e,n)}(r,t,Aa(e)).next((e=>{if(e)return i=e.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(t,e.targetId).next((t=>{s=t}))})).next((()=>r.Ms.getDocumentsMatchingQuery(t,e,n?i:Ls.min(),n?s:Ga()))).next((t=>(function(t,e,n){let r=t.Ns.get(e)||Ls.min();n.forEach(((t,e)=>{e.readTime.compareTo(r)>0&&(r=e.readTime)})),t.Ns.set(e,r)}(r,function(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),t),{documents:t,$s:s})))))}class tl{constructor(){this.activeTargetIds=Ka}js(t){this.activeTargetIds=this.activeTargetIds.add(t)}Hs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}zs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class el{constructor(){this.xo=new tl,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t,e=!0){return e&&this.xo.js(t),this.Oo[t]||"not-current"}updateQueryState(t,e,n){this.Oo[t]=e}removeLocalQueryTarget(t){this.xo.Hs(t)}isLocalQueryTarget(t){return this.xo.activeTargetIds.has(t)}clearQueryState(t){delete this.Oo[t]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(t){return this.xo.activeTargetIds.has(t)}start(){return this.xo=new tl,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class nl{No(t){}shutdown(){}}const rl="ConnectivityMonitor";class il{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(t){this.Qo.push(t)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){ss(rl,"Network connectivity changed: AVAILABLE");for(const t of this.Qo)t(0)}qo(){ss(rl,"Network connectivity changed: UNAVAILABLE");for(const t of this.Qo)t(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let sl=null;function ol(){return null===sl?sl=268435456+Math.round(2147483648*Math.random()):sl++,"0x"+sl.toString(16)}const al="RestConnection",ul={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class cl{get Uo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Ko=e+"://"+t.host,this.Wo=`projects/${n}/databases/${r}`,this.Go=this.databaseId.database===So?`project_id=${n}`:`project_id=${n}&database_id=${r}`}zo(t,e,n,r,i){const s=ol(),o=this.jo(t,e.toUriEncodedString());ss(al,`Sending RPC '${t}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(a,r,i);const{host:u}=new URL(o),c=ur(u);return this.Jo(t,o,a,n,c).then((e=>(ss(al,`Received RPC '${t}' ${s}: `,e),e)),(e=>{throw as(al,`RPC '${t}' ${s} failed with error: `,e,"url: ",o,"request:",n),e}))}Yo(t,e,n,r,i,s){return this.zo(t,e,n,r,i)}Ho(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+ns,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}jo(t,e){const n=ul[t];return`${this.Ko}/v1/${e}:${n}`}terminate(){}}class ll{constructor(t){this.Zo=t.Zo,this.Xo=t.Xo}e_(t){this.t_=t}n_(t){this.r_=t}i_(t){this.s_=t}onMessage(t){this.o_=t}close(){this.Xo()}send(t){this.Zo(t)}__(){this.t_()}a_(){this.r_()}u_(t){this.s_(t)}c_(t){this.o_(t)}}const hl="WebChannelConnection";class fl extends cl{constructor(t){super(t),this.l_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,n,r,i){const s=ol();return new Promise(((i,o)=>{const a=new zi;a.setWithCredentials(!0),a.listenOnce(Gi.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Ki.NO_ERROR:const e=a.getResponseJson();ss(hl,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(e)),i(e);break;case Ki.TIMEOUT:ss(hl,`RPC '${t}' ${s} timed out`),o(new ps(ds.DEADLINE_EXCEEDED,"Request time out"));break;case Ki.HTTP_ERROR:const n=a.getStatus();if(ss(hl,`RPC '${t}' ${s} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(ds).indexOf(e)>=0?e:ds.UNKNOWN}(e.status);o(new ps(t,e.message))}else o(new ps(ds.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new ps(ds.UNAVAILABLE,"Connection failed."));break;default:cs(9055,{h_:t,streamId:s,P_:a.getLastErrorCode(),T_:a.getLastError()})}}finally{ss(hl,`RPC '${t}' ${s} completed.`)}}));const u=JSON.stringify(r);ss(hl,`RPC '${t}' ${s} sending request:`,r),a.send(e,"POST",u,n,15)}))}I_(t,e,n){const r=ol(),i=[this.Ko,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=Xi(),o=Yi(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;void 0!==u&&(a.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Ho(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const c=i.join("");ss(hl,`Creating RPC '${t}' stream ${r}: ${c}`,a);const l=s.createWebChannel(c,a);this.E_(l);let h=!1,f=!1;const d=new ll({Zo:e=>{f?ss(hl,`Not sending because RPC '${t}' stream ${r} is closed:`,e):(h||(ss(hl,`Opening RPC '${t}' stream ${r} transport.`),l.open(),h=!0),ss(hl,`RPC '${t}' stream ${r} sending:`,e),l.send(e))},Xo:()=>l.close()}),p=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(l,Hi.EventType.OPEN,(()=>{f||(ss(hl,`RPC '${t}' stream ${r} transport opened.`),d.__())})),p(l,Hi.EventType.CLOSE,(()=>{f||(f=!0,ss(hl,`RPC '${t}' stream ${r} transport closed`),d.u_(),this.d_(l))})),p(l,Hi.EventType.ERROR,(e=>{f||(f=!0,as(hl,`RPC '${t}' stream ${r} transport errored. Name:`,e.name,"Message:",e.message),d.u_(new ps(ds.UNAVAILABLE,"The operation could not be completed")))})),p(l,Hi.EventType.MESSAGE,(e=>{var n;if(!f){const i=e.data[0];hs(!!i,16349);const s=i,o=(null==s?void 0:s.error)||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){ss(hl,`RPC '${t}' stream ${r} received error:`,o);const e=o.status;let n=function(t){const e=Cu[t];if(void 0!==e)return Iu(e)}(e),i=o.message;void 0===n&&(n=ds.INTERNAL,i="Unknown error status: "+e+" with message "+o.message),f=!0,d.u_(new ps(n,i)),l.close()}else ss(hl,`RPC '${t}' stream ${r} received:`,i),d.c_(i)}})),p(o,Wi.STAT_EVENT,(e=>{e.stat===Qi.PROXY?ss(hl,`RPC '${t}' stream ${r} detected buffering proxy`):e.stat===Qi.NOPROXY&&ss(hl,`RPC '${t}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{d.a_()}),0),d}terminate(){this.l_.forEach((t=>t.close())),this.l_=[]}E_(t){this.l_.push(t)}d_(t){this.l_=this.l_.filter((e=>e===t))}}function dl(){return"undefined"!=typeof document?document:null}function pl(t){return new zu(t,!0)}class gl{constructor(t,e,n=1e3,r=1.5,i=6e4){this.xi=t,this.timerId=e,this.A_=n,this.R_=r,this.V_=i,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(t){this.cancel();const e=Math.floor(this.m_+this.w_()),n=Math.max(0,Date.now()-this.g_),r=Math.max(0,e-n);r>0&&ss("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.m_} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,r,(()=>(this.g_=Date.now(),t()))),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){null!==this.f_&&(this.f_.skipDelay(),this.f_=null)}cancel(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}const ml="PersistentStream";class yl{constructor(t,e,n,r,i,s,o,a){this.xi=t,this.S_=n,this.D_=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new gl(t,e)}O_(){return 1===this.state||5===this.state||this.N_()}N_(){return 2===this.state||3===this.state}start(){this.M_=0,4!==this.state?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&null===this.C_&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,(()=>this.q_())))}Q_(t){this.U_(),this.stream.send(t)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(t,e){this.U_(),this.K_(),this.x_.cancel(),this.v_++,4!==t?this.x_.reset():e&&e.code===ds.RESOURCE_EXHAUSTED?(os(e.toString()),os("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):e&&e.code===ds.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.W_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.i_(e)}W_(){}auth(){this.state=1;const t=this.G_(this.v_),e=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.v_===e&&this.z_(t,n)}),(e=>{t((()=>{const t=new ps(ds.UNKNOWN,"Fetching auth token failed: "+e.message);return this.j_(t)}))}))}z_(t,e){const n=this.G_(this.v_);this.stream=this.H_(t,e),this.stream.e_((()=>{n((()=>this.listener.e_()))})),this.stream.n_((()=>{n((()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,(()=>(this.N_()&&(this.state=3),Promise.resolve()))),this.listener.n_())))})),this.stream.i_((t=>{n((()=>this.j_(t)))})),this.stream.onMessage((t=>{n((()=>1==++this.M_?this.J_(t):this.onNext(t)))}))}B_(){this.state=5,this.x_.y_((async()=>{this.state=0,this.start()}))}j_(t){return ss(ml,`close with error: ${t}`),this.stream=null,this.close(4,t)}G_(t){return e=>{this.xi.enqueueAndForget((()=>this.v_===t?e():(ss(ml,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class _l extends yl{constructor(t,e,n,r,i,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,r,s),this.serializer=i}H_(t,e){return this.connection.I_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.x_.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:cs(39313,{state:t})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(t,e){return t.useProto3Json?(hs(void 0===e||"string"==typeof e,58123),ho.fromBase64String(e||"")):(hs(void 0===e||e instanceof Buffer||e instanceof Uint8Array,16193),ho.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?ds.UNKNOWN:Iu(t.code);return new ps(e,t.message||"")}(o);n=new Mu(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ju(t,r.document.name),s=Qu(r.document.updateTime),o=r.document.createTime?Qu(r.document.createTime):Ls.min(),a=new Qo({mapValue:{fields:r.document.fields}}),u=Wo.newFoundDocument(i,s,o,a),c=r.targetIds||[],l=r.removedTargetIds||[];n=new Pu(c,l,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Ju(t,r.document),s=r.readTime?Qu(r.readTime):Ls.min(),o=Wo.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Pu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Ju(t,r.document),s=r.removedTargetIds||[];n=new Pu([],s,i,null)}else{if(!("filter"in e))return cs(11601,{Vt:e});{e.filter;const t=e.filter;t.targetId;const{count:r=0,unchangedNames:i}=t,s=new Tu(r,i),o=t.targetId;n=new Lu(o,s)}}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Ls.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?Ls.min():e.readTime?Qu(e.readTime):Ls.min()}(t);return this.listener.Y_(e,n)}Z_(t){const e={};e.database=tc(this.serializer),e.addTarget=function(t,e){let n;const r=e.target;if(n=ba(r)?{documents:nc(t,r)}:{query:rc(t,r).gt},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){n.resumeToken=Ku(t,e.resumeToken);const r=Hu(t,e.expectedCount);null!==r&&(n.expectedCount=r)}else if(e.snapshotVersion.compareTo(Ls.min())>0){n.readTime=Gu(t,e.snapshotVersion.toTimestamp());const r=Hu(t,e.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,t);const n=function(t,e){const n=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return cs(28987,{purpose:t})}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.Q_(e)}X_(t){const e={};e.database=tc(this.serializer),e.removeTarget=t,this.Q_(e)}}class vl{}class wl extends vl{constructor(t,e,n,r){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=r,this.sa=!1}oa(){if(this.sa)throw new ps(ds.FAILED_PRECONDITION,"The client has already been terminated.")}zo(t,e,n,r){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.zo(t,Yu(e,n),r,i,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===ds.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new ps(ds.UNKNOWN,t.toString())}))}Yo(t,e,n,r,i){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Yo(t,Yu(e,n),r,s,o,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===ds.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new ps(ds.UNKNOWN,t.toString())}))}terminate(){this.sa=!0,this.connection.terminate()}}class bl{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){0===this._a&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve()))))}Pa(t){"Online"===this.state?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.la("Offline")))}set(t){this.Ta(),this._a=0,"Online"===t&&(this.ua=!1),this.la(t)}la(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ha(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(os(e),this.ua=!1):ss("OnlineStateTracker",e)}Ta(){null!==this.aa&&(this.aa.cancel(),this.aa=null)}}const El="RemoteStore";class Tl{constructor(t,e,n,r,i){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=i,this.Ra.No((t=>{n.enqueueAndForget((async()=>{Ol(this)&&(ss(El,"Restarting streams for network reachability change."),await async function(t){const e=fs(t);e.da.add(4),await Sl(e),e.Va.set("Unknown"),e.da.delete(4),await Cl(e)}(this))}))})),this.Va=new bl(n,r)}}async function Cl(t){if(Ol(t))for(const e of t.Aa)await e(!0)}async function Sl(t){for(const e of t.Aa)await e(!1)}function Il(t,e){const n=fs(t);n.Ea.has(e.targetId)||(n.Ea.set(e.targetId,e),xl(n)?kl(n):jl(n).N_()&&Dl(n,e))}function Al(t,e){const n=fs(t),r=jl(n);n.Ea.delete(e),r.N_()&&Nl(n,e),0===n.Ea.size&&(r.N_()?r.k_():Ol(n)&&n.Va.set("Unknown"))}function Dl(t,e){if(t.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ls.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}jl(t).Z_(e)}function Nl(t,e){t.ma.Ke(e),jl(t).X_(e)}function kl(t){t.ma=new Fu({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t.Ea.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),jl(t).start(),t.Va.ca()}function xl(t){return Ol(t)&&!jl(t).O_()&&t.Ea.size>0}function Ol(t){return 0===fs(t).da.size}function Rl(t){t.ma=void 0}async function Pl(t){t.Va.set("Online")}async function Ll(t){t.Ea.forEach(((e,n)=>{Dl(t,e)}))}async function Ml(t,e){Rl(t),xl(t)?(t.Va.Pa(e),kl(t)):t.Va.set("Unknown")}async function Vl(t,e,n){if(t.Va.set("Online"),e instanceof Mu&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const r of e.targetIds)t.Ea.has(r)&&(await t.remoteSyncer.rejectListen(r,n),t.Ea.delete(r),t.ma.removeTarget(r))}(t,e)}catch(n){ss(El,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Fl(t,n)}else if(e instanceof Pu?t.ma.Xe(e):e instanceof Lu?t.ma.ot(e):t.ma.nt(e),!n.isEqual(Ls.min()))try{const e=await Yc(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.ma.It(e);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=t.Ea.get(r);i&&t.Ea.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach(((e,n)=>{const r=t.Ea.get(e);if(!r)return;t.Ea.set(e,r.withResumeToken(ho.EMPTY_BYTE_STRING,r.snapshotVersion)),Nl(t,e);const i=new dc(r.target,e,n,r.sequenceNumber);Dl(t,i)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){ss(El,"Failed to raise snapshot:",e),await Fl(t,e)}}async function Fl(t,e,n){if(!Ws(e))throw e;t.da.add(1),await Sl(t),t.Va.set("Offline"),n||(n=()=>Yc(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{ss(El,"Retrying IndexedDB access"),await n(),t.da.delete(1),await Cl(t)}))}async function Ul(t,e){const n=fs(t);n.asyncQueue.verifyOperationInProgress(),ss(El,"RemoteStore received new credentials");const r=Ol(n);n.da.add(3),await Sl(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.da.delete(3),await Cl(n)}function jl(t){return t.fa||(t.fa=function(t,e,n){const r=fs(t);return r.oa(),new _l(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(t.datastore,t.asyncQueue,{e_:Pl.bind(null,t),n_:Ll.bind(null,t),i_:Ml.bind(null,t),Y_:Vl.bind(null,t)}),t.Aa.push((async e=>{e?(t.fa.L_(),xl(t)?kl(t):t.Va.set("Unknown")):(await t.fa.stop(),Rl(t))}))),t.fa}class Bl{constructor(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new gs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,r,i){const s=Date.now()+n,o=new Bl(t,e,s,r,i);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ps(ds.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ql(t,e){if(os("AsyncQueue",`${e}: ${t}`),Ws(t))return new ps(ds.UNAVAILABLE,`${e}: ${t}`);throw t}class $l{static emptySet(t){return new $l(t.comparator)}constructor(t){this.comparator=t?(e,n)=>t(e,n)||Bs.comparator(e.key,n.key):(t,e)=>Bs.comparator(t.key,e.key),this.keyedMap=ja(),this.sortedSet=new io(this.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof $l))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,r=n.getNext().key;if(!t.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new $l;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class zl{constructor(){this.pa=new io(Bs.comparator)}track(t){const e=t.doc.key,n=this.pa.get(e);n?0!==t.type&&3===n.type?this.pa=this.pa.insert(e,t):3===t.type&&1!==n.type?this.pa=this.pa.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.pa=this.pa.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.pa=this.pa.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.pa=this.pa.remove(e):1===t.type&&2===n.type?this.pa=this.pa.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.pa=this.pa.insert(e,{type:2,doc:t.doc}):cs(63341,{Vt:t,ya:n}):this.pa=this.pa.insert(e,t)}wa(){const t=[];return this.pa.inorderTraversal(((e,n)=>{t.push(n)})),t}}class Hl{constructor(t,e,n,r,i,s,o,a,u){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=u}static fromInitialDocuments(t,e,n,r,i){const s=[];return e.forEach((t=>{s.push({type:0,doc:t})})),new Hl(t,e,$l.emptySet(e),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ka(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0}}class Gl{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some((t=>t.va()))}}class Kl{constructor(){this.queries=Ql(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(t,e){const n=fs(t),r=n.queries;n.queries=Ql(),r.forEach(((t,n)=>{for(const r of n.Sa)r.onError(e)}))}(this,new ps(ds.ABORTED,"Firestore shutting down"))}}function Ql(){return new Ma((t=>xa(t)),ka)}function Wl(t,e){const n=fs(t);let r=!1;for(const i of e){const t=i.query,e=n.queries.get(t);if(e){for(const t of e.Sa)t.Ma(i)&&(r=!0);e.ba=i}}r&&Xl(n)}function Yl(t,e,n){const r=fs(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function Xl(t){t.Ca.forEach((t=>{t.next()}))}var Jl,Zl;(Zl=Jl||(Jl={})).xa="default",Zl.Cache="cache";class th{constructor(t,e,n){this.query=t,this.Oa=e,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=n||{}}Ma(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new Hl(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Na?this.La(t)&&(this.Oa.next(t),e=!0):this.ka(t,this.onlineState)&&(this.qa(t),e=!0),this.Ba=t,e}onError(t){this.Oa.error(t)}Fa(t){this.onlineState=t;let e=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,t)&&(this.qa(this.Ba),e=!0),e}ka(t,e){if(!t.fromCache)return!0;if(!this.va())return!0;const n="Offline"!==e;return(!this.options.Qa||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}La(t){if(t.docChanges.length>0)return!0;const e=this.Ba&&this.Ba.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}qa(t){t=Hl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Na=!0,this.Oa.next(t)}va(){return this.options.source!==Jl.Cache}}class eh{constructor(t){this.key=t}}class nh{constructor(t){this.key=t}}class rh{constructor(t,e){this.query=t,this.Ha=e,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Ga(),this.mutatedKeys=Ga(),this.Za=Pa(t),this.Xa=new $l(this.Za)}get eu(){return this.Ha}tu(t,e){const n=e?e.nu:new zl,r=e?e.Xa:this.Xa;let i=e?e.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,u="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(t.inorderTraversal(((t,e)=>{const c=r.get(t),l=Ra(this.query,e)?e:null,h=!!c&&this.mutatedKeys.has(c.key),f=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let d=!1;c&&l?c.data.isEqual(l.data)?h!==f&&(n.track({type:3,doc:l}),d=!0):this.ru(c,l)||(n.track({type:2,doc:l}),d=!0,(a&&this.Za(l,a)>0||u&&this.Za(l,u)<0)&&(o=!0)):!c&&l?(n.track({type:0,doc:l}),d=!0):c&&!l&&(n.track({type:1,doc:c}),d=!0,(a||u)&&(o=!0)),d&&(l?(s=s.add(l),i=f?i.add(t):i.delete(t)):(s=s.delete(t),i=i.delete(t)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const t="F"===this.query.limitType?s.last():s.first();s=s.delete(t.key),i=i.delete(t.key),n.track({type:1,doc:t})}return{Xa:s,nu:n,Cs:o,mutatedKeys:i}}ru(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,r){const i=this.Xa;this.Xa=t.Xa,this.mutatedKeys=t.mutatedKeys;const s=t.nu.wa();s.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return cs(20277,{Vt:t})}};return n(t)-n(e)}(t.type,e.type)||this.Za(t.doc,e.doc))),this.iu(n),r=null!=r&&r;const o=e&&!r?this.su():[],a=0===this.Ya.size&&this.current&&!r?1:0,u=a!==this.Ja;return this.Ja=a,0!==s.length||u?{snapshot:new Hl(this.query,t.Xa,i,s,t.mutatedKeys,0===a,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),ou:o}:{ou:o}}Fa(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new zl,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(t){return!this.Ha.has(t)&&!!this.Xa.has(t)&&!this.Xa.get(t).hasLocalMutations}iu(t){t&&(t.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=t.current)}su(){if(!this.current)return[];const t=this.Ya;this.Ya=Ga(),this.Xa.forEach((t=>{this._u(t.key)&&(this.Ya=this.Ya.add(t.key))}));const e=[];return t.forEach((t=>{this.Ya.has(t)||e.push(new nh(t))})),this.Ya.forEach((n=>{t.has(n)||e.push(new eh(n))})),e}au(t){this.Ha=t.$s,this.Ya=Ga();const e=this.tu(t.documents);return this.applyChanges(e,!0)}uu(){return Hl.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,0===this.Ja,this.hasCachedResults)}}const ih="SyncEngine";class sh{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class oh{constructor(t){this.key=t,this.cu=!1}}class ah{constructor(t,e,n,r,i,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.lu={},this.hu=new Ma((t=>xa(t)),ka),this.Pu=new Map,this.Tu=new Set,this.Iu=new io(Bs.comparator),this.Eu=new Map,this.du=new Rc,this.Au={},this.Ru=new Map,this.Vu=bc.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return!0===this.mu}}async function uh(t,e,n=!0){const r=Ch(t);let i;const s=r.hu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.uu()):i=await lh(r,e,n,!0),i}async function ch(t,e){const n=Ch(t);await lh(n,e,!0,!1)}async function lh(t,e,n,r){const i=await function(t,e){const n=fs(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let r;return n.Ti.getTargetData(t,e).next((i=>i?(r=i,Qs.resolve(r)):n.Ti.allocateTargetId(t).next((i=>(r=new dc(e,i,"TargetPurposeListen",t.currentSequenceNumber),n.Ti.addTargetData(t,r).next((()=>r)))))))})).then((t=>{const r=n.xs.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.xs=n.xs.insert(t.targetId,t),n.Os.set(e,t.targetId)),t}))}(t.localStore,Aa(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await async function(t,e,n,r,i){t.fu=(e,n,r)=>async function(t,e,n,r){let i=e.view.tu(n);i.Cs&&(i=await Zc(t.localStore,e.query,!1).then((({documents:t})=>e.view.tu(t,i))));const s=r&&r.targetChanges.get(e.targetId),o=r&&null!=r.targetMismatches.get(e.targetId),a=e.view.applyChanges(i,t.isPrimaryClient,s,o);return _h(t,e.targetId,a.ou),a.snapshot}(t,e,n,r);const s=await Zc(t.localStore,e,!0),o=new rh(e,s.$s),a=o.tu(s.documents),u=Ru.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState,i),c=o.applyChanges(a,t.isPrimaryClient,u);_h(t,n,c.ou);const l=new sh(e,n,o);return t.hu.set(e,l),t.Pu.has(n)?t.Pu.get(n).push(e):t.Pu.set(n,[e]),c.snapshot}(t,e,s,"current"===o,i.resumeToken)),t.isPrimaryClient&&n&&Il(t.remoteStore,i),a}async function hh(t,e,n){const r=fs(t),i=r.hu.get(e),s=r.Pu.get(i.targetId);if(s.length>1)return r.Pu.set(i.targetId,s.filter((t=>!ka(t,e)))),void r.hu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Jc(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Al(r.remoteStore,i.targetId),mh(r,i.targetId)})).catch(Ks)):(mh(r,i.targetId),await Jc(r.localStore,i.targetId,!0))}async function fh(t,e){const n=fs(t),r=n.hu.get(e),i=n.Pu.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Al(n.remoteStore,r.targetId))}async function dh(t,e){const n=fs(t);try{const t=await Xc(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const r=n.Eu.get(e);r&&(hs(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1,22616),t.addedDocuments.size>0?r.cu=!0:t.modifiedDocuments.size>0?hs(r.cu,14607):t.removedDocuments.size>0&&(hs(r.cu,42227),r.cu=!1))})),await bh(n,t,e)}catch(t){await Ks(t)}}function ph(t,e,n){const r=fs(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const t=[];r.hu.forEach(((n,r)=>{const i=r.view.Fa(e);i.snapshot&&t.push(i.snapshot)})),function(t,e){const n=fs(t);n.onlineState=e;let r=!1;n.queries.forEach(((t,n)=>{for(const i of n.Sa)i.Fa(e)&&(r=!0)})),r&&Xl(n)}(r.eventManager,e),t.length&&r.lu.Y_(t),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function gh(t,e,n){const r=fs(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Eu.get(e),s=i&&i.key;if(s){let t=new io(Bs.comparator);t=t.insert(s,Wo.newNoDocument(s,Ls.min()));const n=Ga().add(s),i=new Ou(Ls.min(),new Map,new io(As),t,n);await dh(r,i),r.Iu=r.Iu.remove(s),r.Eu.delete(e),wh(r)}else await Jc(r.localStore,e,!1).then((()=>mh(r,e,n))).catch(Ks)}function mh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Pu.get(e))t.hu.delete(r),n&&t.lu.gu(r,n);t.Pu.delete(e),t.isPrimaryClient&&t.du.Hr(e).forEach((e=>{t.du.containsKey(e)||yh(t,e)}))}function yh(t,e){t.Tu.delete(e.path.canonicalString());const n=t.Iu.get(e);null!==n&&(Al(t.remoteStore,n),t.Iu=t.Iu.remove(e),t.Eu.delete(n),wh(t))}function _h(t,e,n){for(const r of n)r instanceof eh?(t.du.addReference(r.key,e),vh(t,r)):r instanceof nh?(ss(ih,"Document no longer in limbo: "+r.key),t.du.removeReference(r.key,e),t.du.containsKey(r.key)||yh(t,r.key)):cs(19791,{pu:r})}function vh(t,e){const n=e.key,r=n.path.canonicalString();t.Iu.get(n)||t.Tu.has(r)||(ss(ih,"New document in limbo: "+n),t.Tu.add(r),wh(t))}function wh(t){for(;t.Tu.size>0&&t.Iu.size<t.maxConcurrentLimboResolutions;){const e=t.Tu.values().next().value;t.Tu.delete(e);const n=new Bs(Fs.fromString(e)),r=t.Vu.next();t.Eu.set(r,new oh(n)),t.Iu=t.Iu.insert(n,r),Il(t.remoteStore,new dc(Aa(Ta(n.path)),r,"TargetPurposeLimboResolution",Ys.le))}}async function bh(t,e,n){const r=fs(t),i=[],s=[],o=[];r.hu.isEmpty()||(r.hu.forEach(((t,a)=>{o.push(r.fu(a,e,n).then((t=>{var e;if((t||n)&&r.isPrimaryClient){const i=t?!t.fromCache:null===(e=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===e?void 0:e.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(t){i.push(t);const e=$c.Rs(a.targetId,t);s.push(e)}})))})),await Promise.all(o),r.lu.Y_(i),await async function(t,e){const n=fs(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Qs.forEach(e,(e=>Qs.forEach(e.ds,(r=>n.persistence.referenceDelegate.addReference(t,e.targetId,r))).next((()=>Qs.forEach(e.As,(r=>n.persistence.referenceDelegate.removeReference(t,e.targetId,r)))))))))}catch(t){if(!Ws(t))throw t;ss(Gc,"Failed to update sequence numbers: "+t)}for(const r of e){const t=r.targetId;if(!r.fromCache){const e=n.xs.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.xs=n.xs.insert(t,i)}}}(r.localStore,s))}async function Eh(t,e){const n=fs(t);if(!n.currentUser.isEqual(e)){ss(ih,"User change. New user:",e.toKey());const t=await Wc(n.localStore,e);n.currentUser=e,function(t,e){t.Ru.forEach((t=>{t.forEach((t=>{t.reject(new ps(ds.CANCELLED,e))}))})),t.Ru.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await bh(n,t.ks)}}function Th(t,e){const n=fs(t),r=n.Eu.get(e);if(r&&r.cu)return Ga().add(r.key);{let t=Ga();const r=n.Pu.get(e);if(!r)return t;for(const e of r){const r=n.hu.get(e);t=t.unionWith(r.view.eu)}return t}}function Ch(t){const e=fs(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=dh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Th.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=gh.bind(null,e),e.lu.Y_=Wl.bind(null,e.eventManager),e.lu.gu=Yl.bind(null,e.eventManager),e}class Sh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=pl(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Su(t),await this.persistence.start(),this.localStore=this.Du(t),this.gcScheduler=this.vu(t,this.localStore),this.indexBackfillerScheduler=this.Cu(t,this.localStore)}vu(t,e){return null}Cu(t,e){return null}Du(t){return function(t,e,n,r){return new Qc(t,e,n,r)}(this.persistence,new Hc,t.initialUser,this.serializer)}Su(t){return new Uc(Bc.fi,this.serializer)}bu(t){return new el}async terminate(){var t,e;null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(e=this.indexBackfillerScheduler)||void 0===e||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Sh.provider={build:()=>new Sh};class Ih extends Sh{constructor(t){super(),this.cacheSizeBytes=t}vu(t,e){hs(this.persistence.referenceDelegate instanceof qc,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Sc(n,t.asyncQueue,e)}Su(t){const e=void 0!==this.cacheSizeBytes?wc.withCacheSize(this.cacheSizeBytes):wc.DEFAULT;return new Uc((t=>qc.fi(t,e)),this.serializer)}}class Ah{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>ph(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Eh.bind(null,this.syncEngine),await async function(t,e){const n=fs(t);e?(n.da.delete(2),await Cl(n)):e||(n.da.add(2),await Sl(n),n.Va.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Kl}createDatastore(t){const e=pl(t.databaseInfo.databaseId),n=function(t){return new fl(t)}(t.databaseInfo);return function(t,e,n,r){return new wl(t,e,n,r)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,r,i){return new Tl(t,e,n,r,i)}(this.localStore,this.datastore,t.asyncQueue,(t=>ph(this.syncEngine,t,0)),il.C()?new il:new nl)}createSyncEngine(t,e){return function(t,e,n,r,i,s,o){const a=new ah(t,e,n,r,i,s);return o&&(a.mu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t,e;await async function(t){const e=fs(t);ss(El,"RemoteStore shutting down."),e.da.add(5),await Sl(e),e.Ra.shutdown(),e.Va.set("Unknown")}(this.remoteStore),null===(t=this.datastore)||void 0===t||t.terminate(),null===(e=this.eventManager)||void 0===e||e.terminate()}}Ah.provider={build:()=>new Ah};class Dh{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Mu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Mu(this.observer.error,t):os("Uncaught Error in snapshot listener:",t.toString()))}xu(){this.muted=!0}Mu(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}const Nh="FirestoreClient";class kh{constructor(t,e,n,r,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=r,this.user=es.UNAUTHENTICATED,this.clientId=Is.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async t=>{ss(Nh,"Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(ss(Nh,"Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new gs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(Y){const n=ql(Y,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function xh(t,e){t.asyncQueue.verifyOperationInProgress(),ss(Nh,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener((async t=>{r.isEqual(t)||(await Wc(e.localStore,t),r=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function Oh(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ss(Nh,"Using user provided OfflineComponentProvider");try{await xh(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(t){return"FirebaseError"===t.name?t.code===ds.FAILED_PRECONDITION||t.code===ds.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r))throw r;as("Error using user provided cache. Falling back to memory cache: "+r),await xh(t,new Sh)}}else ss(Nh,"Using default OfflineComponentProvider"),await xh(t,new Ih(void 0));return t._offlineComponents}(t);ss(Nh,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((t=>Ul(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>Ul(e.remoteStore,n))),t._onlineComponents=e}async function Rh(t){const e=await async function(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ss(Nh,"Using user provided OnlineComponentProvider"),await Oh(t,t._uninitializedComponentsProvider._online)):(ss(Nh,"Using default OnlineComponentProvider"),await Oh(t,new Ah))),t._onlineComponents}(t),n=e.eventManager;return n.onListen=uh.bind(null,e.syncEngine),n.onUnlisten=hh.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=ch.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=fh.bind(null,e.syncEngine),n}function Ph(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const Lh=new Map;function Mh(t){if(Bs.isDocumentKey(t))throw new ps(ds.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Vh(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":cs(12329,{type:typeof t})}function Fh(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ps(ds.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Vh(t);throw new ps(ds.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}const Uh="firestore.googleapis.com",jh=!0;class Bh{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new ps(ds.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Uh,this.ssl=jh}else this.host=t.host,this.ssl=null!==(e=t.ssl)&&void 0!==e?e:jh;if(this.isUsingEmulator=void 0!==t.emulatorOptions,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=vc;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new ps(ds.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,r){if(!0===e&&!0===r)throw new ps(ds.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)})("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ph(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new ps(ds.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new ps(ds.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new ps(ds.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class qh{constructor(t,e,n,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Bh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ps(ds.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new ps(ds.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Bh(t),this._emulatorOptions=t.emulatorOptions||{},void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new ys;switch(t.type){case"firstParty":return new bs(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new ps(ds.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Lh.get(t);e&&(ss("ComponentProvider","Removing Datastore"),Lh.delete(t),e.terminate())}(this),Promise.resolve()}}class $h{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new $h(this.firestore,t,this._query)}}class zh{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Hh(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new zh(this.firestore,t,this._key)}}class Hh extends $h{constructor(t,e,n){super(t,e,Ta(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new zh(this.firestore,null,new Bs(t))}withConverter(t){return new Hh(this.firestore,t,this._path)}}const Gh="AsyncQueue";class Kh{constructor(t=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new gl(this,"async_queue_retry"),this.rc=()=>{const t=dl();t&&ss(Gh,"Visibility state changed to "+t.visibilityState),this.x_.b_()},this.sc=t;const e=dl();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.oc(),this._c(t)}enterRestrictedMode(t){if(!this.Yu){this.Yu=!0,this.tc=t||!1;const e=dl();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.rc)}}enqueue(t){if(this.oc(),this.Yu)return new Promise((()=>{}));const e=new gs;return this._c((()=>this.Yu&&this.tc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Ju.push(t),this.ac())))}async ac(){if(0!==this.Ju.length){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(rt){if(!Ws(rt))throw rt;ss(Gh,"Operation failed with retryable error: "+rt)}this.Ju.length>0&&this.x_.y_((()=>this.ac()))}}_c(t){const e=this.sc.then((()=>(this.ec=!0,t().catch((t=>{throw this.Xu=t,this.ec=!1,os("INTERNAL UNHANDLED ERROR: ",Qh(t)),t})).then((t=>(this.ec=!1,t))))));return this.sc=e,e}enqueueAfterDelay(t,e,n){this.oc(),this.nc.indexOf(t)>-1&&(e=0);const r=Bl.createAndSchedule(this,t,e,n,(t=>this.uc(t)));return this.Zu.push(r),r}oc(){this.Xu&&cs(47125,{cc:Qh(this.Xu)})}verifyOperationInProgress(){}async lc(){let t;do{t=this.sc,await t}while(t!==this.sc)}hc(t){for(const e of this.Zu)if(e.timerId===t)return!0;return!1}Pc(t){return this.lc().then((()=>{this.Zu.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.Zu)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.lc()}))}Tc(t){this.nc.push(t)}uc(t){const e=this.Zu.indexOf(t);this.Zu.splice(e,1)}}function Qh(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}function Wh(t){return function(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const r of e)if(r in n&&"function"==typeof n[r])return!0;return!1}(t,["next","error","complete"])}class Yh extends qh{constructor(t,e,n,r){super(t,e,n,r),this.type="firestore",this._queue=new Kh,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new Kh(t),this._firestoreClient=void 0,await t}}}class Xh{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Xh(ho.fromBase64String(t))}catch(t){throw new ps(ds.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Xh(ho.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Jh{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new ps(ds.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new js(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Zh{constructor(t){this._methodName=t}}class tf{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new ps(ds.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new ps(ds.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return As(this._lat,t._lat)||As(this._long,t._long)}}class ef{constructor(t){this._values=(t||[]).map((t=>t))}toArray(){return this._values.map((t=>t))}isEqual(t){return function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}(this._values,t._values)}}const nf=/^__.*__$/;function rf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw cs(40011,{Ic:t})}}class sf{constructor(t,e,n,r,i,s){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ec(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(t){return new sf(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.dc({path:n,Rc:!1});return r.Vc(t),r}mc(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.dc({path:n,Rc:!1});return r.Ec(),r}fc(t){return this.dc({path:void 0,Rc:!0})}gc(t){return lf(t,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}Ec(){if(this.path)for(let t=0;t<this.path.length;t++)this.Vc(this.path.get(t))}Vc(t){if(0===t.length)throw this.gc("Document fields must not be empty");if(rf(this.Ic)&&nf.test(t))throw this.gc('Document fields cannot begin and end with "__"')}}class of{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||pl(t)}bc(t,e,n,r=!1){return new sf({Ic:t,methodName:e,wc:n,path:js.emptyPath(),Rc:!1,yc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function af(t,e){if(uf(t=yr(t)))return function(t,e,n){if(!uf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const r=Vh(n);throw"an object"===r?e.gc(t+" a custom object"):e.gc(t+" "+r)}}("Unsupported field value:",e,t),function(t,e){const n={};return ro(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):no(t,((t,r)=>{const i=af(r,e.Ac(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}(t,e);if(t instanceof Zh)return function(t,e){if(!rf(e.Ic))throw e.gc(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.gc(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Rc&&4!==e.Ic)throw e.gc("Nested arrays are not supported");return function(t,e){const n=[];let r=0;for(const i of t){let t=af(i,e.fc(r));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=yr(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ya(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Ps.fromDate(t);return{timestampValue:Gu(e.serializer,n)}}if(t instanceof Ps){const n=new Ps(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Gu(e.serializer,n)}}if(t instanceof tf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Xh)return{bytesValue:Ku(e.serializer,t._byteString)};if(t instanceof zh){const n=e.databaseId,r=t.firestore._databaseId;if(!r.isEqual(n))throw e.gc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Wu(t.firestore._databaseId||e.databaseId,t._key.path)}}if(t instanceof ef)return function(t,e){return{mapValue:{fields:{[Ao]:{stringValue:ko},[xo]:{arrayValue:{values:t.toArray().map((t=>{if("number"!=typeof t)throw e.gc("VectorValues must only contain numeric values.");return Qa(e.serializer,t)}))}}}}}}(t,e);throw e.gc(`Unsupported field value: ${Vh(t)}`)}(t,e)}function uf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ps||t instanceof tf||t instanceof Xh||t instanceof zh||t instanceof Zh||t instanceof ef)}const cf=new RegExp("[~\\*/\\[\\]]");function lf(t,e,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new ps(ds.INVALID_ARGUMENT,a+t+u)}class hf{constructor(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new zh(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new ff(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(df("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class ff extends hf{data(){return super.data()}}function df(t,e){return"string"==typeof e?function(t,e,n){if(e.search(cf)>=0)throw lf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Jh(...e.split("."))._internalPath}catch(X){throw lf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}(t,e):e instanceof Jh?e._internalPath:e._delegate._internalPath}class pf{}class gf extends pf{}class mf extends gf{constructor(t,e,n){super(),this._field=t,this._op=e,this._value=n,this.type="where"}static _create(t,e,n){return new mf(t,e,n)}_apply(t){const e=this._parse(t);return Ef(t._query,e),new $h(t.firestore,t.converter,Da(t._query,e))}_parse(t){const e=function(t){const e=t._freezeSettings(),n=pl(t._databaseId);return new of(t._databaseId,!!e.ignoreUndefinedProperties,n)}(t.firestore),n=function(t,e,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new ps(ds.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){bf(o,s);const e=[];for(const n of o)e.push(wf(r,t,n));a={arrayValue:{values:e}}}else a=wf(r,t,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||bf(o,s),a=function(t,e,n,r=!1){return af(n,t.bc(r?4:3,e))}(n,e,o,"in"===s||"not-in"===s);return na.create(i,s,a)}(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value);return n}}class yf extends pf{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new yf(t,e)}_parse(t){const e=this._queryConstraints.map((e=>e._parse(t))).filter((t=>t.getFilters().length>0));return 1===e.length?e[0]:ra.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return 0===e.getFilters().length?t:(function(t,e){let n=t;const r=e.getFlattenedFilters();for(const i of r)Ef(n,i),n=Da(n,i)}(t._query,e),new $h(t.firestore,t.converter,Da(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class _f extends gf{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new _f(t,e)}_apply(t){const e=function(t,e,n){if(null!==t.startAt)throw new ps(ds.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new ps(ds.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Zo(e,n)}(t._query,this._field,this._direction);return new $h(t.firestore,t.converter,function(t,e){const n=t.explicitOrderBy.concat([e]);return new Ea(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))}}class vf extends gf{constructor(t,e,n){super(),this.type=t,this._limit=e,this._limitType=n}static _create(t,e,n){return new vf(t,e,n)}_apply(t){return new $h(t.firestore,t.converter,Na(t._query,this._limit,this._limitType))}}function wf(t,e,n){if("string"==typeof(n=yr(n))){if(""===n)throw new ps(ds.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Sa(e)&&-1!==n.indexOf("/"))throw new ps(ds.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Fs.fromString(n));if(!Bs.isDocumentKey(r))throw new ps(ds.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Bo(t,new Bs(r))}if(n instanceof zh)return Bo(t,n._key);throw new ps(ds.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vh(n)}.`)}function bf(t,e){if(!Array.isArray(t)||0===t.length)throw new ps(ds.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Ef(t,e){const n=function(t,e){for(const n of t)for(const t of n.getFlattenedFilters())if(e.indexOf(t.op)>=0)return t.op;return null}(t.filters,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw n===e.op?new ps(ds.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ps(ds.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Tf{convertValue(t,e="none"){switch(Oo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return go(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(mo(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw cs(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return no(t,((t,r)=>{n[t]=this.convertValue(r,e)})),n}convertVectorValue(t){var e,n,r;const i=null===(r=null===(n=null===(e=t.fields)||void 0===e?void 0:e[xo].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map((t=>go(t.doubleValue)));return new ef(i)}convertGeoPoint(t){return new tf(go(t.latitude),go(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=Eo(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(To(t));default:return null}}convertTimestamp(t){const e=po(t);return new Ps(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=Fs.fromString(t);hs(fc(n),9688,{name:t});const r=new Io(n.get(1),n.get(3)),i=new Bs(n.popFirst(5));return r.isEqual(e)||os(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),i}}class Cf{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Sf extends hf{constructor(t,e,n,r,i,s){super(t,e,n,r,s),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new If(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(df("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class If extends Sf{data(t={}){return super.data(t)}}class Af{constructor(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Cf(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new If(this._firestore,this._userDataWriter,n.key,n,new Cf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new ps(ds.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>{const r=new If(t._firestore,t._userDataWriter,n.doc.key,n.doc,new Cf(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:e++}}))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const r=new If(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Cf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let i=-1,s=-1;return 0!==e.type&&(i=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),s=n.indexOf(e.doc.key)),{type:Df(e.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Df(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return cs(61501,{type:t})}}class Nf extends Tf{constructor(t){super(),this.firestore=t}convertBytes(t){return new Xh(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new zh(this.firestore,null,e)}}!function(t,e=!0){!function(t){ns=t}("11.9.0"),Ii(new _r("firestore",((t,{instanceIdentifier:n,options:r})=>{const i=t.getProvider("app").getImmediate(),s=new Yh(new vs(t.getProvider("auth-internal")),new Ts(i,t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new ps(ds.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Io(t.options.projectId,e)}(i,n),i);return r=Object.assign({useFetchStreams:e},r),s._setSettings(r),s}),"PUBLIC").setMultipleInstances(!0)),ki(Zi,ts,t),ki(Zi,ts,"esm2017")}()}}}))}();
//# sourceMappingURL=vendor-legacy-CNkGb9c3.js.map
