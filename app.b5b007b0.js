parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"ZD7K":[function(require,module,exports) {
module.exports="/arrow-down.21ca6b65.png";
},{}],"qi1q":[function(require,module,exports) {
module.exports="/rain.6dc4bda6.png";
},{}],"n7hx":[function(require,module,exports) {
module.exports="/icon-standalone.2558c175.svg";
},{}],"A2T1":[function(require,module,exports) {
"use strict";var e=o(require("./assets/arrow-down.png")),t=o(require("./assets/rain.png")),i=o(require("./icons/icon-standalone.svg"));function o(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}var l=[103.8475,1.3011],s=1.156,c=1.475,d=103.565,u=104.13,p="#immersive"==location.hash;p&&(document.body.classList.add("immersive"),window["ga-disable-UA-23235796-10"]=!0),mapboxgl.accessToken="pk.eyJ1IjoiY2hlZWF1biIsImEiOiJjam9weHp6MTUwZThvM3FwM3pjd2J1ZGU5In0.gW0WGZAbconHv5JYwSFI6w",window.$map&&window.$map.remove();var m=window.$map=new mapboxgl.Map({container:"map",center:l,style:"mapbox://styles/mapbox/dark-v10?optimize=true",logoPosition:"top-right",minZoom:8,maxZoom:14,renderWorldCopies:!1,boxZoom:!1,attributionControl:!1,interactive:!p,maxTileCacheSize:p?0:null,fadeDuration:p?0:300,trackResize:!p,bounds:[d,s,u,c]});p||m.fitBounds([d,s,u,c],{animate:!1,padding:window.innerWidth>480&&window.innerHeight>480?120:0}),p||(m.addControl(new mapboxgl.AttributionControl({compact:!0}),"top-right"),m.addControl(new mapboxgl.NavigationControl,"top-right"),m.addControl(new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0})));var y=function(){function e(){n(this,e)}return r(e,[{key:"onAdd",value:function(e){this._map=e;var t=document.createElement("div");return t.className="mapboxgl-ctrl mapboxgl-ctrl-group",t.innerHTML='<button class="mapboxgl-ctrl-icon mapboxgl-ctrl-custom-pitch" type="button"><span>3D</span></button>',t.onclick=function(){var t=e.getPitch(),i=0;t<30?i=30:t<45?i=45:t<60&&(i=60),e.easeTo({pitch:i})},e.on("pitchend",this.onPitch.bind(this)),this._container=t,this._container}},{key:"onPitch",value:function(){var e=this._map.getPitch();this._container.classList.toggle("active",!!e),this._container.getElementsByTagName("span")[0].style.transform="rotate3d(1,0,0,"+e+"deg)"}},{key:"onRemove",value:function(){this._container.parentNode.removeChild(this._container),this._map.off("pitchend",this.onPitch.bind(this)),this._map=void 0}}]),e}();m.addControl(new y,"top-right");var f=!1,h=function(){function e(){n(this,e)}return r(e,[{key:"onAdd",value:function(e){this._map=e;var t=document.createElement("div");return t.className="mapboxgl-ctrl mapboxgl-ctrl-group",t.innerHTML='<button class="mapboxgl-ctrl-icon mapboxgl-ctrl-custom-clouds-mode" type="button">\n      <svg viewBox="0 0 640 512">\n        <path d="M537.585 226.56C541.725 215.836 544 204.184 544 192c0-53.019-42.981-96-96-96-19.729 0-38.065 5.954-53.316 16.159C367.042 64.248 315.288 32 256 32c-88.366 0-160 71.634-160 160 0 2.728.07 5.439.204 8.133C40.171 219.845 0 273.227 0 336c0 79.529 64.471 144 144 144h368c70.692 0 128-57.308 128-128 0-61.93-43.983-113.586-102.415-125.44z"/>\n      </svg>\n    </button>',t.onclick=function(){if(f=!f,t.classList.toggle("active",f),document.body.classList.toggle("cloud-mode",f),f)e.setLayoutProperty("rain3d","visibility","none"),e.setLayoutProperty("rainlay","visibility","none"),e.setLayoutProperty("rainclouds","visibility","visible"),e.setLayoutProperty("raindrops","visibility","visible"),e.setLayoutProperty("raincloudshadows","visibility","visible"),e.easeTo({pitch:60});else{var i=e.getPitch();e.setLayoutProperty("rain3d","visibility",i>0?"visible":"none"),e.setLayoutProperty("rainlay","visibility",i>0?"none":"visible"),e.setLayoutProperty("rainclouds","visibility","none"),e.setLayoutProperty("raindrops","visibility","none"),e.setLayoutProperty("raincloudshadows","visibility","none")}},this._container=t,this._container}},{key:"onRemove",value:function(){this._container.parentNode.removeChild(this._container),this._map=void 0}}]),e}();m.addControl(new h,"top-right");var v=document.getElementById("legend");m.on("movestart",function(){return v.classList.add("faded")}),m.on("moveend",function(){return v.classList.remove("faded")});var g="https://api.checkweather.sg",b={rain:g+"/now",id:g+"/now-id",observations:g+"/observations?compact=1"},w=document.getElementById("datetime"),x=document.getElementById("loader");m.on("dataloading",function(e){x.hidden=!1,w.hidden=!0});var L=null;m.on("data",function(e){clearTimeout(L),L=setTimeout(function(){x.hidden=!0,w.hidden=!1},500)});var P=new Promise(function(t,i){m.loadImage(e.default,function(e,o){e?i(e):t(o)})}),_=function(){fetch(b.id).then(function(e){return e.text()}).then(function(e){var t=(e.match(/\d{4}$/)||[""])[0].replace(/(\d{2})(\d{2})/,function(e,t,i){var o=parseInt(t,10),n=o>=12?"PM":"AM";return 0==o&&(o=12),o>12&&(o-=12),o+"<blink>:</blink>"+i+" "+n});w.innerHTML=t})},z=function(){m.getSource("rainsource").setData(b.rain),_()},M=function(){m.getSource("observations").setData(b.observations)},k=function e(t,i){setTimeout(requestAnimationFrame,i,function(){t(),e(t,i)})};m.once("styledata",function(){var e;m.addSource("rainsource",{type:"geojson",data:b.rain}),m.addSource("observations",{type:"geojson",data:b.observations}),requestAnimationFrame(_);for(var i=m.getStyle().layers,o=0;o<i.length;o++)if("symbol"===i[o].type&&i[o].layout["text-field"]){e=i[o].id;break}if(m.moveLayer("water",e),m.setPaintProperty("water","fill-opacity",.5),p?i.forEach(function(t){"symbol"===t.type&&t.layout["text-field"]&&t.id!==e&&m.removeLayer(t.id)}):(setTimeout(function(){m.getStyle().layers.forEach(function(e){if("symbol"===e.type&&e.layout["text-field"]&&/place\-city/i.test(e.id)){var t=m.getPaintProperty(e.id,"text-opacity");(!t||t>.5)&&m.setPaintProperty(e.id,"text-opacity",.5)}})},2e3),v.hidden=!1),m.addLayer({id:"rainlay",type:"fill",source:"rainsource",tolerance:1,buffer:0,paint:{"fill-color":["get","color"],"fill-antialias":!1,"fill-opacity":["interpolate",["linear"],["zoom"],8,["max",.5,["*",["/",["get","intensity"],100],1]],14,["max",.1,["*",["/",["get","intensity"],100],.5]]]}},"water"),p)m.addLayer({id:"rainclouds",source:"rainsource",tolerance:1,buffer:0,type:"fill",layout:{visibility:"none"}});else{m.addLayer({id:"rain3d",type:"fill-extrusion",source:"rainsource",tolerance:1,buffer:0,layout:{visibility:"none"},paint:{"fill-extrusion-color":["get","color"],"fill-extrusion-opacity":["interpolate",["linear"],["zoom"],8,.7,14,.1],"fill-extrusion-height":["*",50,["get","intensity"]]}},"water"),m.addLayer({id:"rainclouds",type:"fill-extrusion",source:"rainsource",tolerance:1,buffer:0,layout:{visibility:"none"},paint:{"fill-extrusion-color":"#fff","fill-extrusion-opacity":.8,"fill-extrusion-height":["+",5200,["*",5,["get","intensity"]]],"fill-extrusion-base":5e3}}),m.loadImage(t.default,function(e,t){m.addImage("rain",t),m.addLayer({id:"raindrops",type:"fill-extrusion",source:"rainsource",tolerance:1,buffer:0,layout:{visibility:"none"},paint:{"fill-extrusion-pattern":"rain","fill-extrusion-height":5e3,"fill-extrusion-opacity":["interpolate",["linear"],["zoom"],12,.2,14,.03]}},"rainclouds"),m.addLayer({id:"raincloudshadows",type:"fill",source:"rainsource",tolerance:1,buffer:0,layout:{visibility:"none"},paint:{"fill-antialias":!1,"fill-opacity":["interpolate",["linear"],["zoom"],8,.5,14,["*",["/",["get","intensity"],100],.5]]}},"raindrops")});var n=-1;m.on("pitchend",function(){var e=m.getPitch();e!==n&&(n=e,f||(m.setLayoutProperty("rain3d","visibility",e>0?"visible":"none"),m.setLayoutProperty("rainlay","visibility",e>0?"none":"visible")))})}m.addLayer({id:"tempreadings",type:"symbol",source:"observations",tolerance:1,buffer:0,filter:["all",["has","temp_celcius"],[">","temp_celcius",0]],layout:{"text-field":"{temp_celcius}Â°","text-allow-overlap":!0,"text-ignore-placement":!0,"text-size":["interpolate",["linear"],["zoom"],8,["zoom"],14,["*",2,["zoom"]]],"text-padding":1},paint:{"text-color":"yellow","text-halo-color":"#000","text-halo-width":1.5}},"rainclouds"),P.then(function(e){m.addImage("arrow",e,{sdf:!0}),m.addLayer({id:"windirections",type:"symbol",source:"observations",tolerance:1,buffer:0,filter:["has","wind_direction"],layout:{"icon-image":"arrow","icon-rotate":["get","wind_direction"],"icon-allow-overlap":!0,"icon-ignore-placement":!0,"icon-pitch-alignment":"map","icon-rotation-alignment":"map","icon-size":["interpolate",["linear"],["zoom"],8,.3,14,4]},paint:{"icon-color":"#fff","icon-opacity":.3}},"tempreadings")}),requestAnimationFrame(function(){m.addLayer({id:"humidreadings",type:"symbol",source:"observations",minzoom:10,tolerance:1,buffer:0,filter:["all",["has","relative_humidity"],[">","relative_humidity",0]],layout:{"text-field":"{relative_humidity}%","text-ignore-placement":!0,"text-size":["interpolate",["linear"],["zoom"],8,["zoom"],14,["*",1.1,["zoom"]]],"text-offset":[0,-1.1],"text-padding":0},paint:{"text-color":"orange","text-halo-color":"#000","text-halo-width":1.5}},"rainclouds"),m.addLayer({id:"rainreadings",type:"symbol",source:"observations",minzoom:11,tolerance:1,buffer:0,filter:["all",["has","rain_mm"],[">","rain_mm",0]],layout:{"text-field":"{rain_mm}","text-size":["interpolate",["linear"],["zoom"],8,["zoom"],14,["*",1.1,["zoom"]]],"text-ignore-placement":!0,"text-offset":[0,1.1],"text-padding":0},paint:{"text-color":"aqua","text-halo-color":"#000","text-halo-width":1.5}},"rainclouds")}),k(z,6e4),k(M,12e4),m.addLayer({id:"bbox",type:"fill",tolerance:1,buffer:0,source:{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[-180,90],[180,90],[180,-90],[-180,-90],[-180,90]],[[d,c],[u,c],[u,s],[d,s],[d,c]]]}}},paint:{"fill-color":"rgba(0,0,0,.5)","fill-antialias":!1}},e)});var I=Math.PI/180;function C(e,t,i){var o=t?t*I:0,n=i?i*I:0,a=e?e*I:0,r=(Math.cos(o),Math.cos(n)),l=Math.cos(a),s=Math.sin(o),c=Math.sin(n),d=Math.sin(a),u=-l*c-d*s*r,p=-d*c+l*s*r,m=Math.atan(u/p);return p<0?m+=Math.PI:u<0&&(m+=2*Math.PI),m*(180/Math.PI)}var T=document.getElementById("wind-compass");if(window.DeviceOrientationEvent){var E="ondeviceorientationabsolute"in window?"deviceorientationabsolute":"deviceorientation";window.addEventListener(E,function(e){if(e&&null!==e.alpha){var t=e.compassHeading||e.webkitCompassHeading||C(e.alpha,e.beta,e.gamma);T.classList.add("compassing"),T.style.transform="rotate(".concat(t-180,"deg)")}},!1)}"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js")});var A=navigator.vendor&&-1!==navigator.vendor.indexOf("Apple");A&&setTimeout(function(){var e=window.devicePixelRatio,t=document.createElement("canvas"),o=t.width=window.screen.width*e,n=t.height=window.screen.height*e,a=t.getContext("2d");a.fillStyle="#343332",a.fillRect(0,0,o,n);var r=new Image;r.onload=function(){var e=r.width/r.height;r.width=o/2,r.height=o/2/e,a.drawImage(r,(o-r.width)/2,(n-r.height)/2,r.width,r.height),document.head.insertAdjacentHTML("beforeend",'<link rel="apple-touch-startup-image" href="'.concat(t.toDataURL(),'">'))},r.src=i.default},5e3);
},{"./assets/arrow-down.png":"ZD7K","./assets/rain.png":"qi1q","./icons/icon-standalone.svg":"n7hx","./sw.js":[["sw.js","NqYy"],"sw.js.map","NqYy"]}]},{},["A2T1"], null)
//# sourceMappingURL=/app.b5b007b0.js.map