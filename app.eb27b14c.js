parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"u8ui":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.render=L,exports.hydrate=M,exports.h=exports.createElement=a,exports.Fragment=v,exports.createRef=h,exports.Component=y,exports.cloneElement=F,exports.createContext=R,exports.toChildArray=C,exports._unmount=T,exports.options=exports.isValidElement=void 0;var e,t,n,o,l,r,_,i,u={},s=[],c=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function p(e,t){for(var n in t)e[n]=t[n];return e}function f(e){var t=e.parentNode;t&&t.removeChild(e)}function a(e,t,n){var o,l=arguments,r={};for(o in t)"key"!==o&&"ref"!==o&&(r[o]=t[o]);if(arguments.length>3)for(n=[n],o=3;o<arguments.length;o++)n.push(l[o]);if(null!=n&&(r.children=n),"function"==typeof e&&null!=e.defaultProps)for(o in e.defaultProps)void 0===r[o]&&(r[o]=e.defaultProps[o]);return d(e,r,t&&t.key,t&&t.ref,null)}function d(t,n,o,l,r){var _={type:t,props:n,key:o,ref:l,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:r};return null==r&&(_.__v=_),e.vnode&&e.vnode(_),_}function h(){return{}}function v(e){return e.children}function y(e,t){this.props=e,this.context=t}function m(e,t){if(null==t)return e.__?m(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?m(e):null}function g(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return g(e)}}function k(t){(!t.__d&&(t.__d=!0)&&n.push(t)&&!o++||r!==e.debounceRendering)&&((r=e.debounceRendering)||l)(x)}function x(){for(var e;o=n.length;)e=n.sort(function(e,t){return e.__v.__b-t.__v.__b}),n=[],e.some(function(e){var t,n,o,l,r,_,i;e.__d&&(_=(r=(t=e).__v).__e,(i=t.__P)&&(n=[],(o=p({},r)).__v=o,l=N(i,r,o,t.__n,void 0!==i.ownerSVGElement,null,n,null==_?m(r):_),U(n,r),l!=_&&g(r)))})}function b(e,t,n,o,l,r,_,i,c,p){var a,h,y,g,k,x,b,C,w,S=o&&o.__k||s,P=S.length;for(c==u&&(c=null!=_?_[0]:P?m(o,0):null),n.__k=[],a=0;a<t.length;a++)if(null!=(g=n.__k[a]=null==(g=t[a])||"boolean"==typeof g?null:"string"==typeof g||"number"==typeof g?d(null,g,null,null,g):Array.isArray(g)?d(v,{children:g},null,null,null):null!=g.__e||null!=g.__c?d(g.type,g.props,g.key,null,g.__v):g)){if(g.__=n,g.__b=n.__b+1,null===(y=S[a])||y&&g.key==y.key&&g.type===y.type)S[a]=void 0;else for(h=0;h<P;h++){if((y=S[h])&&g.key==y.key&&g.type===y.type){S[h]=void 0;break}y=null}if(k=N(e,g,y=y||u,l,r,_,i,c,p),(h=g.ref)&&y.ref!=h&&(C||(C=[]),y.ref&&C.push(y.ref,null,g),C.push(h,g.__c||k,g)),null!=k){if(null==b&&(b=k),w=void 0,void 0!==g.__d)w=g.__d,g.__d=void 0;else if(_==y||k!=c||null==k.parentNode){e:if(null==c||c.parentNode!==e)e.appendChild(k),w=null;else{for(x=c,h=0;(x=x.nextSibling)&&h<P;h+=2)if(x==k)break e;e.insertBefore(k,c),w=c}"option"==n.type&&(e.value="")}c=void 0!==w?w:k.nextSibling,"function"==typeof n.type&&(n.__d=c)}else c&&y.__e==c&&c.parentNode!=e&&(c=m(y))}if(n.__e=b,null!=_&&"function"!=typeof n.type)for(a=_.length;a--;)null!=_[a]&&f(_[a]);for(a=P;a--;)null!=S[a]&&T(S[a],S[a]);if(C)for(a=0;a<C.length;a++)D(C[a],C[++a],C[++a])}function C(e){return null==e||"boolean"==typeof e?[]:Array.isArray(e)?s.concat.apply([],e.map(C)):[e]}function w(e,t,n,o,l){var r;for(r in n)"children"===r||"key"===r||r in t||P(e,r,null,n[r],o);for(r in t)l&&"function"!=typeof t[r]||"children"===r||"key"===r||"value"===r||"checked"===r||n[r]===t[r]||P(e,r,t[r],n[r],o)}function S(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]="number"==typeof n&&!1===c.test(t)?n+"px":null==n?"":n}function P(e,t,n,o,l){var r,_,i,u,s;if(l?"className"===t&&(t="class"):"class"===t&&(t="className"),"style"===t)if(r=e.style,"string"==typeof n)r.cssText=n;else{if("string"==typeof o&&(r.cssText="",o=null),o)for(u in o)n&&u in n||S(r,u,"");if(n)for(s in n)o&&n[s]===o[s]||S(r,s,n[s])}else"o"===t[0]&&"n"===t[1]?(_=t!==(t=t.replace(/Capture$/,"")),i=t.toLowerCase(),t=(i in e?i:t).slice(2),n?(o||e.addEventListener(t,E,_),(e.l||(e.l={}))[t]=n):e.removeEventListener(t,E,_)):"list"!==t&&"tagName"!==t&&"form"!==t&&"type"!==t&&"size"!==t&&!l&&t in e?e[t]=null==n?"":n:"function"!=typeof n&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/^xlink:?/,""))?null==n||!1===n?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),n):null==n||!1===n&&!/^ar/.test(t)?e.removeAttribute(t):e.setAttribute(t,n))}function E(t){this.l[t.type](e.event?e.event(t):t)}function N(t,n,o,l,r,_,i,u,s){var c,f,a,d,h,m,g,k,x,C,w,S=n.type;if(void 0!==n.constructor)return null;(c=e.__b)&&c(n);try{e:if("function"==typeof S){if(k=n.props,x=(c=S.contextType)&&l[c.__c],C=c?x?x.props.value:c.__:l,o.__c?g=(f=n.__c=o.__c).__=f.__E:("prototype"in S&&S.prototype.render?n.__c=f=new S(k,C):(n.__c=f=new y(k,C),f.constructor=S,f.render=W),x&&x.sub(f),f.props=k,f.state||(f.state={}),f.context=C,f.__n=l,a=f.__d=!0,f.__h=[]),null==f.__s&&(f.__s=f.state),null!=S.getDerivedStateFromProps&&(f.__s==f.state&&(f.__s=p({},f.__s)),p(f.__s,S.getDerivedStateFromProps(k,f.__s))),d=f.props,h=f.state,a)null==S.getDerivedStateFromProps&&null!=f.componentWillMount&&f.componentWillMount(),null!=f.componentDidMount&&f.__h.push(f.componentDidMount);else{if(null==S.getDerivedStateFromProps&&k!==d&&null!=f.componentWillReceiveProps&&f.componentWillReceiveProps(k,C),!f.__e&&null!=f.shouldComponentUpdate&&!1===f.shouldComponentUpdate(k,f.__s,C)||n.__v===o.__v){for(f.props=k,f.state=f.__s,n.__v!==o.__v&&(f.__d=!1),f.__v=n,n.__e=o.__e,n.__k=o.__k,f.__h.length&&i.push(f),c=0;c<n.__k.length;c++)n.__k[c]&&(n.__k[c].__=n);break e}null!=f.componentWillUpdate&&f.componentWillUpdate(k,f.__s,C),null!=f.componentDidUpdate&&f.__h.push(function(){f.componentDidUpdate(d,h,m)})}f.context=C,f.props=k,f.state=f.__s,(c=e.__r)&&c(n),f.__d=!1,f.__v=n,f.__P=t,c=f.render(f.props,f.state,f.context),null!=f.getChildContext&&(l=p(p({},l),f.getChildContext())),a||null==f.getSnapshotBeforeUpdate||(m=f.getSnapshotBeforeUpdate(d,h)),w=null!=c&&c.type==v&&null==c.key?c.props.children:c,b(t,Array.isArray(w)?w:[w],n,o,l,r,_,i,u,s),f.base=n.__e,f.__h.length&&i.push(f),g&&(f.__E=f.__=null),f.__e=!1}else null==_&&n.__v===o.__v?(n.__k=o.__k,n.__e=o.__e):n.__e=A(o.__e,n,o,l,r,_,i,s);(c=e.diffed)&&c(n)}catch(t){n.__v=null,e.__e(t,n,o)}return n.__e}function U(t,n){e.__c&&e.__c(n,t),t.some(function(n){try{t=n.__h,n.__h=[],t.some(function(e){e.call(n)})}catch(t){e.__e(t,n.__v)}})}function A(e,t,n,o,l,r,_,i){var c,p,f,a,d,h=n.props,v=t.props;if(l="svg"===t.type||l,null!=r)for(c=0;c<r.length;c++)if(null!=(p=r[c])&&((null===t.type?3===p.nodeType:p.localName===t.type)||e==p)){e=p,r[c]=null;break}if(null==e){if(null===t.type)return document.createTextNode(v);e=l?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,v.is&&{is:v.is}),r=null,i=!1}if(null===t.type)h!==v&&e.data!=v&&(e.data=v);else{if(null!=r&&(r=s.slice.call(e.childNodes)),f=(h=n.props||u).dangerouslySetInnerHTML,a=v.dangerouslySetInnerHTML,!i){if(null!=r)for(h={},d=0;d<e.attributes.length;d++)h[e.attributes[d].name]=e.attributes[d].value;(a||f)&&(a&&f&&a.__html==f.__html||(e.innerHTML=a&&a.__html||""))}w(e,v,h,l,i),a?t.__k=[]:(c=t.props.children,b(e,Array.isArray(c)?c:[c],t,n,o,"foreignObject"!==t.type&&l,r,_,u,i)),i||("value"in v&&void 0!==(c=v.value)&&c!==e.value&&P(e,"value",c,h.value,!1),"checked"in v&&void 0!==(c=v.checked)&&c!==e.checked&&P(e,"checked",c,h.checked,!1))}return e}function D(t,n,o){try{"function"==typeof t?t(n):t.current=n}catch(t){e.__e(t,o)}}function T(t,n,o){var l,r,_;if(e.unmount&&e.unmount(t),(l=t.ref)&&(l.current&&l.current!==t.__e||D(l,null,n)),o||"function"==typeof t.type||(o=null!=(r=t.__e)),t.__e=t.__d=void 0,null!=(l=t.__c)){if(l.componentWillUnmount)try{l.componentWillUnmount()}catch(t){e.__e(t,n)}l.base=l.__P=null}if(l=t.__k)for(_=0;_<l.length;_++)l[_]&&T(l[_],n,o);null!=r&&f(r)}function W(e,t,n){return this.constructor(e,n)}function L(t,n,o){var l,r,i;e.__&&e.__(t,n),r=(l=o===_)?null:o&&o.__k||n.__k,t=a(v,null,[t]),i=[],N(n,(l?n:o||n).__k=t,r||u,u,void 0!==n.ownerSVGElement,o&&!l?[o]:r?null:n.childNodes.length?s.slice.call(n.childNodes):null,i,o||u,l),U(i,t)}function M(e,t){L(e,t,_)}function F(e,t){var n,o;for(o in t=p(p({},e.props),t),arguments.length>2&&(t.children=s.slice.call(arguments,2)),n={},t)"key"!==o&&"ref"!==o&&(n[o]=t[o]);return d(e.type,n,t.key||e.key,t.ref||e.ref,null)}function R(e){var t={},n={__c:"__cC"+i++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var o,l=this;return this.getChildContext||(o=[],this.getChildContext=function(){return t[n.__c]=l,t},this.shouldComponentUpdate=function(e){l.props.value!==e.value&&o.some(function(t){t.context=e.value,k(t)})},this.sub=function(e){o.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){o.splice(o.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Consumer.contextType=n,n.Provider.__=n,n}exports.isValidElement=t,exports.options=e,exports.options=e={__e:function(e,t){for(var n,o;t=t.__;)if((n=t.__c)&&!n.__)try{if(n.constructor&&null!=n.constructor.getDerivedStateFromError&&(o=!0,n.setState(n.constructor.getDerivedStateFromError(e))),null!=n.componentDidCatch&&(o=!0,n.componentDidCatch(e)),o)return k(n.__E=n)}catch(t){e=t}throw e}},exports.isValidElement=t=function(e){return null!=e&&void 0===e.constructor},y.prototype.setState=function(e,t){var n;n=this.__s!==this.state?this.__s:this.__s=p({},this.state),"function"==typeof e&&(e=e(n,this.props)),e&&p(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),k(this))},y.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),k(this))},y.prototype.render=v,n=[],o=0,l="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,_=u,i=0;
},{}],"qsmZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.useState=a,exports.useReducer=p,exports.useEffect=h,exports.useLayoutEffect=m,exports.useRef=v,exports.useImperativeHandle=H,exports.useMemo=l,exports.useCallback=d,exports.useContext=x,exports.useDebugValue=y,exports.useErrorBoundary=E;var _,n,t,o=require("preact"),e=0,u=[],r=o.options.__r,i=o.options.diffed,c=o.options.__c,s=o.options.unmount;function f(_,t){o.options.__h&&o.options.__h(n,_,e||t),e=0;var u=n.__H||(n.__H={__:[],__h:[]});return _>=u.__.length&&u.__.push({}),u.__[_]}function a(_){return e=1,p(A,_)}function p(t,o,e){var u=f(_++,2);return u.t=t,u.__c||(u.__c=n,u.__=[e?e(o):A(void 0,o),function(_){var n=u.t(u.__[0],_);u.__[0]!==n&&(u.__[0]=n,u.__c.setState({}))}]),u.__}function h(t,e){var u=f(_++,3);!o.options.__s&&q(u.__H,e)&&(u.__=t,u.__H=e,n.__H.__h.push(u))}function m(t,e){var u=f(_++,4);!o.options.__s&&q(u.__H,e)&&(u.__=t,u.__H=e,n.__h.push(u))}function v(_){return e=5,l(function(){return{current:_}},[])}function H(_,n,t){e=6,m(function(){"function"==typeof _?_(n()):_&&(_.current=n())},null==t?t:t.concat(_))}function l(n,t){var o=f(_++,7);return q(o.__H,t)?(o.__H=t,o.__h=n,o.__=n()):o.__}function d(_,n){return e=8,l(function(){return _},n)}function x(t){var o=n.context[t.__c],e=f(_++,9);return e.__c=t,o?(null==e.__&&(e.__=!0,o.sub(n)),o.props.value):t.__}function y(_,n){o.options.useDebugValue&&o.options.useDebugValue(n?n(_):_)}function E(t){var o=f(_++,10),e=a();return o.__=t,n.componentDidCatch||(n.componentDidCatch=function(_){o.__&&o.__(_),e[1](_)}),[e[0],function(){e[1](void 0)}]}function b(){u.some(function(_){if(_.__P)try{_.__H.__h.forEach(g),_.__H.__h.forEach(D),_.__H.__h=[]}catch(n){return _.__H.__h=[],o.options.__e(n,_.__v),!0}}),u=[]}function g(_){"function"==typeof _.u&&_.u()}function D(_){_.u=_.__()}function q(_,n){return!_||n.some(function(n,t){return n!==_[t]})}function A(_,n){return"function"==typeof n?n(_):n}o.options.__r=function(t){r&&r(t),_=0;var o=(n=t.__c).__H;o&&(o.__h.forEach(g),o.__h.forEach(D),o.__h=[])},o.options.diffed=function(_){i&&i(_);var n=_.__c;n&&n.__H&&n.__H.__h.length&&(1!==u.push(n)&&t===o.options.requestAnimationFrame||((t=o.options.requestAnimationFrame)||function(_){var n,t=function(){clearTimeout(o),cancelAnimationFrame(n),setTimeout(_)},o=setTimeout(t,100);"undefined"!=typeof window&&(n=requestAnimationFrame(t))})(b))},o.options.__c=function(_,n){n.some(function(_){try{_.__h.forEach(g),_.__h=_.__h.filter(function(_){return!_.__||D(_)})}catch(t){n.some(function(_){_.__h&&(_.__h=[])}),n=[],o.options.__e(t,_.__v)}}),c&&c(_,n)},o.options.unmount=function(_){s&&s(_);var n=_.__c;if(n&&n.__H)try{n.__H.__.forEach(g)}catch(_){o.options.__e(_,n.__v)}};
},{"preact":"u8ui"}],"oSOp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={version:!0,Children:!0,render:!0,hydrate:!0,unmountComponentAtNode:!0,createPortal:!0,createFactory:!0,cloneElement:!0,isValidElement:!0,findDOMNode:!0,PureComponent:!0,memo:!0,forwardRef:!0,unstable_batchedUpdates:!0,StrictMode:!0,Suspense:!0,SuspenseList:!0,lazy:!0,createElement:!0,createContext:!0,createRef:!0,Fragment:!0,Component:!0};exports.render=k,exports.hydrate=P,exports.unmountComponentAtNode=F,exports.createPortal=x,exports.createFactory=A,exports.cloneElement=M,exports.isValidElement=U,exports.findDOMNode=j,exports.memo=i,exports.forwardRef=c,exports.Suspense=_,exports.SuspenseList=h,exports.lazy=v,Object.defineProperty(exports,"createElement",{enumerable:!0,get:function(){return n.createElement}}),Object.defineProperty(exports,"createContext",{enumerable:!0,get:function(){return n.createContext}}),Object.defineProperty(exports,"createRef",{enumerable:!0,get:function(){return n.createRef}}),Object.defineProperty(exports,"Fragment",{enumerable:!0,get:function(){return n.Fragment}}),Object.defineProperty(exports,"Component",{enumerable:!0,get:function(){return n.Component}}),exports.StrictMode=exports.unstable_batchedUpdates=exports.PureComponent=exports.Children=exports.version=exports.default=void 0;var t=require("preact/hooks");Object.keys(t).forEach(function(n){"default"!==n&&"__esModule"!==n&&(Object.prototype.hasOwnProperty.call(e,n)||Object.defineProperty(exports,n,{enumerable:!0,get:function(){return t[n]}}))});var n=require("preact");function r(e,t){for(var n in t)e[n]=t[n];return e}function o(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}var u=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).isPureReactComponent=!0,n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,r.prototype.shouldComponentUpdate=function(e,t){return o(this.props,e)||o(this.state,t)},r}(n.Component);function i(e,t){function r(e){var n=this.props.ref,r=n==e.ref;return!r&&n&&(n.call?n(null):n.current=null),t?!t(this.props,e)||!r:o(this.props,e)}function u(t){return this.shouldComponentUpdate=r,(0,n.createElement)(e,t)}return u.prototype.isReactComponent=!0,u.displayName="Memo("+(e.displayName||e.name)+")",u.t=!0,u}exports.PureComponent=u;var a=n.options.__b;n.options.__b=function(e){e.type&&e.type.t&&e.ref&&(e.props.ref=e.ref,e.ref=null),a&&a(e)};var l="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function c(e){function t(t,n){var o=r({},t);return delete o.ref,e(o,t.ref||n)}return t.$$typeof=l,t.render=t,t.prototype.isReactComponent=t.t=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var p=function(e,t){return e?(0,n.toChildArray)(e).reduce(function(e,n,r){return e.concat(t(n,r))},[]):null},s={map:p,forEach:p,count:function(e){return e?(0,n.toChildArray)(e).length:0},only:function(e){if(1!==(e=(0,n.toChildArray)(e)).length)throw new Error("Children.only() expects only one child.");return e[0]},toArray:n.toChildArray},f=n.options.__e;function d(e){return e&&((e=r({},e)).__c=null,e.__k=e.__k&&e.__k.map(d)),e}function _(){this.__u=0,this.o=null,this.__b=null}function m(e){var t=e.__.__c;return t&&t.u&&t.u(e)}function v(e){var t,r,o;function u(u){if(t||(t=e()).then(function(e){r=e.default||e},function(e){o=e}),o)throw o;if(!r)throw t;return(0,n.createElement)(r,u)}return u.displayName="Lazy",u.t=!0,u}function h(){this.i=null,this.l=null}exports.Children=s,n.options.__e=function(e,t,n){if(e.then)for(var r,o=t;o=o.__;)if((r=o.__c)&&r.__c)return r.__c(e,t.__c);f(e,t,n)},(_.prototype=new n.Component).__c=function(e,t){var n=this;null==n.o&&(n.o=[]),n.o.push(t);var r=m(n.__v),o=!1,u=function(){o||(o=!0,r?r(i):i())};t.__c=t.componentWillUnmount,t.componentWillUnmount=function(){u(),t.__c&&t.__c()};var i=function(){var e;if(!--n.__u)for(n.__v.__k[0]=n.state.u,n.setState({u:n.__b=null});e=n.o.pop();)e.forceUpdate()};n.__u++||n.setState({u:n.__b=n.__v.__k[0]}),e.then(u,u)},_.prototype.render=function(e,t){return this.__b&&(this.__v.__k[0]=d(this.__b),this.__b=null),[(0,n.createElement)(n.Component,null,t.u?null:e.children),t.u&&e.fallback]};var y=function(e,t,n){if(++n[1]===n[0]&&e.l.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.l.size))for(n=e.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.i=n=n[2]}};(h.prototype=new n.Component).u=function(e){var t=this,n=m(t.__v),r=t.l.get(e);return r[0]++,function(o){var u=function(){t.props.revealOrder?(r.push(o),y(t,e,r)):o()};n?n(u):u()}},h.prototype.render=function(e){this.i=null,this.l=new Map;var t=(0,n.toChildArray)(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var r=t.length;r--;)this.l.set(t[r],this.i=[1,0,this.i]);return e.children},h.prototype.componentDidUpdate=h.prototype.componentDidMount=function(){var e=this;e.l.forEach(function(t,n){y(e,n,t)})};var b=function(){function e(){}var t=e.prototype;return t.getChildContext=function(){return this.props.context},t.render=function(e){return e.children},e}();function C(e){var t=this,r=e.container,o=(0,n.createElement)(b,{context:t.context},e.vnode);return t.s&&t.s!==r&&(t.v.parentNode&&t.s.removeChild(t.v),(0,n._unmount)(t.h),t.p=!1),e.vnode?t.p?(r.__k=t.__k,(0,n.render)(o,r),t.__k=r.__k):(t.v=document.createTextNode(""),(0,n.hydrate)("",r),r.appendChild(t.v),t.p=!0,t.s=r,(0,n.render)(o,r,t.v),t.__k=t.v.__k):t.p&&(t.v.parentNode&&t.s.removeChild(t.v),(0,n._unmount)(t.h)),t.h=o,t.componentWillUnmount=function(){t.v.parentNode&&t.s.removeChild(t.v),(0,n._unmount)(t.h)},null}function x(e,t){return(0,n.createElement)(C,{vnode:e,container:t})}var g=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/;n.Component.prototype.isReactComponent={};var E="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;function k(e,t,r){if(null==t.__k)for(;t.firstChild;)t.removeChild(t.firstChild);return(0,n.render)(e,t),"function"==typeof r&&r(),e?e.__c:null}function P(e,t,r){return(0,n.hydrate)(e,t),"function"==typeof r&&r(),e?e.__c:null}var S=n.options.event;function N(e,t){e["UNSAFE_"+t]&&!e[t]&&Object.defineProperty(e,t,{configurable:!1,get:function(){return this["UNSAFE_"+t]},set:function(e){this["UNSAFE_"+t]=e}})}n.options.event=function(e){S&&(e=S(e)),e.persist=function(){};var t=!1,n=!1,r=e.stopPropagation;e.stopPropagation=function(){r.call(e),t=!0};var o=e.preventDefault;return e.preventDefault=function(){o.call(e),n=!0},e.isPropagationStopped=function(){return t},e.isDefaultPrevented=function(){return n},e.nativeEvent=e};var O={configurable:!0,get:function(){return this.class}},w=n.options.vnode;n.options.vnode=function(e){e.$$typeof=E;var t=e.type,r=e.props;if(t){if(r.class!=r.className&&(O.enumerable="className"in r,null!=r.className&&(r.class=r.className),Object.defineProperty(r,"className",O)),"function"!=typeof t){var o,u,i;for(i in r.defaultValue&&void 0!==r.value&&(r.value||0===r.value||(r.value=r.defaultValue),delete r.defaultValue),Array.isArray(r.value)&&r.multiple&&"select"===t&&((0,n.toChildArray)(r.children).forEach(function(e){-1!=r.value.indexOf(e.props.value)&&(e.props.selected=!0)}),delete r.value),r)if(o=g.test(i))break;if(o)for(i in u=e.props={},r)u[g.test(i)?i.replace(/[A-Z0-9]/,"-$&").toLowerCase():i]=r[i]}!function(t){var n=e.type,r=e.props;if(r&&"string"==typeof n){var o={};for(var u in r)/^on(Ani|Tra|Tou)/.test(u)&&(r[u.toLowerCase()]=r[u],delete r[u]),o[u.toLowerCase()]=u;if(o.ondoubleclick&&(r.ondblclick=r[o.ondoubleclick],delete r[o.ondoubleclick]),o.onbeforeinput&&(r.onbeforeinput=r[o.onbeforeinput],delete r[o.onbeforeinput]),o.onchange&&("textarea"===n||"input"===n.toLowerCase()&&!/^fil|che|ra/i.test(r.type))){var i=o.oninput||"oninput";r[i]||(r[i]=r[o.onchange],delete r[o.onchange])}}}(),"function"==typeof t&&!t.m&&t.prototype&&(N(t.prototype,"componentWillMount"),N(t.prototype,"componentWillReceiveProps"),N(t.prototype,"componentWillUpdate"),t.m=!0)}w&&w(e)};var R="16.8.0";function A(e){return n.createElement.bind(null,e)}function U(e){return!!e&&e.$$typeof===E}function M(e){return U(e)?n.cloneElement.apply(null,arguments):e}function F(e){return!!e.__k&&((0,n.render)(null,e),!0)}function j(e){return e&&(e.base||1===e.nodeType&&e)||null}exports.version=R;var L=function(e,t){return e(t)},D=n.Fragment;exports.StrictMode=D,exports.unstable_batchedUpdates=L;var V={useState:t.useState,useReducer:t.useReducer,useEffect:t.useEffect,useLayoutEffect:t.useLayoutEffect,useRef:t.useRef,useImperativeHandle:t.useImperativeHandle,useMemo:t.useMemo,useCallback:t.useCallback,useContext:t.useContext,useDebugValue:t.useDebugValue,version:"16.8.0",Children:s,render:k,hydrate:P,unmountComponentAtNode:F,createPortal:x,createElement:n.createElement,createContext:n.createContext,createFactory:A,cloneElement:M,createRef:n.createRef,Fragment:n.Fragment,isValidElement:U,findDOMNode:j,Component:n.Component,PureComponent:u,memo:i,forwardRef:c,unstable_batchedUpdates:L,StrictMode:n.Fragment,Suspense:_,SuspenseList:h,lazy:v};exports.default=V;
},{"preact/hooks":"qsmZ","preact":"u8ui"}],"Uf5o":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),r=function(r,t){var n=e.useRef(function(){});e.useEffect(function(){n.current=r}),e.useEffect(function(){if(null!==t){var e=setInterval(function(){return n.current()},t||0);return function(){return clearInterval(e)}}},[t])};exports.default=r;
},{"react":"oSOp"}],"sBU6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__extends=e,exports.__rest=n,exports.__decorate=o,exports.__param=a,exports.__metadata=i,exports.__awaiter=c,exports.__generator=u,exports.__exportStar=l,exports.__values=s,exports.__read=p,exports.__spread=y,exports.__spreadArrays=_,exports.__await=h,exports.__asyncGenerator=v,exports.__asyncDelegator=b,exports.__asyncValues=d,exports.__makeTemplateObject=w,exports.__importStar=m,exports.__importDefault=O,exports.__classPrivateFieldGet=g,exports.__classPrivateFieldSet=j,exports.__createBinding=exports.__assign=void 0;var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};function e(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return exports.__assign=r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function o(t,e,r,n){var o,a=arguments.length,i=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(i=(a<3?o(i):a>3?o(e,r,i):o(e,r))||i);return a>3&&i&&Object.defineProperty(e,r,i),i}function a(t,e){return function(r,n){e(r,n,t)}}function i(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function c(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{u(n.next(t))}catch(e){a(e)}}function c(t){try{u(n.throw(t))}catch(e){a(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(i,c)}u((n=n.apply(t,e||[])).next())})}function u(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(c){a=[6,c],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}exports.__assign=r;var f=Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]};function l(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||f(e,t,r)}function s(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function y(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function _(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var a=arguments[e],i=0,c=a.length;i<c;i++,o++)n[o]=a[i];return n}function h(t){return this instanceof h?(this.v=t,this):new h(t)}function v(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){a.push([t,e,r,n])>1||c(t,e)})})}function c(t,e){try{(r=o[t](e)).value instanceof h?Promise.resolve(r.value.v).then(u,f):l(a[0][2],r)}catch(n){l(a[0][3],n)}var r}function u(t){c("next",t)}function f(t){c("throw",t)}function l(t,e){t(e),a.shift(),a.length&&c(a[0][0],a[0][1])}}function b(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:h(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function d(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof s?s(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}}function w(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}exports.__createBinding=f;var x=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function m(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&f(e,t,r);return x(e,t),e}function O(t){return t&&t.__esModule?t:{default:t}}function g(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function j(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}
},{}],"kARq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=function(t){e.useEffect(t,[])};exports.default=t;
},{"react":"oSOp"}],"ILec":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),r=require("react"),t=e.__importDefault(require("./useEffectOnce")),u=function(e){var u=r.useRef(e);u.current=e,t.default(function(){return function(){return u.current()}})};exports.default=u;
},{"tslib":"sBU6","react":"oSOp","./useEffectOnce":"kARq"}],"hVOD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),r=require("react"),t=e.__importDefault(require("./useUnmount")),n=function(e){var n=r.useRef(0),u=r.useState(e),a=u[0],i=u[1],c=r.useCallback(function(e){cancelAnimationFrame(n.current),n.current=requestAnimationFrame(function(){i(e)})},[]);return t.default(function(){cancelAnimationFrame(n.current)}),[a,c]};exports.default=n;
},{"tslib":"sBU6","react":"oSOp","./useUnmount":"ILec"}],"A6FA":[function(require,module,exports) {
"use strict";function e(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"raOJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=t;var e=n(require("./ascending"));function n(e){return e&&e.__esModule?e:{default:e}}function t(e){return 1===e.length&&(e=r(e)),{left:function(n,t,r,u){for(null==r&&(r=0),null==u&&(u=n.length);r<u;){var l=r+u>>>1;e(n[l],t)<0?r=l+1:u=l}return r},right:function(n,t,r,u){for(null==r&&(r=0),null==u&&(u=n.length);r<u;){var l=r+u>>>1;e(n[l],t)>0?u=l:r=l+1}return r}}}function r(n){return function(t,r){return(0,e.default)(n(t),r)}}
},{"./ascending":"A6FA"}],"VXHZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.bisectLeft=exports.bisectRight=void 0;var e=r(require("./ascending")),t=r(require("./bisector"));function r(e){return e&&e.__esModule?e:{default:e}}var s=(0,t.default)(e.default),i=s.right;exports.bisectRight=i;var o=s.left;exports.bisectLeft=o;var u=i;exports.default=u;
},{"./ascending":"A6FA","./bisector":"raOJ"}],"aKlf":[function(require,module,exports) {
"use strict";function e(e,t){null==t&&(t=r);for(var n=0,u=e.length-1,o=e[0],l=new Array(u<0?0:u);n<u;)l[n]=t(o,o=e[++n]);return l}function r(e,r){return[e,r]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e,exports.pair=r;
},{}],"JGhM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=r;var e=require("./pairs");function r(r,t,n){var u,a,l,o,i=r.length,s=t.length,f=new Array(i*s);for(null==n&&(n=e.pair),u=l=0;u<i;++u)for(o=r[u],a=0;a<s;++a,++l)f[l]=n(o,t[a]);return f}
},{"./pairs":"aKlf"}],"wjXp":[function(require,module,exports) {
"use strict";function e(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"fzXe":[function(require,module,exports) {
"use strict";function e(e){return null===e?NaN:+e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"IBjk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=t;var e=r(require("./number"));function r(e){return e&&e.__esModule?e:{default:e}}function t(r,t){var u,f,l=r.length,n=0,a=-1,i=0,o=0;if(null==t)for(;++a<l;)isNaN(u=(0,e.default)(r[a]))||(o+=(f=u-i)*(u-(i+=f/++n)));else for(;++a<l;)isNaN(u=(0,e.default)(t(r[a],a,r)))||(o+=(f=u-i)*(u-(i+=f/++n)));if(n>1)return o/(n-1)}
},{"./number":"fzXe"}],"JPBu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=t;var e=r(require("./variance"));function r(e){return e&&e.__esModule?e:{default:e}}function t(r,t){var u=(0,e.default)(r,t);return u?Math.sqrt(u):u}
},{"./variance":"IBjk"}],"tlMU":[function(require,module,exports) {
"use strict";function e(e,l){var r,u,f,n=e.length,t=-1;if(null==l){for(;++t<n;)if(null!=(r=e[t])&&r>=r)for(u=f=r;++t<n;)null!=(r=e[t])&&(u>r&&(u=r),f<r&&(f=r))}else for(;++t<n;)if(null!=(r=l(e[t],t,e))&&r>=r)for(u=f=r;++t<n;)null!=(r=l(e[t],t,e))&&(u>r&&(u=r),f<r&&(f=r));return[u,f]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"OA0j":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.map=exports.slice=void 0;var e=Array.prototype,r=e.slice;exports.slice=r;var p=e.map;exports.map=p;
},{}],"OY6d":[function(require,module,exports) {
"use strict";function e(e){return function(){return e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"nPOL":[function(require,module,exports) {
"use strict";function e(e){return e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"M46h":[function(require,module,exports) {
"use strict";function e(e,t,r){e=+e,t=+t,r=(n=arguments.length)<2?(t=e,e=0,1):n<3?1:+r;for(var a=-1,n=0|Math.max(0,Math.ceil((t-e)/r)),o=new Array(n);++a<n;)o[a]=e+a*r;return o}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"nJNY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e,exports.tickIncrement=o,exports.tickStep=M;var t=Math.sqrt(50),r=Math.sqrt(10),a=Math.sqrt(2);function e(t,r,a){var e,M,h,i,n=-1;if(a=+a,(t=+t)===(r=+r)&&a>0)return[t];if((e=r<t)&&(M=t,t=r,r=M),0===(i=o(t,r,a))||!isFinite(i))return[];if(i>0)for(t=Math.ceil(t/i),r=Math.floor(r/i),h=new Array(M=Math.ceil(r-t+1));++n<M;)h[n]=(t+n)*i;else for(t=Math.floor(t*i),r=Math.ceil(r*i),h=new Array(M=Math.ceil(t-r+1));++n<M;)h[n]=(t-n)/i;return e&&h.reverse(),h}function o(e,o,M){var h=(o-e)/Math.max(0,M),i=Math.floor(Math.log(h)/Math.LN10),n=h/Math.pow(10,i);return i>=0?(n>=t?10:n>=r?5:n>=a?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(n>=t?10:n>=r?5:n>=a?2:1)}function M(e,o,M){var h=Math.abs(o-e)/Math.max(0,M),i=Math.pow(10,Math.floor(Math.log(h)/Math.LN10)),n=h/i;return n>=t?i*=10:n>=r?i*=5:n>=a&&(i*=2),o<e?-i:i}
},{}],"PgUT":[function(require,module,exports) {
"use strict";function e(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"eRk3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=l;var e=require("./array"),r=o(require("./bisect")),t=o(require("./constant")),u=o(require("./extent")),n=o(require("./identity")),a=o(require("./range")),f=require("./ticks"),i=o(require("./threshold/sturges"));function o(e){return e&&e.__esModule?e:{default:e}}function l(){var o=n.default,l=u.default,s=i.default;function c(e){var t,u,n=e.length,i=new Array(n);for(t=0;t<n;++t)i[t]=o(e[t],t,e);var c=l(i),d=c[0],h=c[1],y=s(i,d,h);Array.isArray(y)||(y=(0,f.tickStep)(d,h,y),y=(0,a.default)(Math.ceil(d/y)*y,h,y));for(var p=y.length;y[0]<=d;)y.shift(),--p;for(;y[p-1]>h;)y.pop(),--p;var q,v=new Array(p+1);for(t=0;t<=p;++t)(q=v[t]=[]).x0=t>0?y[t-1]:d,q.x1=t<p?y[t]:h;for(t=0;t<n;++t)d<=(u=i[t])&&u<=h&&v[(0,r.default)(y,u,0,p)].push(e[t]);return v}return c.value=function(e){return arguments.length?(o="function"==typeof e?e:(0,t.default)(e),c):o},c.domain=function(e){return arguments.length?(l="function"==typeof e?e:(0,t.default)([e[0],e[1]]),c):l},c.thresholds=function(r){return arguments.length?(s="function"==typeof r?r:Array.isArray(r)?(0,t.default)(e.slice.call(r)):(0,t.default)(r),c):s},c}
},{"./array":"OA0j","./bisect":"VXHZ","./constant":"OY6d","./extent":"tlMU","./identity":"nPOL","./range":"M46h","./ticks":"nJNY","./threshold/sturges":"PgUT"}],"qoxw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=t;var e=r(require("./number"));function r(e){return e&&e.__esModule?e:{default:e}}function t(r,t,u){if(null==u&&(u=e.default),n=r.length){if((t=+t)<=0||n<2)return+u(r[0],0,r);if(t>=1)return+u(r[n-1],n-1,r);var n,f=(n-1)*t,l=Math.floor(f),o=+u(r[l],l,r);return o+(+u(r[l+1],l+1,r)-o)*(f-l)}}
},{"./number":"fzXe"}],"a8Ry":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=l;var e=require("../array"),r=a(require("../ascending")),t=a(require("../number")),u=a(require("../quantile"));function a(e){return e&&e.__esModule?e:{default:e}}function l(a,l,n){return a=e.map.call(a,t.default).sort(r.default),Math.ceil((n-l)/(2*((0,u.default)(a,.75)-(0,u.default)(a,.25))*Math.pow(a.length,-1/3)))}
},{"../array":"OA0j","../ascending":"A6FA","../number":"fzXe","../quantile":"qoxw"}],"VlA4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=r;var e=t(require("../deviation"));function t(e){return e&&e.__esModule?e:{default:e}}function r(t,r,u){return Math.ceil((u-r)/(3.5*(0,e.default)(t)*Math.pow(t.length,-1/3)))}
},{"../deviation":"JPBu"}],"Raoi":[function(require,module,exports) {
"use strict";function e(e,l){var r,u,f=e.length,n=-1;if(null==l){for(;++n<f;)if(null!=(r=e[n])&&r>=r)for(u=r;++n<f;)null!=(r=e[n])&&r>u&&(u=r)}else for(;++n<f;)if(null!=(r=l(e[n],n,e))&&r>=r)for(u=r;++n<f;)null!=(r=l(e[n],n,e))&&r>u&&(u=r);return u}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"hoEE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=t;var e=r(require("./number"));function r(e){return e&&e.__esModule?e:{default:e}}function t(r,t){var u,f=r.length,l=f,n=-1,a=0;if(null==t)for(;++n<f;)isNaN(u=(0,e.default)(r[n]))?--l:a+=u;else for(;++n<f;)isNaN(u=(0,e.default)(t(r[n],n,r)))?--l:a+=u;if(l)return a/l}
},{"./number":"fzXe"}],"FMd1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=l;var e=t(require("./ascending")),u=t(require("./number")),r=t(require("./quantile"));function t(e){return e&&e.__esModule?e:{default:e}}function l(t,l){var a,n=t.length,s=-1,f=[];if(null==l)for(;++s<n;)isNaN(a=(0,u.default)(t[s]))||f.push(a);else for(;++s<n;)isNaN(a=(0,u.default)(l(t[s],s,t)))||f.push(a);return(0,r.default)(f.sort(e.default),.5)}
},{"./ascending":"A6FA","./number":"fzXe","./quantile":"qoxw"}],"SAjT":[function(require,module,exports) {
"use strict";function e(e){for(var r,t,n,o=e.length,f=-1,l=0;++f<o;)l+=e[f].length;for(t=new Array(l);--o>=0;)for(r=(n=e[o]).length;--r>=0;)t[--l]=n[r];return t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"WLfU":[function(require,module,exports) {
"use strict";function e(e,l){var r,u,f=e.length,n=-1;if(null==l){for(;++n<f;)if(null!=(r=e[n])&&r>=r)for(u=r;++n<f;)null!=(r=e[n])&&u>r&&(u=r)}else for(;++n<f;)if(null!=(r=l(e[n],n,e))&&r>=r)for(u=r;++n<f;)null!=(r=l(e[n],n,e))&&u>r&&(u=r);return u}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"V5Z5":[function(require,module,exports) {
"use strict";function e(e,r){for(var t=r.length,n=new Array(t);t--;)n[t]=e[r[t]];return n}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"c8hi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=t;var e=r(require("./ascending"));function r(e){return e&&e.__esModule?e:{default:e}}function t(r,t){if(u=r.length){var u,n,l=0,o=0,d=r[o];for(null==t&&(t=e.default);++l<u;)(t(n=r[l],d)<0||0!==t(d,d))&&(d=n,o=l);return 0===t(d,d)?o:void 0}}
},{"./ascending":"A6FA"}],"Z0Nc":[function(require,module,exports) {
"use strict";function e(e,t,r){for(var l,n,u=(null==r?e.length:r)-(t=null==t?0:+t);u;)n=Math.random()*u--|0,l=e[u+t],e[u+t]=e[n+t],e[n+t]=l;return e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"O7Vy":[function(require,module,exports) {
"use strict";function e(e,r){var t,l=e.length,o=-1,u=0;if(null==r)for(;++o<l;)(t=+e[o])&&(u+=t);else for(;++o<l;)(t=+r(e[o],o,e))&&(u+=t);return u}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"pk0a":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=t;var e=r(require("./min"));function r(e){return e&&e.__esModule?e:{default:e}}function t(r){if(!(o=r.length))return[];for(var t=-1,u=(0,e.default)(r,n),f=new Array(u);++t<u;)for(var o,a=-1,i=f[t]=new Array(o);++a<o;)i[a]=r[a][t];return f}function n(e){return e.length}
},{"./min":"WLfU"}],"oAxq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=r;var e=t(require("./transpose"));function t(e){return e&&e.__esModule?e:{default:e}}function r(){return(0,e.default)(arguments)}
},{"./transpose":"pk0a"}],"cBuZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"bisect",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"bisectRight",{enumerable:!0,get:function(){return e.bisectRight}}),Object.defineProperty(exports,"bisectLeft",{enumerable:!0,get:function(){return e.bisectLeft}}),Object.defineProperty(exports,"ascending",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(exports,"bisector",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"cross",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(exports,"descending",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(exports,"deviation",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(exports,"extent",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(exports,"histogram",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(exports,"thresholdFreedmanDiaconis",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(exports,"thresholdScott",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(exports,"thresholdSturges",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(exports,"max",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(exports,"mean",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(exports,"median",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(exports,"merge",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(exports,"min",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(exports,"pairs",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(exports,"permute",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(exports,"quantile",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(exports,"range",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(exports,"scan",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(exports,"shuffle",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(exports,"sum",{enumerable:!0,get:function(){return q.default}}),Object.defineProperty(exports,"ticks",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(exports,"tickIncrement",{enumerable:!0,get:function(){return h.tickIncrement}}),Object.defineProperty(exports,"tickStep",{enumerable:!0,get:function(){return h.tickStep}}),Object.defineProperty(exports,"transpose",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(exports,"variance",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(exports,"zip",{enumerable:!0,get:function(){return _.default}});var e=D(require("./bisect")),r=M(require("./ascending")),t=M(require("./bisector")),n=M(require("./cross")),u=M(require("./descending")),i=M(require("./deviation")),o=M(require("./extent")),f=M(require("./histogram")),c=M(require("./threshold/freedmanDiaconis")),a=M(require("./threshold/scott")),p=M(require("./threshold/sturges")),s=M(require("./max")),d=M(require("./mean")),l=M(require("./median")),b=M(require("./merge")),m=M(require("./min")),g=M(require("./pairs")),y=M(require("./permute")),O=M(require("./quantile")),j=M(require("./range")),P=M(require("./scan")),x=M(require("./shuffle")),q=M(require("./sum")),h=D(require("./ticks")),v=M(require("./transpose")),k=M(require("./variance")),_=M(require("./zip"));function M(e){return e&&e.__esModule?e:{default:e}}function w(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return w=function(){return e},e}function D(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=w();if(r&&r.has(e))return r.get(e);var t={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)){var i=n?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(t,u,i):t[u]=e[u]}return t.default=e,r&&r.set(e,t),t}
},{"./bisect":"VXHZ","./ascending":"A6FA","./bisector":"raOJ","./cross":"JGhM","./descending":"wjXp","./deviation":"JPBu","./extent":"tlMU","./histogram":"eRk3","./threshold/freedmanDiaconis":"a8Ry","./threshold/scott":"VlA4","./threshold/sturges":"PgUT","./max":"Raoi","./mean":"hoEE","./median":"FMd1","./merge":"SAjT","./min":"WLfU","./pairs":"aKlf","./permute":"V5Z5","./quantile":"qoxw","./range":"M46h","./scan":"c8hi","./shuffle":"Z0Nc","./sum":"O7Vy","./ticks":"nJNY","./transpose":"pk0a","./variance":"IBjk","./zip":"oAxq"}],"IBma":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.slice=void 0;var e=Array.prototype,r=e.slice;exports.slice=r;
},{}],"ldhC":[function(require,module,exports) {
"use strict";function e(e,t){return e-t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"hcnZ":[function(require,module,exports) {
"use strict";function e(e){for(var t=0,r=e.length,o=e[r-1][1]*e[0][0]-e[r-1][0]*e[0][1];++t<r;)o+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return o}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"GiY2":[function(require,module,exports) {
"use strict";function r(r,e){for(var n,u=-1,f=e.length;++u<f;)if(n=t(r,e[u]))return n;return 0}function t(r,t){for(var n=t[0],u=t[1],f=-1,o=0,i=r.length,c=i-1;o<i;c=o++){var a=r[o],l=a[0],s=a[1],v=r[c],d=v[0],p=v[1];if(e(a,v,t))return 0;s>u!=p>u&&n<(d-l)*(u-s)/(p-s)+l&&(f=-f)}return f}function e(r,t,e){var f;return n(r,t,e)&&u(r[f=+(r[0]===t[0])],e[f],t[f])}function n(r,t,e){return(t[0]-r[0])*(e[1]-r[1])==(e[0]-r[0])*(t[1]-r[1])}function u(r,t,e){return r<=t&&t<=e||e<=t&&t<=r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=r;
},{}],"BhKh":[function(require,module,exports) {
"use strict";function e(){}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"oKpg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=c;var r=require("d3-array"),e=require("./array"),t=u(require("./ascending")),n=u(require("./area")),a=u(require("./constant")),o=u(require("./contains")),i=u(require("./noop"));function u(r){return r&&r.__esModule?r:{default:r}}var f=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function c(){var u=1,c=1,s=r.thresholdSturges,l=v;function d(e){var n=s(e);if(Array.isArray(n))n=n.slice().sort(t.default);else{var a=(0,r.extent)(e),o=a[0],i=a[1];n=(0,r.tickStep)(o,i,n),n=(0,r.range)(Math.floor(o/n)*n,Math.floor(i/n)*n,n)}return n.map(function(r){return h(e,r)})}function h(r,e){var t=[],a=[];return function(r,e,t){var n,a,o,i,s,l,d=new Array,h=new Array;n=a=-1,i=r[0]>=e,f[i<<1].forEach(v);for(;++n<u-1;)o=i,i=r[n+1]>=e,f[o|i<<1].forEach(v);f[i<<0].forEach(v);for(;++a<c-1;){for(n=-1,i=r[a*u+u]>=e,s=r[a*u]>=e,f[i<<1|s<<2].forEach(v);++n<u-1;)o=i,i=r[a*u+u+n+1]>=e,l=s,s=r[a*u+n+1]>=e,f[o|i<<1|s<<2|l<<3].forEach(v);f[i|s<<3].forEach(v)}n=-1,s=r[a*u]>=e,f[s<<2].forEach(v);for(;++n<u-1;)l=s,s=r[a*u+n+1]>=e,f[s<<2|l<<3].forEach(v);function v(r){var e,o,i=[r[0][0]+n,r[0][1]+a],u=[r[1][0]+n,r[1][1]+a],f=g(i),c=g(u);(e=h[f])?(o=d[c])?(delete h[e.end],delete d[o.start],e===o?(e.ring.push(u),t(e.ring)):d[e.start]=h[o.end]={start:e.start,end:o.end,ring:e.ring.concat(o.ring)}):(delete h[e.end],e.ring.push(u),h[e.end=c]=e):(e=d[c])?(o=h[f])?(delete d[e.start],delete h[o.end],e===o?(e.ring.push(u),t(e.ring)):d[o.start]=h[e.end]={start:o.start,end:e.end,ring:o.ring.concat(e.ring)}):(delete d[e.start],e.ring.unshift(i),d[e.start=f]=e):d[f]=h[c]={start:f,end:c,ring:[i,u]}}f[s<<3].forEach(v)}(r,e,function(o){l(o,r,e),(0,n.default)(o)>0?t.push([o]):a.push(o)}),a.forEach(function(r){for(var e,n=0,a=t.length;n<a;++n)if(-1!==(0,o.default)((e=t[n])[0],r))return void e.push(r)}),{type:"MultiPolygon",value:e,coordinates:t}}function g(r){return 2*r[0]+r[1]*(u+1)*4}function v(r,e,t){r.forEach(function(r){var n,a=r[0],o=r[1],i=0|a,f=0|o,s=e[f*u+i];a>0&&a<u&&i===a&&(n=e[f*u+i-1],r[0]=a+(t-n)/(s-n)-.5),o>0&&o<c&&f===o&&(n=e[(f-1)*u+i],r[1]=o+(t-n)/(s-n)-.5)})}return d.contour=h,d.size=function(r){if(!arguments.length)return[u,c];var e=Math.ceil(r[0]),t=Math.ceil(r[1]);if(!(e>0&&t>0))throw new Error("invalid size");return u=e,c=t,d},d.thresholds=function(r){return arguments.length?(s="function"==typeof r?r:Array.isArray(r)?(0,a.default)(e.slice.call(r)):(0,a.default)(r),d):s},d.smooth=function(r){return arguments.length?(l=r?v:i.default,d):l===v},d}
},{"d3-array":"cBuZ","./array":"IBma","./ascending":"ldhC","./area":"hcnZ","./constant":"OY6d","./contains":"GiY2","./noop":"BhKh"}],"sajJ":[function(require,module,exports) {
(function(){"use strict";var e=Object.assign;function n(n,t){t||(t={});var r,i,u=t.vargs||function(e){var n=e+"",t=n.indexOf("...");return t>=0&&(t<n.indexOf(")")||n.indexOf("arguments")>=0)}(n),o=Object.create(null),l=[],a=[],f=new WeakMap,c=t.maxAge>0&&t.maxAge<1/0?function(e,n,r){return setTimeout(function(){if(r)return n.splice(e,1),void r.splice(e,1);n instanceof WeakMap?n.delete(e):delete n[e]},t.maxAge)}:0,s=t.equals?t.equals:function(e,n){return e===n},d=t.maxArgs,g=t.serializer;return 1!==n.length||t.equals||u?r=function(){var e,t=d||arguments.length;for(e=l.length-1;e>=0;e--)for(var r=t-1;r>=0&&s(l[e][r],arguments[r]);r--)if(0===r)return a[e];return e=l.length-(e+1),!c||c(e,a,l),a[e]=n.apply(this,l[e]=arguments)}.bind(this):(r=function(e){var t,r=typeof e;if(!g&&("object"===r&&e||"function"===r))return f.get(e)||(!c||c(e,f),f.set(e,t=n.call(this,e)),t);var i="number"===r||"boolean"===r||null==e?e:"string"===r?JSON.stringify(e):g(e);return o[i]||(!c||c(i,o),o[i]=n.call(this,e))}.bind(this),i=1),r.clear=function(){f=new WeakMap,o=Object.create(null),l=[],a=[]},r.keys=function(){return i?null:l.slice()},r.values=function(){return i?null:a.slice()},r.keyValues=function(){return i?{primitives:e({},o),objects:f}:null},r}"function"!=typeof e&&(e=function(){var e=arguments,n=arguments[0];if(null==n)throw new TypeError("Cannot convert undefined or null to object");n=Object(n);for(var t=1;t<e.length;t++)if(e[t]&&"object"==typeof e[t])for(var r in e[t])n[r]=e[t][r];return n}),"undefined"!=typeof module&&(module.exports=n),"undefined"!=typeof window&&(window.nanomemoize=n)}).call(this);
},{}],"il2D":[function(require,module,exports) {
"use strict";function e(e,r,t){void 0===t&&(t={});var o={type:"Feature"};return(0===t.id||t.id)&&(o.id=t.id),t.bbox&&(o.bbox=t.bbox),o.properties=r||{},o.geometry=e,o}function r(e,r,o){switch(void 0===o&&(o={}),e){case"Point":return t(r).geometry;case"LineString":return s(r).geometry;case"Polygon":return n(r).geometry;case"MultiPoint":return m(r).geometry;case"MultiLineString":return d(r).geometry;case"MultiPolygon":return c(r).geometry;default:throw new Error(e+" is invalid")}}function t(r,t,o){return void 0===o&&(o={}),e({type:"Point",coordinates:r},t,o)}function o(e,r,o){return void 0===o&&(o={}),u(e.map(function(e){return t(e,r)}),o)}function n(r,t,o){void 0===o&&(o={});for(var n=0,i=r;n<i.length;n++){var s=i[n];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return e({type:"Polygon",coordinates:r},t,o)}function i(e,r,t){return void 0===t&&(t={}),u(e.map(function(e){return n(e,r)}),t)}function s(r,t,o){if(void 0===o&&(o={}),r.length<2)throw new Error("coordinates must be an array of two or more positions");return e({type:"LineString",coordinates:r},t,o)}function a(e,r,t){return void 0===t&&(t={}),u(e.map(function(e){return s(e,r)}),t)}function u(e,r){void 0===r&&(r={});var t={type:"FeatureCollection"};return r.id&&(t.id=r.id),r.bbox&&(t.bbox=r.bbox),t.features=e,t}function d(r,t,o){return void 0===o&&(o={}),e({type:"MultiLineString",coordinates:r},t,o)}function m(r,t,o){return void 0===o&&(o={}),e({type:"MultiPoint",coordinates:r},t,o)}function c(r,t,o){return void 0===o&&(o={}),e({type:"MultiPolygon",coordinates:r},t,o)}function l(r,t,o){return void 0===o&&(o={}),e({type:"GeometryCollection",geometries:r},t,o)}function h(e,r){if(void 0===r&&(r=0),r&&!(r>=0))throw new Error("precision must be a positive number");var t=Math.pow(10,r||0);return Math.round(e*t)/t}function p(e,r){void 0===r&&(r="kilometers");var t=exports.factors[r];if(!t)throw new Error(r+" units is invalid");return e*t}function f(e,r){void 0===r&&(r="kilometers");var t=exports.factors[r];if(!t)throw new Error(r+" units is invalid");return e/t}function x(e,r){return w(f(e,r))}function g(e){var r=e%360;return r<0&&(r+=360),r}function w(e){return 180*(e%(2*Math.PI))/Math.PI}function b(e){return e%360*Math.PI/180}function v(e,r,t){if(void 0===r&&(r="kilometers"),void 0===t&&(t="kilometers"),!(e>=0))throw new Error("length must be a positive number");return p(f(e,r),t)}function y(e,r,t){if(void 0===r&&(r="meters"),void 0===t&&(t="kilometers"),!(e>=0))throw new Error("area must be a positive number");var o=exports.areaFactors[r];if(!o)throw new Error("invalid original units");var n=exports.areaFactors[t];if(!n)throw new Error("invalid final units");return e/o*n}function E(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)&&!/^\s*$/.test(e)}function R(e){return!!e&&e.constructor===Object}function P(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(e){if(!E(e))throw new Error("bbox must only contain numbers")})}function T(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}function M(){throw new Error("method has been renamed to `radiansToDegrees`")}function k(){throw new Error("method has been renamed to `degreesToRadians`")}function A(){throw new Error("method has been renamed to `lengthToDegrees`")}function L(){throw new Error("method has been renamed to `lengthToRadians`")}function D(){throw new Error("method has been renamed to `radiansToLength`")}function F(){throw new Error("method has been renamed to `bearingToAzimuth`")}function S(){throw new Error("method has been renamed to `convertLength`")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.earthRadius=6371008.8,exports.factors={centimeters:100*exports.earthRadius,centimetres:100*exports.earthRadius,degrees:exports.earthRadius/111325,feet:3.28084*exports.earthRadius,inches:39.37*exports.earthRadius,kilometers:exports.earthRadius/1e3,kilometres:exports.earthRadius/1e3,meters:exports.earthRadius,metres:exports.earthRadius,miles:exports.earthRadius/1609.344,millimeters:1e3*exports.earthRadius,millimetres:1e3*exports.earthRadius,nauticalmiles:exports.earthRadius/1852,radians:1,yards:exports.earthRadius/1.0936},exports.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/exports.earthRadius,yards:1/1.0936},exports.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:3.86e-7,millimeters:1e6,millimetres:1e6,yards:1.195990046},exports.feature=e,exports.geometry=r,exports.point=t,exports.points=o,exports.polygon=n,exports.polygons=i,exports.lineString=s,exports.lineStrings=a,exports.featureCollection=u,exports.multiLineString=d,exports.multiPoint=m,exports.multiPolygon=c,exports.geometryCollection=l,exports.round=h,exports.radiansToLength=p,exports.lengthToRadians=f,exports.lengthToDegrees=x,exports.bearingToAzimuth=g,exports.radiansToDegrees=w,exports.degreesToRadians=b,exports.convertLength=v,exports.convertArea=y,exports.isNumber=E,exports.isObject=R,exports.validateBBox=P,exports.validateId=T,exports.radians2degrees=M,exports.degrees2radians=k,exports.distanceToDegrees=A,exports.distanceToRadians=L,exports.radiansToDistance=D,exports.bearingToAngle=F,exports.convertDistance=S;
},{}],"CvJj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__extends=e,exports.__rest=n,exports.__decorate=o,exports.__param=a,exports.__metadata=i,exports.__awaiter=u,exports.__generator=c,exports.__exportStar=f,exports.__values=l,exports.__read=s,exports.__spread=p,exports.__spreadArrays=y,exports.__await=_,exports.__asyncGenerator=h,exports.__asyncDelegator=v,exports.__asyncValues=b,exports.__makeTemplateObject=d,exports.__importStar=w,exports.__importDefault=x,exports.__classPrivateFieldGet=m,exports.__classPrivateFieldSet=O,exports.__assign=void 0;var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};function e(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return exports.__assign=r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function o(t,e,r,n){var o,a=arguments.length,i=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(o=t[u])&&(i=(a<3?o(i):a>3?o(e,r,i):o(e,r))||i);return a>3&&i&&Object.defineProperty(e,r,i),i}function a(t,e){return function(r,n){e(r,n,t)}}function i(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function u(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{c(n.next(t))}catch(e){a(e)}}function u(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(i,u)}c((n=n.apply(t,e||[])).next())})}function c(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(u){a=[6,u],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function f(t,e){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}function l(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(u){o={error:u}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function p(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}function y(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var a=arguments[e],i=0,u=a.length;i<u;i++,o++)n[o]=a[i];return n}function _(t){return this instanceof _?(this.v=t,this):new _(t)}function h(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){a.push([t,e,r,n])>1||u(t,e)})})}function u(t,e){try{(r=o[t](e)).value instanceof _?Promise.resolve(r.value.v).then(c,f):l(a[0][2],r)}catch(n){l(a[0][3],n)}var r}function c(t){u("next",t)}function f(t){u("throw",t)}function l(t,e){t(e),a.shift(),a.length&&u(a[0][0],a[0][1])}}function v(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:_(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof l?l(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}}function d(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function w(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function x(t){return t&&t.__esModule?t:{default:t}}function m(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function O(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}exports.__assign=r;
},{}],"rrEo":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0});var r=require("tslib"),e={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,r){if(!t)throw n(r)},n=function(t){return new Error("Firebase Database ("+e.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},i=function(t){for(var r=[],e=0,o=0;o<t.length;o++){var n=t.charCodeAt(o);n<128?r[e++]=n:n<2048?(r[e++]=n>>6|192,r[e++]=63&n|128):55296==(64512&n)&&o+1<t.length&&56320==(64512&t.charCodeAt(o+1))?(n=65536+((1023&n)<<10)+(1023&t.charCodeAt(++o)),r[e++]=n>>18|240,r[e++]=n>>12&63|128,r[e++]=n>>6&63|128,r[e++]=63&n|128):(r[e++]=n>>12|224,r[e++]=n>>6&63|128,r[e++]=63&n|128)}return r},s=function(t){for(var r=[],e=0,o=0;e<t.length;){var n=t[e++];if(n<128)r[o++]=String.fromCharCode(n);else if(n>191&&n<224){var i=t[e++];r[o++]=String.fromCharCode((31&n)<<6|63&i)}else if(n>239&&n<365){var s=((7&n)<<18|(63&(i=t[e++]))<<12|(63&(a=t[e++]))<<6|63&t[e++])-65536;r[o++]=String.fromCharCode(55296+(s>>10)),r[o++]=String.fromCharCode(56320+(1023&s))}else{i=t[e++];var a=t[e++];r[o++]=String.fromCharCode((15&n)<<12|(63&i)<<6|63&a)}}return r.join("")},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,r){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var e=r?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[],n=0;n<t.length;n+=3){var i=t[n],s=n+1<t.length,a=s?t[n+1]:0,c=n+2<t.length,h=c?t[n+2]:0,f=i>>2,u=(3&i)<<4|a>>4,p=(15&a)<<2|h>>6,l=63&h;c||(l=64,s||(p=64)),o.push(e[f],e[u],e[p],e[l])}return o.join("")},encodeString:function(t,r){return this.HAS_NATIVE_SUPPORT&&!r?btoa(t):this.encodeByteArray(i(t),r)},decodeString:function(t,r){return this.HAS_NATIVE_SUPPORT&&!r?atob(t):s(this.decodeStringToByteArray(t,r))},decodeStringToByteArray:function(t,r){this.init_();for(var e=r?this.charToByteMapWebSafe_:this.charToByteMap_,o=[],n=0;n<t.length;){var i=e[t.charAt(n++)],s=n<t.length?e[t.charAt(n)]:0,a=++n<t.length?e[t.charAt(n)]:64,c=++n<t.length?e[t.charAt(n)]:64;if(++n,null==i||null==s||null==a||null==c)throw Error();var h=i<<2|s>>4;if(o.push(h),64!==a){var f=s<<4&240|a>>2;if(o.push(f),64!==c){var u=a<<6&192|c;o.push(u)}}}return o},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},c=function(t){var r=i(t);return a.encodeByteArray(r,!0)},h=function(t){try{return a.decodeString(t,!0)}catch(r){console.error("base64Decode failed: ",r)}return null};function f(t){return u(void 0,t)}function u(t,r){if(!(r instanceof Object))return r;switch(r.constructor){case Date:return new Date(r.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return r}for(var e in r)r.hasOwnProperty(e)&&(t[e]=u(t[e],r[e]));return t}var p=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(r,e){t.resolve=r,t.reject=e})}return t.prototype.wrapCallback=function(t){var r=this;return function(e,o){e?r.reject(e):r.resolve(o),"function"==typeof t&&(r.promise.catch(function(){}),1===t.length?t(e):t(e,o))}},t}();function l(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function v(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(l())}function d(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(r){return!1}}function b(){return"object"==typeof self&&self.self===self}function y(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function _(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function E(){return l().indexOf("Electron/")>=0}function g(){var t=l();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function S(){return l().indexOf("MSAppHost/")>=0}function A(){return!0===e.NODE_CLIENT||!0===e.NODE_ADMIN}var x="FirebaseError",O=function(t){function e(r,o){var n=t.call(this,o)||this;return n.code=r,n.name=x,Object.setPrototypeOf(n,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,m.prototype.create),n}return r.__extends(e,t),e}(Error),m=function(){function t(t,r,e){this.service=t,this.serviceName=r,this.errors=e}return t.prototype.create=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];for(var o=r[0]||{},n=this.service+"/"+t,i=this.errors[t],s=i?C(i,o):"Error",a=this.serviceName+": "+s+" ("+n+").",c=new O(n,a),h=0,f=Object.keys(o);h<f.length;h++){var u=f[h];"_"!==u.slice(-1)&&(u in c&&console.warn('Overwriting FirebaseError base field "'+u+'" can cause unexpected behavior.'),c[u]=o[u])}return c},t}();function C(t,r){return t.replace(w,function(t,e){var o=r[e];return null!=o?o.toString():"<"+e+"?>"})}var w=/\{\$([^}]+)}/g;function N(t){return JSON.parse(t)}function T(t){return JSON.stringify(t)}var D=function(t){var r={},e={},o={},n="";try{var i=t.split(".");r=N(h(i[0])||""),e=N(h(i[1])||""),n=i[2],o=e.d||{},delete e.d}catch(s){}return{header:r,claims:e,data:o,signature:n}},j=function(t){var r=D(t).claims,e=Math.floor((new Date).getTime()/1e3),o=0,n=0;return"object"==typeof r&&(r.hasOwnProperty("nbf")?o=r.nbf:r.hasOwnProperty("iat")&&(o=r.iat),n=r.hasOwnProperty("exp")?r.exp:o+86400),!!e&&!!o&&!!n&&e>=o&&e<=n},k=function(t){var r=D(t).claims;return"object"==typeof r&&r.hasOwnProperty("iat")?r.iat:null},M=function(t){var r=D(t).claims;return!!r&&"object"==typeof r&&r.hasOwnProperty("iat")},B=function(t){var r=D(t).claims;return"object"==typeof r&&!0===r.admin};function P(t,r){return Object.prototype.hasOwnProperty.call(t,r)}function V(t,r){return Object.prototype.hasOwnProperty.call(t,r)?t[r]:void 0}function I(t){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r))return!1;return!0}function W(t,r,e){var o={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=r.call(e,t[n],n,t));return o}function L(t){for(var r=[],e=function(t,e){Array.isArray(e)?e.forEach(function(e){r.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}):r.push(encodeURIComponent(t)+"="+encodeURIComponent(e))},o=0,n=Object.entries(t);o<n.length;o++){var i=n[o];e(i[0],i[1])}return r.length?"&"+r.join("&"):""}function R(t){var r={};return t.replace(/^\?/,"").split("&").forEach(function(t){if(t){var e=t.split("=");r[e[0]]=e[1]}}),r}var z=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,r){r||(r=0);var e=this.W_;if("string"==typeof t)for(var o=0;o<16;o++)e[o]=t.charCodeAt(r)<<24|t.charCodeAt(r+1)<<16|t.charCodeAt(r+2)<<8|t.charCodeAt(r+3),r+=4;else for(o=0;o<16;o++)e[o]=t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3],r+=4;for(o=16;o<80;o++){var n=e[o-3]^e[o-8]^e[o-14]^e[o-16];e[o]=4294967295&(n<<1|n>>>31)}var i,s,a=this.chain_[0],c=this.chain_[1],h=this.chain_[2],f=this.chain_[3],u=this.chain_[4];for(o=0;o<80;o++){o<40?o<20?(i=f^c&(h^f),s=1518500249):(i=c^h^f,s=1859775393):o<60?(i=c&h|f&(c|h),s=2400959708):(i=c^h^f,s=3395469782);n=(a<<5|a>>>27)+i+u+s+e[o]&4294967295;u=f,f=h,h=4294967295&(c<<30|c>>>2),c=a,a=n}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295},t.prototype.update=function(t,r){if(null!=t){void 0===r&&(r=t.length);for(var e=r-this.blockSize,o=0,n=this.buf_,i=this.inbuf_;o<r;){if(0===i)for(;o<=e;)this.compress_(t,o),o+=this.blockSize;if("string"==typeof t){for(;o<r;)if(n[i]=t.charCodeAt(o),++o,++i===this.blockSize){this.compress_(n),i=0;break}}else for(;o<r;)if(n[i]=t[o],++o,++i===this.blockSize){this.compress_(n),i=0;break}}this.inbuf_=i,this.total_+=r}},t.prototype.digest=function(){var t=[],r=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&r,r/=256;this.compress_(this.buf_);var o=0;for(e=0;e<5;e++)for(var n=24;n>=0;n-=8)t[o]=this.chain_[e]>>n&255,++o;return t},t}();function F(t,r){var e=new U(t,r);return e.subscribe.bind(e)}var U=function(){function t(t,r){var e=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(function(){t(e)}).catch(function(t){e.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(r){r.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(r){r.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,r,e){var o,n=this;if(void 0===t&&void 0===r&&void 0===e)throw new Error("Missing Observer.");void 0===(o=q(t,["next","error","complete"])?t:{next:t,error:r,complete:e}).next&&(o.next=J),void 0===o.error&&(o.error=J),void 0===o.complete&&(o.complete=J);var i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{n.finalError?o.error(n.finalError):o.complete()}catch(t){}}),this.observers.push(o),i},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var r=0;r<this.observers.length;r++)this.sendOne(r,t)},t.prototype.sendOne=function(t,r){var e=this;this.task.then(function(){if(void 0!==e.observers&&void 0!==e.observers[t])try{r(e.observers[t])}catch(o){"undefined"!=typeof console&&console.error&&console.error(o)}})},t.prototype.close=function(t){var r=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){r.observers=void 0,r.onNoObservers=void 0}))},t}();function H(t,r){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];Promise.resolve(!0).then(function(){t.apply(void 0,e)}).catch(function(t){r&&r(t)})}}function q(t,r){if("object"!=typeof t||null===t)return!1;for(var e=0,o=r;e<o.length;e++){var n=o[e];if(n in t&&"function"==typeof t[n])return!0}return!1}function J(){}var G=function(t,r,e,o){var n;if(o<r?n="at least "+r:o>e&&(n=0===e?"none":"no more than "+e),n)throw new Error(t+" failed: Was called with "+o+(1===o?" argument.":" arguments.")+" Expects "+n+".")};function K(t,r,e){var o="";switch(r){case 1:o=e?"first":"First";break;case 2:o=e?"second":"Second";break;case 3:o=e?"third":"Third";break;case 4:o=e?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var n=t+" failed: ";return n+=o+" argument "}function $(t,r,e,o){if((!o||e)&&"string"!=typeof e)throw new Error(K(t,r,o)+"must be a valid firebase namespace.")}function Q(t,r,e,o){if((!o||e)&&"function"!=typeof e)throw new Error(K(t,r,o)+"must be a valid function.")}function X(t,r,e,o){if((!o||e)&&("object"!=typeof e||null===e))throw new Error(K(t,r,o)+"must be a valid context object.")}var Y=function(t){for(var r=[],e=0,n=0;n<t.length;n++){var i=t.charCodeAt(n);if(i>=55296&&i<=56319){var s=i-55296;o(++n<t.length,"Surrogate pair missing trail surrogate."),i=65536+(s<<10)+(t.charCodeAt(n)-56320)}i<128?r[e++]=i:i<2048?(r[e++]=i>>6|192,r[e++]=63&i|128):i<65536?(r[e++]=i>>12|224,r[e++]=i>>6&63|128,r[e++]=63&i|128):(r[e++]=i>>18|240,r[e++]=i>>12&63|128,r[e++]=i>>6&63|128,r[e++]=63&i|128)}return r},Z=function(t){for(var r=0,e=0;e<t.length;e++){var o=t.charCodeAt(e);o<128?r++:o<2048?r+=2:o>=55296&&o<=56319?(r+=4,e++):r+=3}return r};exports.CONSTANTS=e,exports.Deferred=p,exports.ErrorFactory=m,exports.FirebaseError=O,exports.Sha1=z,exports.assert=o,exports.assertionError=n,exports.async=H,exports.base64=a,exports.base64Decode=h,exports.base64Encode=c,exports.contains=P,exports.createSubscribe=F,exports.decode=D,exports.deepCopy=f,exports.deepExtend=u,exports.errorPrefix=K,exports.getUA=l,exports.isAdmin=B,exports.isBrowser=b,exports.isBrowserExtension=y,exports.isElectron=E,exports.isEmpty=I,exports.isIE=g,exports.isMobileCordova=v,exports.isNode=d,exports.isNodeSdk=A,exports.isReactNative=_,exports.isUWP=S,exports.isValidFormat=M,exports.isValidTimestamp=j,exports.issuedAtTime=k,exports.jsonEval=N,exports.map=W,exports.querystring=L,exports.querystringDecode=R,exports.safeGet=V,exports.stringLength=Z,exports.stringToByteArray=Y,exports.stringify=T,exports.validateArgCount=G,exports.validateCallback=Q,exports.validateContextObject=X,exports.validateNamespace=$;
},{"tslib":"CvJj"}],"YHdR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("tslib"),e=require("@firebase/util"),n=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),r="[DEFAULT]",i=function(){function n(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return n.prototype.get=function(t){void 0===t&&(t=r);var n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){var i=new e.Deferred;this.instancesDeferred.set(n,i);try{var o=this.getOrInitializeService(n);o&&i.resolve(o)}catch(s){}}return this.instancesDeferred.get(n).promise},n.prototype.getImmediate=function(e){var n=t.__assign({identifier:r,optional:!1},e),i=n.identifier,o=n.optional,s=this.normalizeInstanceIdentifier(i);try{var a=this.getOrInitializeService(s);if(!a){if(o)return null;throw Error("Service "+this.name+" is not available")}return a}catch(c){if(o)return null;throw c}},n.prototype.getComponent=function(){return this.component},n.prototype.setComponent=function(e){var n,i;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,s(e))try{this.getOrInitializeService(r)}catch(l){}try{for(var o=t.__values(this.instancesDeferred.entries()),a=o.next();!a.done;a=o.next()){var c=t.__read(a.value,2),p=c[0],h=c[1],u=this.normalizeInstanceIdentifier(p);try{var f=this.getOrInitializeService(u);h.resolve(f)}catch(l){}}}catch(d){n={error:d}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},n.prototype.clearInstance=function(t){void 0===t&&(t=r),this.instancesDeferred.delete(t),this.instances.delete(t)},n.prototype.delete=function(){return t.__awaiter(this,void 0,void 0,function(){var e;return t.__generator(this,function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(e.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}))];case 1:return t.sent(),[2]}})})},n.prototype.isComponentSet=function(){return null!=this.component},n.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,o(t)),this.instances.set(t,e)),e||null},n.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:r:t},n}();function o(t){return t===r?void 0:t}function s(t){return"EAGER"===t.instantiationMode}var a=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new i(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();exports.Component=n,exports.ComponentContainer=a,exports.Provider=i;
},{"tslib":"CvJj","@firebase/util":"rrEo"}],"srlT":[function(require,module,exports) {
"use strict";function e(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;var n=Array(e),o=0;for(r=0;r<t;r++)for(var l=arguments[r],i=0,s=l.length;i<s;i++,o++)n[o]=l[i];return n}var r;Object.defineProperty(exports,"__esModule",{value:!0}),exports.setLogLevel=g,exports.setUserLogHandler=u,exports.Logger=exports.LogLevel=void 0;var t,n=[];exports.LogLevel=t,function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(t||(exports.LogLevel=t={}));var o={debug:t.DEBUG,verbose:t.VERBOSE,info:t.INFO,warn:t.WARN,error:t.ERROR,silent:t.SILENT},l=t.INFO,i=((r={})[t.DEBUG]="log",r[t.VERBOSE]="log",r[t.INFO]="info",r[t.WARN]="warn",r[t.ERROR]="error",r),s=function(r,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];if(!(t<r.logLevel)){var l=(new Date).toISOString(),s=i[t];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[s].apply(console,e(["["+l+"]  "+r.name+":"],n))}},a=function(){function r(e){this.name=e,this._logLevel=l,this._logHandler=s,this._userLogHandler=null,n.push(this)}return Object.defineProperty(r.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in t))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!0,configurable:!0}),r.prototype.debug=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,e([this,t.DEBUG],r)),this._logHandler.apply(this,e([this,t.DEBUG],r))},r.prototype.log=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,e([this,t.VERBOSE],r)),this._logHandler.apply(this,e([this,t.VERBOSE],r))},r.prototype.info=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,e([this,t.INFO],r)),this._logHandler.apply(this,e([this,t.INFO],r))},r.prototype.warn=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,e([this,t.WARN],r)),this._logHandler.apply(this,e([this,t.WARN],r))},r.prototype.error=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,e([this,t.ERROR],r)),this._logHandler.apply(this,e([this,t.ERROR],r))},r}();function g(e){var r="string"==typeof e?o[e]:e;n.forEach(function(e){e.logLevel=r})}function u(e,r){for(var l=function(n){var l=null;r&&r.level&&(l=o[r.level]),n.userLogHandler=null===e?null:function(r,n){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];var s=o.map(function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(r){return null}}).filter(function(e){return e}).join(" ");n>=(null!=l?l:r.logLevel)&&e({level:t[n].toLowerCase(),message:s,args:o,type:r.name})}},i=0,s=n;i<s.length;i++){l(s[i])}}exports.Logger=a;
},{}],"QzTI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,n,r=require("tslib"),t=require("@firebase/util"),i=require("@firebase/component"),a=require("@firebase/logger"),o=((e={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",e["bad-app-name"]="Illegal App name: '{$appName}",e["duplicate-app"]="Firebase App named '{$appName}' already exists",e["app-deleted"]="Firebase App named '{$appName}' already deleted",e["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",e["invalid-log-argument"]="First argument to `onLog` must be null or a function.",e),s=new t.ErrorFactory("app","Firebase",o),p="@firebase/app",l="0.6.4",c="@firebase/analytics",u="@firebase/auth",f="@firebase/database",d="@firebase/functions",m="@firebase/installations",b="@firebase/messaging",h="@firebase/performance",g="@firebase/remote-config",v="@firebase/storage",y="@firebase/firestore",_="firebase-wrapper",w="[DEFAULT]",N=((n={})[p]="fire-core",n[c]="fire-analytics",n[u]="fire-auth",n[f]="fire-rtdb",n[d]="fire-fn",n[m]="fire-iid",n[b]="fire-fcm",n[h]="fire-perf",n[g]="fire-rc",n[v]="fire-gcs",n[y]="fire-fst",n["fire-js"]="fire-js",n[_]="fire-js-all",n),C=new a.Logger("@firebase/app"),I=function(){function e(e,n,a){var o,s,p=this;this.firebase_=a,this.isDeleted_=!1,this.name_=n.name,this.automaticDataCollectionEnabled_=n.automaticDataCollectionEnabled||!1,this.options_=t.deepCopy(e),this.container=new i.ComponentContainer(n.name),this._addComponent(new i.Component("app",function(){return p},"PUBLIC"));try{for(var l=r.__values(this.firebase_.INTERNAL.components.values()),c=l.next();!c.done;c=l.next()){var u=c.value;this._addComponent(u)}}catch(f){o={error:f}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(o)throw o.error}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(n){e.checkDestroyed_(),n()}).then(function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map(function(e){return e.delete()}))}).then(function(){e.isDeleted_=!0})},e.prototype._getService=function(e,n){return void 0===n&&(n=w),this.checkDestroyed_(),this.container.getProvider(e).getImmediate({identifier:n})},e.prototype._removeServiceInstance=function(e,n){void 0===n&&(n=w),this.container.getProvider(e).clearInstance(n)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(n){C.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,n)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw s.create("app-deleted",{appName:this.name_})},e}();I.prototype.name&&I.prototype.options||I.prototype.delete||console.log("dc");var E="7.14.5";function A(e){var n={},o=new Map,p={__esModule:!0,initializeApp:function(r,i){void 0===i&&(i={});if("object"!=typeof i||null===i){var a=i;i={name:a}}var o=i;void 0===o.name&&(o.name=w);var l=o.name;if("string"!=typeof l||!l)throw s.create("bad-app-name",{appName:String(l)});if(t.contains(n,l))throw s.create("duplicate-app",{appName:l});var c=new e(r,o,p);return n[l]=c,c},app:l,registerVersion:function(e,n,r){var t,a=null!==(t=N[e])&&void 0!==t?t:e;r&&(a+="-"+r);var o=a.match(/\s|\//),s=n.match(/\s|\//);if(o||s){var p=['Unable to register library "'+a+'" with version "'+n+'":'];return o&&p.push('library name "'+a+'" contains illegal characters (whitespace or "/")'),o&&s&&p.push("and"),s&&p.push('version name "'+n+'" contains illegal characters (whitespace or "/")'),void C.warn(p.join(" "))}c(new i.Component(a+"-version",function(){return{library:a,version:n}},"VERSION"))},setLogLevel:a.setLogLevel,onLog:function(e,n){if(null!==e&&"function"!=typeof e)throw s.create("invalid-log-argument",{appName:name});a.setUserLogHandler(e,n)},apps:null,SDK_VERSION:E,INTERNAL:{registerComponent:c,removeApp:function(e){delete n[e]},components:o,useAsService:function(e,n){if("serverAuth"===n)return null;return n}}};function l(e){if(e=e||w,!t.contains(n,e))throw s.create("no-app",{appName:e});return n[e]}function c(i){var a,c,u=i.name;if(o.has(u))return C.debug("There were multiple attempts to register component "+u+"."),"PUBLIC"===i.type?p[u]:null;if(o.set(u,i),"PUBLIC"===i.type){var f=function(e){if(void 0===e&&(e=l()),"function"!=typeof e[u])throw s.create("invalid-app-argument",{appName:u});return e[u]()};void 0!==i.serviceProps&&t.deepExtend(f,i.serviceProps),p[u]=f,e.prototype[u]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._getService.bind(this,u).apply(this,i.multipleInstances?e:[])}}try{for(var d=r.__values(Object.keys(n)),m=d.next();!m.done;m=d.next()){var b=m.value;n[b]._addComponent(i)}}catch(h){a={error:h}}finally{try{m&&!m.done&&(c=d.return)&&c.call(d)}finally{if(a)throw a.error}}return"PUBLIC"===i.type?p[u]:null}return p.default=p,Object.defineProperty(p,"apps",{get:function(){return Object.keys(n).map(function(e){return n[e]})}}),l.App=e,p}function F(){var e=A(I);return e.INTERNAL=r.__assign(r.__assign({},e.INTERNAL),{createFirebaseNamespace:F,extendNamespace:function(n){t.deepExtend(e,n)},createSubscribe:t.createSubscribe,ErrorFactory:t.ErrorFactory,deepExtend:t.deepExtend}),e}var P=F(),L=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(e){if(D(e)){var n=e.getImmediate();return n.library+"/"+n.version}return null}).filter(function(e){return e}).join(" ")},e}();function D(e){var n=e.getComponent();return"VERSION"===(null==n?void 0:n.type)}function j(e,n){e.INTERNAL.registerComponent(new i.Component("platform-logger",function(e){return new L(e)},"PRIVATE")),e.registerVersion(p,l,n),e.registerVersion("fire-js","")}if(t.isBrowser()&&void 0!==self.firebase){C.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var O=self.firebase.SDK_VERSION;O&&O.indexOf("LITE")>=0&&C.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var k=P.initializeApp;P.initializeApp=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.isNode()&&C.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),k.apply(void 0,e)};var x=P;j(x),exports.default=x,exports.firebase=x;
},{"tslib":"CvJj","@firebase/util":"rrEo","@firebase/component":"YHdR","@firebase/logger":"srlT"}],"YEwQ":[function(require,module,exports) {
"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var r=e(require("@firebase/app")),t="firebase",i="7.14.6";r.registerVersion(t,i,"app"),module.exports=r;
},{"@firebase/app":"QzTI"}],"VoiF":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];function n(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createWebChannelTransport=exports.XhrIo=exports.WebChannel=exports.EventType=exports.ErrorCode=exports.default=void 0;var e,i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},r=r||{},a=i||self;function s(){}function o(t){var n=typeof t;if("object"==n){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return n;var e=Object.prototype.toString.call(t);if("[object Window]"==e)return"object";if("[object Array]"==e||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==e||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==n&&void 0===t.call)return"object";return n}function h(t){var n=o(t);return"array"==n||"object"==n&&"number"==typeof t.length}function l(t){var n=typeof t;return"object"==n&&null!=t||"function"==n}function c(t){return Object.prototype.hasOwnProperty.call(t,u)&&t[u]||(t[u]=++f)}var u="closure_uid_"+(1e9*Math.random()>>>0),f=0;function p(t,n,e){return t.call.apply(t.bind,arguments)}function v(t,n,e){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,i),t.apply(n,e)}}return function(){return t.apply(n,arguments)}}function d(t,n,e){return(d=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?p:v).apply(null,arguments)}function g(t,n){var e=Array.prototype.slice.call(arguments,1);return function(){var n=e.slice();return n.push.apply(n,arguments),t.apply(this,n)}}var y=Date.now||function(){return+new Date};function b(t,n){function e(){}e.prototype=n.prototype,t.M=n.prototype,t.prototype=new e,t.prototype.constructor=t}function m(){this.j=this.j,this.i=this.i}var w=0;m.prototype.j=!1,m.prototype.da=function(){if(!this.j&&(this.j=!0,this.C(),0!=w))c(this)},m.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var E=Array.prototype.indexOf?function(t,n){return Array.prototype.indexOf.call(t,n,void 0)}:function(t,n){if("string"==typeof t)return"string"!=typeof n||1!=n.length?-1:t.indexOf(n,0);for(var e=0;e<t.length;e++)if(e in t&&t[e]===n)return e;return-1},T=Array.prototype.forEach?function(t,n,e){Array.prototype.forEach.call(t,n,e)}:function(t,n,e){for(var i=t.length,r="string"==typeof t?t.split(""):t,a=0;a<i;a++)a in r&&n.call(e,r[a],a,t)};function C(t){t:{for(var n=Ae,e=t.length,i="string"==typeof t?t.split(""):t,r=0;r<e;r++)if(r in i&&n.call(void 0,i[r],r,t)){n=r;break t}n=-1}return 0>n?null:"string"==typeof t?t.charAt(n):t[n]}function S(t){return Array.prototype.concat.apply([],arguments)}function I(t){var n=t.length;if(0<n){for(var e=Array(n),i=0;i<n;i++)e[i]=t[i];return e}return[]}function x(t){return/^[\s\xa0]*$/.test(t)}var O,j=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function A(t,n){return-1!=t.indexOf(n)}function P(t,n){return t<n?-1:t>n?1:0}t:{var R=a.navigator;if(R){var L=R.userAgent;if(L){O=L;break t}}O=""}function M(t,n,e){for(var i in t)n.call(e,t[i],i,t)}function k(t){var n={};for(var e in t)n[e]=t[e];return n}var D="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function X(t,n){for(var e,i,r=1;r<arguments.length;r++){for(e in i=arguments[r])t[e]=i[e];for(var a=0;a<D.length;a++)e=D[a],Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e])}}function _(t){return _[" "](t),t}function H(t,n){var e=z;return Object.prototype.hasOwnProperty.call(e,t)?e[t]:e[t]=n(t)}_[" "]=s;var N,U=A(O,"Opera"),K=A(O,"Trident")||A(O,"MSIE"),F=A(O,"Edge"),W=F||K,Y=A(O,"Gecko")&&!(A(O.toLowerCase(),"webkit")&&!A(O,"Edge"))&&!(A(O,"Trident")||A(O,"MSIE"))&&!A(O,"Edge"),B=A(O.toLowerCase(),"webkit")&&!A(O,"Edge");function G(){var t=a.document;return t?t.documentMode:void 0}t:{var J="",$=function(){var t=O;return Y?/rv:([^\);]+)(\)|;)/.exec(t):F?/Edge\/([\d\.]+)/.exec(t):K?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):B?/WebKit\/(\S+)/.exec(t):U?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if($&&(J=$?$[1]:""),K){var q=G();if(null!=q&&q>parseFloat(J)){N=String(q);break t}}N=J}var V,z={};function Z(t){return H(t,function(){for(var n=0,e=j(String(N)).split("."),i=j(String(t)).split("."),r=Math.max(e.length,i.length),a=0;0==n&&a<r;a++){var s=e[a]||"",o=i[a]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==s[0].length&&0==o[0].length)break;n=P(0==s[1].length?0:parseInt(s[1],10),0==o[1].length?0:parseInt(o[1],10))||P(0==s[2].length,0==o[2].length)||P(s[2],o[2]),s=s[3],o=o[3]}while(0==n)}return 0<=n})}if(a.document&&K){var Q=G();V=Q||(parseInt(N,10)||void 0)}else V=void 0;var tt=V,nt=!K||9<=Number(tt),et=K&&!Z("9"),it=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var t=!1,n=Object.defineProperty({},"passive",{get:function(){t=!0}});try{a.addEventListener("test",s,n),a.removeEventListener("test",s,n)}catch(e){}return t}();function rt(t,n){this.type=t,this.a=this.target=n,this.defaultPrevented=!1}function at(t,n){if(rt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var e=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=n,n=t.relatedTarget){if(Y){t:{try{_(n.nodeName);var r=!0;break t}catch(a){}r=!1}r||(n=null)}}else"mouseover"==e?n=t.fromElement:"mouseout"==e&&(n=t.toElement);this.relatedTarget=n,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:st[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}rt.prototype.b=function(){this.defaultPrevented=!0},b(at,rt);var st={2:"touch",3:"pen",4:"mouse"};at.prototype.b=function(){at.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,et)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(n){}};var ot="closure_listenable_"+(1e6*Math.random()|0),ht=0;function lt(t,n,e,i,r){this.listener=t,this.proxy=null,this.src=n,this.type=e,this.capture=!!i,this.aa=r,this.key=++ht,this.V=this.X=!1}function ct(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function ut(t){this.src=t,this.a={},this.b=0}function ft(t,n){var e=n.type;if(e in t.a){var i,r=t.a[e],a=E(r,n);(i=0<=a)&&Array.prototype.splice.call(r,a,1),i&&(ct(n),0==t.a[e].length&&(delete t.a[e],t.b--))}}function pt(t,n,e,i){for(var r=0;r<t.length;++r){var a=t[r];if(!a.V&&a.listener==n&&a.capture==!!e&&a.aa==i)return r}return-1}ut.prototype.add=function(t,n,e,i,r){var a=t.toString();(t=this.a[a])||(t=this.a[a]=[],this.b++);var s=pt(t,n,i,r);return-1<s?(n=t[s],e||(n.X=!1)):((n=new lt(n,this.src,a,!!i,r)).X=e,t.push(n)),n};var vt="closure_lm_"+(1e6*Math.random()|0),dt={};function gt(t,n,e,i,r){if(i&&i.once)return mt(t,n,e,i,r);if(Array.isArray(n)){for(var a=0;a<n.length;a++)gt(t,n[a],e,i,r);return null}return e=Ot(e),t&&t[ot]?t.ra(n,e,l(i)?!!i.capture:!!i,r):yt(t,n,e,!1,i,r)}function yt(t,n,e,i,r,a){if(!n)throw Error("Invalid event type");var s=l(r)?!!r.capture:!!r;if(s&&!nt)return null;var o=It(t);if(o||(t[vt]=o=new ut(t)),(e=o.add(n,e,i,s,a)).proxy)return e;if(i=bt(),e.proxy=i,i.src=t,i.listener=e,t.addEventListener)it||(r=s),void 0===r&&(r=!1),t.addEventListener(n.toString(),i,r);else if(t.attachEvent)t.attachEvent(Tt(n.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return e}function bt(){var t=St,n=nt?function(e){return t.call(n.src,n.listener,e)}:function(e){if(!(e=t.call(n.src,n.listener,e)))return e};return n}function mt(t,n,e,i,r){if(Array.isArray(n)){for(var a=0;a<n.length;a++)mt(t,n[a],e,i,r);return null}return e=Ot(e),t&&t[ot]?t.sa(n,e,l(i)?!!i.capture:!!i,r):yt(t,n,e,!0,i,r)}function wt(t,n,e,i,r){if(Array.isArray(n))for(var a=0;a<n.length;a++)wt(t,n[a],e,i,r);else i=l(i)?!!i.capture:!!i,e=Ot(e),t&&t[ot]?(t=t.c,(n=String(n).toString())in t.a&&(-1<(e=pt(a=t.a[n],e,i,r))&&(ct(a[e]),Array.prototype.splice.call(a,e,1),0==a.length&&(delete t.a[n],t.b--)))):t&&(t=It(t))&&(n=t.a[n.toString()],t=-1,n&&(t=pt(n,e,i,r)),(e=-1<t?n[t]:null)&&Et(e))}function Et(t){if("number"!=typeof t&&t&&!t.V){var n=t.src;if(n&&n[ot])ft(n.c,t);else{var e=t.type,i=t.proxy;n.removeEventListener?n.removeEventListener(e,i,t.capture):n.detachEvent?n.detachEvent(Tt(e),i):n.addListener&&n.removeListener&&n.removeListener(i),(e=It(n))?(ft(e,t),0==e.b&&(e.src=null,n[vt]=null)):ct(t)}}}function Tt(t){return t in dt?dt[t]:dt[t]="on"+t}function Ct(t,n){var e=t.listener,i=t.aa||t.src;return t.X&&Et(t),e.call(i,n)}function St(t,n){if(t.V)return!0;if(!nt){if(!n)t:{n=["window","event"];for(var e=a,i=0;i<n.length;i++)if(null==(e=e[n[i]])){n=null;break t}n=e}return Ct(t,n=new at(n,this))}return Ct(t,new at(n,this))}function It(t){return(t=t[vt])instanceof ut?t:null}var xt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ot(t){return"function"==o(t)?t:(t[xt]||(t[xt]=function(n){return t.handleEvent(n)}),t[xt])}function jt(){m.call(this),this.c=new ut(this),this.J=this,this.A=null}function At(t,n,e,i){if(!(n=t.c.a[String(n)]))return!0;n=n.concat();for(var r=!0,a=0;a<n.length;++a){var s=n[a];if(s&&!s.V&&s.capture==e){var o=s.listener,h=s.aa||s.src;s.X&&ft(t.c,s),r=!1!==o.call(h,i)&&r}}return r&&!i.defaultPrevented}b(jt,m),jt.prototype[ot]=!0,(e=jt.prototype).addEventListener=function(t,n,e,i){gt(this,t,n,e,i)},e.removeEventListener=function(t,n,e,i){wt(this,t,n,e,i)},e.dispatchEvent=function(t){var n,e=this.A;if(e)for(n=[];e;e=e.A)n.push(e);e=this.J;var i=t.type||t;if("string"==typeof t)t=new rt(t,e);else if(t instanceof rt)t.target=t.target||e;else{var r=t;X(t=new rt(i,e),r)}if(r=!0,n)for(var a=n.length-1;0<=a;a--){var s=t.a=n[a];r=At(s,i,!0,t)&&r}if(r=At(s=t.a=e,i,!0,t)&&r,r=At(s,i,!1,t)&&r,n)for(a=0;a<n.length;a++)r=At(s=t.a=n[a],i,!1,t)&&r;return r},e.C=function(){if(jt.M.C.call(this),this.c){var t,n=this.c;for(t in n.a){for(var e=n.a[t],i=0;i<e.length;i++)ct(e[i]);delete n.a[t],n.b--}}this.A=null},e.ra=function(t,n,e,i){return this.c.add(String(t),n,!1,e,i)},e.sa=function(t,n,e,i){return this.c.add(String(t),n,!0,e,i)};var Pt=a.JSON.stringify;function Rt(){this.b=this.a=null}var Lt,Mt=new(function(){function t(t,n,e){this.f=e,this.c=t,this.g=n,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())(function(){return new Dt},function(t){t.reset()},100);function kt(){var t=Ut,n=null;return t.a&&(n=t.a,t.a=t.a.next,t.a||(t.b=null),n.next=null),n}function Dt(){this.next=this.b=this.a=null}function Xt(t){a.setTimeout(function(){throw t},0)}function _t(t,n){Lt||Ht(),Nt||(Lt(),Nt=!0),Ut.add(t,n)}function Ht(){var t=a.Promise.resolve(void 0);Lt=function(){t.then(Kt)}}Rt.prototype.add=function(t,n){var e=Mt.get();e.set(t,n),this.b?this.b.next=e:this.a=e,this.b=e},Dt.prototype.set=function(t,n){this.a=t,this.b=n,this.next=null},Dt.prototype.reset=function(){this.next=this.b=this.a=null};var Nt=!1,Ut=new Rt;function Kt(){for(var t;t=kt();){try{t.a.call(t.b)}catch(e){Xt(e)}var n=Mt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Nt=!1}function Ft(t,n){jt.call(this),this.b=t||1,this.a=n||a,this.f=d(this.Ua,this),this.g=y()}function Wt(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function Yt(t,n,e){if("function"==o(t))e&&(t=d(t,e));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=d(t.handleEvent,t)}return 2147483647<Number(n)?-1:a.setTimeout(t,n||0)}function Bt(t,n,e){m.call(this),this.f=null!=e?d(t,e):t,this.c=n,this.b=d(this.Pa,this),this.a=[]}function Gt(t){t.T=Yt(t.b,t.c),t.f.apply(null,t.a)}function Jt(t){m.call(this),this.b=t,this.a={}}b(Ft,jt),(e=Ft.prototype).Z=!1,e.L=null,e.Ua=function(){if(this.Z){var t=y()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(Wt(this),this.start()))}},e.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=y())},e.C=function(){Ft.M.C.call(this),Wt(this),delete this.a},b(Bt,m),(e=Bt.prototype).ba=!1,e.T=null,e.Ia=function(t){this.a=arguments,this.T?this.ba=!0:Gt(this)},e.C=function(){Bt.M.C.call(this),this.T&&(a.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},e.Pa=function(){this.T=null,this.ba&&(this.ba=!1,Gt(this))},b(Jt,m);var $t=[];function qt(t,n,e,i){Array.isArray(e)||(e&&($t[0]=e.toString()),e=$t);for(var r=0;r<e.length;r++){var a=gt(n,e[r],i||t.handleEvent,!1,t.b||t);if(!a)break;t.a[a.key]=a}}function Vt(t){M(t.a,function(t,n){this.a.hasOwnProperty(n)&&Et(t)},t),t.a={}}function zt(){}Jt.prototype.C=function(){Jt.M.C.call(this),Vt(this)},Jt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Zt=null;function Qt(){return Zt=Zt||new jt}function tn(t){rt.call(this,"serverreachability",t)}function nn(t){var n=Qt();n.dispatchEvent(new tn(n,t))}function en(t){rt.call(this,"statevent",t)}function rn(t){var n=Qt();n.dispatchEvent(new en(n,t))}function an(t){rt.call(this,"timingevent",t)}function sn(t,n){if("function"!=o(t))throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){t()},n)}b(tn,rt),b(en,rt),b(an,rt);var on={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},hn={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function ln(){}function cn(t){var n;return(n=t.a)||(n=t.a={}),n}function un(){}ln.prototype.a=null;var fn,pn={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function vn(){rt.call(this,"d")}function dn(){rt.call(this,"c")}function gn(){}function yn(t,n,e){this.g=t,this.W=n,this.U=e||1,this.G=new Jt(this),this.N=bn,t=W?125:void 0,this.O=new Ft(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}b(vn,rt),b(dn,rt),b(gn,ln),fn=new gn;var bn=45e3,mn={},wn={};function En(t,n,e){t.B=1,t.f=Bn(Nn(n)),t.j=e,t.F=!0,Tn(t,null)}function Tn(t,n){t.s=y(),In(t),t.A=Nn(t.f);var e=t.A,i=t.U;Array.isArray(i)||(i=[String(i)]),se(e.b,"t",i),t.w=0,t.a=ei(t.g,t.g.w?n:null),0<t.J&&(t.D=new Bt(d(t.ya,t,t.a),t.J)),qt(t.G,t.a,"readystatechange",t.Sa),n=t.m?k(t.m):{},t.j?(t.v||(t.v="POST"),n["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,n)):(t.v="GET",t.a.$(t.A,t.v,null,n)),nn(1)}function Cn(t,n,e){for(var i=!0;!t.l&&t.w<e.length;){var r=Sn(t,e);if(r==wn){4==n&&(t.c=4,rn(14),i=!1);break}if(r==mn){t.c=4,rn(15),i=!1;break}Pn(t,r)}4==n&&0==e.length&&(t.c=1,rn(16),i=!1),t.b=t.b&&i,i||(An(t),jn(t))}function Sn(t,n){var e=t.w,i=n.indexOf("\n",e);return-1==i?wn:(e=Number(n.substring(e,i)),isNaN(e)?mn:(i+=1)+e>n.length?wn:(n=n.substr(i,e),t.w=i+e,n))}function In(t){t.P=y()+t.N,xn(t,t.N)}function xn(t,n){if(null!=t.h)throw Error("WatchDog timer not null");t.h=sn(d(t.Qa,t),n)}function On(t){t.h&&(a.clearTimeout(t.h),t.h=null)}function jn(t){0==t.g.u||t.l||ze(t.g,t)}function An(t){On(t);var n=t.D;n&&"function"==typeof n.da&&n.da(),t.D=null,Wt(t.O),Vt(t.G),t.a&&(n=t.a,t.a=null,n.abort(),n.da())}function Pn(t,n){try{var e=t.g;if(0!=e.u&&(e.a==t||ve(e.b,t)))if(e.A=t.H,!t.o&&ve(e.b,t)&&3==e.u){try{var i=e.ja.a.parse(n)}catch(g){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!e.i){if(e.a){if(!(e.a.s+3e3<t.s))break t;Ve(e),e.a.cancel(),e.a=null}qe(e),rn(18)}}else e.ia=r[1],0<e.ia-e.G&&37500>r[2]&&e.U&&0==e.m&&!e.l&&(e.l=sn(d(e.Na,e),6e3));if(1>=pe(e.b)&&e.O){try{e.O()}catch(g){}e.O=void 0}}else Qe(e,11)}else if((t.o||e.a==t)&&Ve(e),!x(n))for(n=i=e.ja.a.parse(n),i=0;i<n.length;i++)if(r=n[i],e.G=r[0],r=r[1],2==e.u)if("c"==r[0]){e.B=r[1],e.R=r[2];var a=r[3];null!=a&&(e.oa=a);var s=r[5];null!=s&&"number"==typeof s&&0<s&&(e.D=1.5*s);var o=e,h=t.a;if(h){var l=h.a?h.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var c=o.b;!c.a&&(A(l,"spdy")||A(l,"quic")||A(l,"h2"))&&(c.f=c.g,c.a=new Set,c.b&&(de(c,c.b),c.b=null))}if(o.s){var u=h.a?h.a.getResponseHeader("X-HTTP-Session-Id"):null;u&&(o.ha=u,Yn(o.v,o.s,u))}}e.u=3,e.c&&e.c.na();var f=t;if((o=e).ea=ni(o,o.w?o.R:null,o.P),f.o){ge(o.b,f);var p=f,v=o.D;v&&p.setTimeout(v),p.h&&(On(p),In(p)),o.a=f}else $e(o);0<e.f.length&&We(e)}else"stop"!=r[0]&&"close"!=r[0]||Qe(e,7);else 3==e.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?Qe(e,7):Ue(e):"noop"!=r[0]&&e.c&&e.c.ma(r),e.m=0);nn(4)}catch(g){}}function Rn(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(h(t)){for(var n=[],e=t.length,i=0;i<e;i++)n.push(t[i]);return n}for(i in n=[],e=0,t)n[e++]=t[i];return n}function Ln(t,n){if(t.forEach&&"function"==typeof t.forEach)t.forEach(n,void 0);else if(h(t)||"string"==typeof t)T(t,n,void 0);else{if(t.K&&"function"==typeof t.K)var e=t.K();else if(t.I&&"function"==typeof t.I)e=void 0;else if(h(t)||"string"==typeof t){e=[];for(var i=t.length,r=0;r<i;r++)e.push(r)}else for(r in e=[],i=0,t)e[i++]=r;r=(i=Rn(t)).length;for(var a=0;a<r;a++)n.call(void 0,i[a],e&&e[a],t)}}function Mn(t,n){this.b={},this.a=[],this.c=0;var e=arguments.length;if(1<e){if(e%2)throw Error("Uneven number of arguments");for(var i=0;i<e;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Mn)for(e=t.K(),i=0;i<e.length;i++)this.set(e[i],t.get(e[i]));else for(i in t)this.set(i,t[i])}function kn(t){if(t.c!=t.a.length){for(var n=0,e=0;n<t.a.length;){var i=t.a[n];Dn(t.b,i)&&(t.a[e++]=i),n++}t.a.length=e}if(t.c!=t.a.length){var r={};for(e=n=0;n<t.a.length;)Dn(r,i=t.a[n])||(t.a[e++]=i,r[i]=1),n++;t.a.length=e}}function Dn(t,n){return Object.prototype.hasOwnProperty.call(t,n)}(e=yn.prototype).setTimeout=function(t){this.N=t},e.Sa=function(t){t=t.target;var n=this.D;n&&3==De(t)?n.Ia():this.ya(t)},e.ya=function(t){try{if(t==this.a)t:{var n=De(this.a),e=this.a.qa(),i=this.a.S();if(!(3>n||3==n&&!W&&!this.a.Y())){this.l||4!=n||7==e||nn(8==e||0>=i?3:2),On(this);var r=this.a.S();this.H=r;var a=this.a.Y();if(this.b=200==r){if(this.R&&!this.o){n:{if(this.a){var s,o=this.a;if((s=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(s)){var h=s;break n}}h=null}if(!h){this.b=!1,this.c=3,rn(12),An(this),jn(this);break t}this.o=!0,Pn(this,h)}this.F?(Cn(this,n,a),W&&this.b&&3==n&&(qt(this.G,this.O,"tick",this.Ra),this.O.start())):Pn(this,a),4==n&&An(this),this.b&&!this.l&&(4==n?ze(this.g,this):(this.b=!1,In(this)))}else 400==r&&0<a.indexOf("Unknown SID")?(this.c=3,rn(12)):(this.c=0,rn(13)),An(this),jn(this)}}}catch(l){}},e.Ra=function(){if(this.a){var t=De(this.a),n=this.a.Y();this.w<n.length&&(On(this),Cn(this,t,n),this.b&&4!=t&&In(this))}},e.cancel=function(){this.l=!0,An(this)},e.Qa=function(){this.h=null;var t=y();0<=t-this.P?(2!=this.B&&(nn(3),rn(17)),An(this),this.c=2,jn(this)):xn(this,this.P-t)},(e=Mn.prototype).I=function(){kn(this);for(var t=[],n=0;n<this.a.length;n++)t.push(this.b[this.a[n]]);return t},e.K=function(){return kn(this),this.a.concat()},e.get=function(t,n){return Dn(this.b,t)?this.b[t]:n},e.set=function(t,n){Dn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=n},e.forEach=function(t,n){for(var e=this.K(),i=0;i<e.length;i++){var r=e[i],a=this.get(r);t.call(n,a,r,this)}};var Xn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function _n(t,n){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var i=t[e].indexOf("="),r=null;if(0<=i){var a=t[e].substring(0,i);r=t[e].substring(i+1)}else a=t[e];n(a,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function Hn(t,n){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Hn){this.a=void 0!==n?n:t.a,Un(this,t.f),this.j=t.j,Kn(this,t.c),Fn(this,t.h),this.g=t.g,n=t.b;var e=new ee;e.c=n.c,n.a&&(e.a=new Mn(n.a),e.b=n.b),Wn(this,e),this.i=t.i}else t&&(e=String(t).match(Xn))?(this.a=!!n,Un(this,e[1]||"",!0),this.j=$n(e[2]||""),Kn(this,e[3]||"",!0),Fn(this,e[4]),this.g=$n(e[5]||"",!0),Wn(this,e[6]||"",!0),this.i=$n(e[7]||"")):(this.a=!!n,this.b=new ee(null,this.a))}function Nn(t){return new Hn(t)}function Un(t,n,e){t.f=e?$n(n,!0):n,t.f&&(t.f=t.f.replace(/:$/,""))}function Kn(t,n,e){t.c=e?$n(n,!0):n}function Fn(t,n){if(n){if(n=Number(n),isNaN(n)||0>n)throw Error("Bad port number "+n);t.h=n}else t.h=null}function Wn(t,n,e){n instanceof ee?(t.b=n,he(t.b,t.a)):(e||(n=qn(n,te)),t.b=new ee(n,t.a))}function Yn(t,n,e){t.b.set(n,e)}function Bn(t){return Yn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^y()).toString(36)),t}function Gn(t){return t instanceof Hn?Nn(t):new Hn(t,void 0)}function Jn(t,n,e,i){var r=new Hn(null,void 0);return t&&Un(r,t),n&&Kn(r,n),e&&Fn(r,e),i&&(r.g=i),r}function $n(t,n){return t?n?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function qn(t,n,e){return"string"==typeof t?(t=encodeURI(t).replace(n,Vn),e&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Vn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Hn.prototype.toString=function(){var t=[],n=this.f;n&&t.push(qn(n,zn,!0),":");var e=this.c;return(e||"file"==n)&&(t.push("//"),(n=this.j)&&t.push(qn(n,zn,!0),"@"),t.push(encodeURIComponent(String(e)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(e=this.h)&&t.push(":",String(e))),(e=this.g)&&(this.c&&"/"!=e.charAt(0)&&t.push("/"),t.push(qn(e,"/"==e.charAt(0)?Qn:Zn,!0))),(e=this.b.toString())&&t.push("?",e),(e=this.i)&&t.push("#",qn(e,ne)),t.join("")};var zn=/[#\/\?@]/g,Zn=/[#\?:]/g,Qn=/[#\?]/g,te=/[#\?@]/g,ne=/#/g;function ee(t,n){this.b=this.a=null,this.c=t||null,this.f=!!n}function ie(t){t.a||(t.a=new Mn,t.b=0,t.c&&_n(t.c,function(n,e){t.add(decodeURIComponent(n.replace(/\+/g," ")),e)}))}function re(t,n){ie(t),n=oe(t,n),Dn(t.a.b,n)&&(t.c=null,t.b-=t.a.get(n).length,Dn((t=t.a).b,n)&&(delete t.b[n],t.c--,t.a.length>2*t.c&&kn(t)))}function ae(t,n){return ie(t),n=oe(t,n),Dn(t.a.b,n)}function se(t,n,e){re(t,n),0<e.length&&(t.c=null,t.a.set(oe(t,n),I(e)),t.b+=e.length)}function oe(t,n){return n=String(n),t.f&&(n=n.toLowerCase()),n}function he(t,n){n&&!t.f&&(ie(t),t.c=null,t.a.forEach(function(t,n){var e=n.toLowerCase();n!=e&&(re(this,n),se(this,e,t))},t)),t.f=n}function le(t,n){this.b=t,this.a=n}function ce(t){this.g=t||ue,a.PerformanceNavigationTiming?t=0<(t=a.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(a.ca&&a.ca.ua&&a.ca.ua()&&a.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(e=ee.prototype).add=function(t,n){ie(this),this.c=null,t=oe(this,t);var e=this.a.get(t);return e||this.a.set(t,e=[]),e.push(n),this.b+=1,this},e.forEach=function(t,n){ie(this),this.a.forEach(function(e,i){T(e,function(e){t.call(n,e,i,this)},this)},this)},e.K=function(){ie(this);for(var t=this.a.I(),n=this.a.K(),e=[],i=0;i<n.length;i++)for(var r=t[i],a=0;a<r.length;a++)e.push(n[i]);return e},e.I=function(t){ie(this);var n=[];if("string"==typeof t)ae(this,t)&&(n=S(n,this.a.get(oe(this,t))));else{t=this.a.I();for(var e=0;e<t.length;e++)n=S(n,t[e])}return n},e.set=function(t,n){return ie(this),this.c=null,ae(this,t=oe(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[n]),this.b+=1,this},e.get=function(t,n){return t&&0<(t=this.I(t)).length?String(t[0]):n},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],n=this.a.K(),e=0;e<n.length;e++){var i=n[e],r=encodeURIComponent(String(i));i=this.I(i);for(var a=0;a<i.length;a++){var s=r;""!==i[a]&&(s+="="+encodeURIComponent(String(i[a]))),t.push(s)}}return this.c=t.join("&")};var ue=10;function fe(t){return!!t.b||!!t.a&&t.a.size>=t.f}function pe(t){return t.b?1:t.a?t.a.size:0}function ve(t,n){return t.b?t.b==n:!!t.a&&t.a.has(n)}function de(t,n){t.a?t.a.add(n):t.b=n}function ge(t,n){t.b&&t.b==n?t.b=null:t.a&&t.a.has(n)&&t.a.delete(n)}function ye(t){var e,i;if(null!=t.b)return t.c.concat(t.b.i);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var a=n(t.a.values()),s=a.next();!s.done;s=a.next()){var o=s.value;r=r.concat(o.i)}}catch(h){e={error:h}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}return r}return I(t.c)}function be(){}function me(){this.a=new be}function we(t,n,e){var i=e||"";try{Ln(t,function(t,e){var r=t;l(t)&&(r=Pt(t)),n.push(i+e+"="+encodeURIComponent(r))})}catch(r){throw n.push(i+"type="+encodeURIComponent("_badmap")),r}}function Ee(t,n){var e=new zt;if(a.Image){var i=new Image;i.onload=g(Te,e,i,"TestLoadImage: loaded",!0,n),i.onerror=g(Te,e,i,"TestLoadImage: error",!1,n),i.onabort=g(Te,e,i,"TestLoadImage: abort",!1,n),i.ontimeout=g(Te,e,i,"TestLoadImage: timeout",!1,n),a.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else n(!1)}function Te(t,n,e,i,r){try{n.onload=null,n.onerror=null,n.onabort=null,n.ontimeout=null,r(i)}catch(a){}}ce.prototype.cancel=function(){var t,e;if(this.c=ye(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var i=n(this.a.values()),r=i.next();!r.done;r=i.next()){r.value.cancel()}}catch(a){t={error:a}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.a.clear()}},be.prototype.stringify=function(t){return a.JSON.stringify(t,void 0)},be.prototype.parse=function(t){return a.JSON.parse(t,void 0)};var Ce=a.JSON.parse;function Se(t){jt.call(this),this.headers=new Mn,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=Ie,this.B=this.F=!1}b(Se,jt);var Ie="",xe=/^https?$/i,Oe=["POST","PUT"];function je(t){return K&&Z(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function Ae(t){return"content-type"==t.toLowerCase()}function Pe(t,n){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=n,t.h=5,Re(t),Me(t)}function Re(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Le(t){if(t.b&&void 0!==r&&(!t.s[1]||4!=De(t)||2!=t.S()))if(t.l&&4==De(t))Yt(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==De(t)){t.b=!1;try{var n,e=t.S();t:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(n=i)){var s;if(s=0===e){var o=String(t.D).match(Xn)[1]||null;if(!o&&a.self&&a.self.location){var h=a.self.location.protocol;o=h.substr(0,h.length-1)}s=!xe.test(o?o.toLowerCase():"")}n=s}if(n)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var l=2<De(t)?t.a.statusText:""}catch(c){l=""}t.f=l+" ["+t.S()+"]",Re(t)}}finally{Me(t)}}}function Me(t,n){if(t.a){ke(t);var e=t.a,i=t.s[0]?s:null;t.a=null,t.s=null,n||t.dispatchEvent("ready");try{e.onreadystatechange=i}catch(r){}}}function ke(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(a.clearTimeout(t.m),t.m=null)}function De(t){return t.a?t.a.readyState:0}function Xe(t){var n="";return M(t,function(t,e){n+=e,n+=":",n+=t,n+="\r\n"}),n}function _e(t,n,e){t:{for(i in e){var i=!1;break t}i=!0}i||(e=Xe(e),"string"==typeof t?null!=e&&encodeURIComponent(String(e)):Yn(t,n,e))}function He(t,n,e){return e&&e.internalChannelParams&&e.internalChannelParams[t]||n}function Ne(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=He("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=He("baseRetryDelayMs",5e3,t),this.Ga=He("retryDelaySeedMs",1e4,t),this.Da=He("forwardChannelMaxRetries",2,t),this.ga=He("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new ce(t&&t.concurrentRequestLimit),this.ja=new me,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Ue(t){if(Ke(t),3==t.u){var n=t.H++,e=Nn(t.v);Yn(e,"SID",t.B),Yn(e,"RID",n),Yn(e,"TYPE","terminate"),Ge(t,e),(n=new yn(t,n,void 0)).B=2,n.f=Bn(Nn(e)),e=!1,a.navigator&&a.navigator.sendBeacon&&(e=a.navigator.sendBeacon(n.f.toString(),"")),!e&&a.Image&&((new Image).src=n.f,e=!0),e||(n.a=ei(n.g,null),n.a.$(n.f)),n.s=y(),In(n)}ti(t)}function Ke(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(a.clearTimeout(t.i),t.i=null),Ve(t),t.b.cancel(),t.g&&("number"==typeof t.g&&a.clearTimeout(t.g),t.g=null)}function Fe(t,n){t.f.push(new le(t.Fa++,n)),3==t.u&&We(t)}function We(t){fe(t.b)||t.g||(t.g=!0,_t(t.xa,t),t.o=0)}function Ye(t,n){return!(pe(t.b)>=t.b.f-(t.g?1:0))&&(t.g?(t.f=n.i.concat(t.f),!0):!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da))&&(t.g=sn(d(t.xa,t,n),Ze(t,t.o)),t.o++,!0))}function Be(t,n){var e;e=n?n.W:t.H++;var i=Nn(t.v);Yn(i,"SID",t.B),Yn(i,"RID",e),Yn(i,"AID",t.G),Ge(t,i),t.h&&t.j&&_e(i,t.h,t.j),e=new yn(t,e,t.o+1),null===t.h&&(e.m=t.j),n&&(t.f=n.i.concat(t.f)),n=Je(t,e,1e3),e.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),de(t.b,e),En(e,i,n)}function Ge(t,n){t.c&&Ln({},function(t,e){Yn(n,e,t)})}function Je(t,n,e){e=Math.min(t.f.length,e);var i=t.c?d(t.c.Ha,t.c,t):null;t:for(var r=t.f,a=-1;;){var s=["count="+e];-1==a?0<e?(a=r[0].b,s.push("ofs="+a)):a=0:s.push("ofs="+a);for(var o=!0,h=0;h<e;h++){var l=r[h].b,c=r[h].a;if(0>(l-=a))a=Math.max(0,r[h].b-100),o=!1;else try{we(c,s,"req"+l+"_")}catch(u){i&&i(c)}}if(o){i=s.join("&");break t}}return t=t.f.splice(0,e),n.i=t,i}function $e(t){t.a||t.i||(t.J=1,_t(t.wa,t),t.m=0)}function qe(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=sn(d(t.wa,t),Ze(t,t.m)),t.m++,!0)}function Ve(t){null!=t.l&&(a.clearTimeout(t.l),t.l=null)}function ze(t,n){var e=null;if(t.a==n){Ve(t),t.a=null;var i=2}else{if(!ve(t.b,n))return;e=n.i,ge(t.b,n),i=1}if(t.A=n.H,0!=t.u)if(n.b)if(1==i){e=n.j?n.j.length:0,n=y()-n.s;var r=t.o;(i=Qt()).dispatchEvent(new an(i,e,n,r)),We(t)}else $e(t);else if(3==(r=n.c)||0==r&&0<t.A||!(1==i&&Ye(t,n)||2==i&&qe(t)))switch(e&&0<e.length&&(n=t.b,n.c=n.c.concat(e)),r){case 1:Qe(t,5);break;case 4:Qe(t,10);break;case 3:Qe(t,6);break;default:Qe(t,2)}}function Ze(t,n){var e=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(e*=2),e*n}function Qe(t,n){if(2==n){var e=null;t.c&&(e=null);var i=d(t.Ta,t);e||(e=new Hn("//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||Un(e,"https"),Bn(e)),Ee(e.toString(),i)}else rn(2);t.u=0,t.c&&t.c.la(n),ti(t),Ke(t)}function ti(t){t.u=0,t.A=-1,t.c&&(0==ye(t.b).length&&0==t.f.length||(t.b.c.length=0,I(t.f),t.f.length=0),t.c.ka())}function ni(t,n,e){var i=Gn(e);if(""!=i.c)n&&Kn(i,n+"."+i.c),Fn(i,i.h);else{var r=a.location;i=Jn(r.protocol,n?n+"."+r.hostname:r.hostname,+r.port,e)}return t.N&&M(t.N,function(t,n){Yn(i,n,t)}),n=t.s,e=t.ha,n&&e&&Yn(i,n,e),Yn(i,"VER",t.oa),Ge(t,i),i}function ei(t,n){if(n&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(n=new Se(t.Ea)).F=t.w,n}function ii(){}function ri(){if(K&&!(10<=Number(tt)))throw Error("Environmental error: no available transport.")}function ai(t,n){jt.call(this),this.a=new Ne(n),this.l=t,this.b=n&&n.messageUrlParams||null,t=n&&n.messageHeaders||null,n&&n.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=n&&n.initMessageHeaders||null,n&&n.messageContentType&&(t?t["X-WebChannel-Content-Type"]=n.messageContentType:t={"X-WebChannel-Content-Type":n.messageContentType}),n&&n.pa&&(t?t["X-WebChannel-Client-Profile"]=n.pa:t={"X-WebChannel-Client-Profile":n.pa}),this.a.F=t,(t=n&&n.httpHeadersOverwriteParam)&&!x(t)&&(this.a.h=t),this.h=n&&n.supportsCrossDomainXhr||!1,this.g=n&&n.sendRawJson||!1,(n=n&&n.httpSessionIdParam)&&!x(n)&&(this.a.s=n,null!==(t=this.b)&&n in t&&(n in(t=this.b)&&delete t[n])),this.f=new hi(this)}function si(t){vn.call(this);var n=t.__sm__;if(n){t:{for(var e in n){t=e;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==n&&t in n?n[t]:void 0):this.data=n}else this.data=t}function oi(){dn.call(this),this.status=1}function hi(t){this.a=t}(e=Se.prototype).$=function(t,n,e,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);n=n?n.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?cn(this.G):cn(fn),this.a.onreadystatechange=d(this.va,this);try{this.w=!0,this.a.open(n,String(t),!0),this.w=!1}catch(s){return void Pe(this,s)}t=e||"";var r=new Mn(this.headers);i&&Ln(i,function(t,n){r.set(n,t)}),i=C(r.K()),e=a.FormData&&t instanceof a.FormData,!(0<=E(Oe,n))||i||e||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach(function(t,n){this.a.setRequestHeader(n,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{ke(this),0<this.o&&((this.B=je(this.a))?(this.a.timeout=this.o,this.a.ontimeout=d(this.ta,this)):this.m=Yt(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(s){Pe(this,s)}},e.ta=function(){void 0!==r&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Me(this))},e.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Me(this,!0)),Se.M.C.call(this)},e.va=function(){this.j||(this.w||this.l||this.g?Le(this):this.Oa())},e.Oa=function(){Le(this)},e.S=function(){try{return 2<De(this)?this.a.status:-1}catch(t){return-1}},e.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},e.Ja=function(t){if(this.a){var n=this.a.responseText;return t&&0==n.indexOf(t)&&(n=n.substring(t.length)),Ce(n)}},e.qa=function(){return this.h},e.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(e=Ne.prototype).oa=8,e.u=1,e.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random());var n,e=new yn(this,t=this.H++,void 0),i=this.j;if(this.F&&(i?X(i=k(i),this.F):i=this.F),null===this.h&&(e.m=i),this.fa)t:{for(var r=n=0;r<this.f.length;r++){var a=this.f[r];if(void 0===(a="__data__"in a.a&&"string"==typeof(a=a.a.__data__)?a.length:void 0))break;if(4096<(n+=a)){n=r;break t}if(4096===n||r===this.f.length-1){n=r+1;break t}}n=1e3}else n=1e3;n=Je(this,e,n),Yn(r=Nn(this.v),"RID",t),Yn(r,"CVER",22),this.s&&Yn(r,"X-HTTP-Session-Id",this.s),Ge(this,r),this.h&&i&&_e(r,this.h,i),de(this.b,e),this.fa?(Yn(r,"$req",n),Yn(r,"SID","null"),e.R=!0,En(e,r,null)):En(e,r,n),this.u=2}}else 3==this.u&&(t?Be(this,t):0==this.f.length||fe(this.b)||Be(this))},e.wa=function(){this.i=null,this.a=new yn(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Nn(this.ea);Yn(t,"RID","rpc"),Yn(t,"SID",this.B),Yn(t,"CI",this.U?"0":"1"),Yn(t,"AID",this.G),Ge(this,t),Yn(t,"TYPE","xmlhttp"),this.h&&this.j&&_e(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var n=this.a,e=this.R;n.B=1,n.f=Bn(Nn(t)),n.j=null,n.F=!0,Tn(n,e)},e.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,qe(this),rn(19))},e.Ta=function(t){rn(t?2:1)},(e=ii.prototype).na=function(){},e.ma=function(){},e.la=function(){},e.ka=function(){},e.Ha=function(){},ri.prototype.a=function(t,n){return new ai(t,n)},b(ai,jt),(e=ai.prototype).addEventListener=function(t,n,e,i){ai.M.addEventListener.call(this,t,n,e,i)},e.removeEventListener=function(t,n,e,i){ai.M.removeEventListener.call(this,t,n,e,i)},e.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,n=this.l,e=this.b||void 0;rn(0),t.P=n,t.N=e||{},t.U=t.W,t.v=ni(t,null,t.P),We(t)},e.close=function(){Ue(this.a)},e.La=function(t){if("string"==typeof t){var n={};n.__data__=t,Fe(this.a,n)}else this.g?((n={}).__data__=Pt(t),Fe(this.a,n)):Fe(this.a,t)},e.C=function(){this.a.c=null,delete this.f,Ue(this.a),delete this.a,ai.M.C.call(this)},b(si,vn),b(oi,dn),b(hi,ii),hi.prototype.na=function(){this.a.dispatchEvent("a")},hi.prototype.ma=function(t){this.a.dispatchEvent(new si(t))},hi.prototype.la=function(t){this.a.dispatchEvent(new oi(t))},hi.prototype.ka=function(){this.a.dispatchEvent("b")},ri.prototype.createWebChannel=ri.prototype.a,ai.prototype.send=ai.prototype.La,ai.prototype.open=ai.prototype.Ka,ai.prototype.close=ai.prototype.close,on.NO_ERROR=0,on.TIMEOUT=8,on.HTTP_ERROR=6,hn.COMPLETE="complete",un.EventType=pn,pn.OPEN="a",pn.CLOSE="b",pn.ERROR="c",pn.MESSAGE="d",jt.prototype.listen=jt.prototype.ra,Se.prototype.listenOnce=Se.prototype.sa,Se.prototype.getLastError=Se.prototype.Ma,Se.prototype.getLastErrorCode=Se.prototype.qa,Se.prototype.getStatus=Se.prototype.S,Se.prototype.getResponseJson=Se.prototype.Ja,Se.prototype.getResponseText=Se.prototype.Y,Se.prototype.send=Se.prototype.$;var li={createWebChannelTransport:function(){return new ri},ErrorCode:on,EventType:hn,WebChannel:un,XhrIo:Se},ci=li.createWebChannelTransport;exports.createWebChannelTransport=ci;var ui=li.ErrorCode;exports.ErrorCode=ui;var fi=li.EventType;exports.EventType=fi;var pi=li.WebChannel;exports.WebChannel=pi;var vi=li.XhrIo;exports.XhrIo=vi;var di=li;exports.default=di;
},{}],"NkAH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t,e=require("tslib"),n=(t=require("@firebase/app"))&&"object"==typeof t&&"default"in t?t.default:t,r=require("@firebase/logger"),i=require("@firebase/util"),o=require("@firebase/component"),s=require("@firebase/webchannel-wrapper"),u=n.SDK_VERSION,a=function(){function t(t){this.uid=t}return t.prototype.t=function(){return null!=this.uid},t.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();a.UNAUTHENTICATED=new a(null),a.i=new a("google-credentials-uid"),a.h=new a("first-party-uid");var h={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},c=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return e.__extends(n,t),n}(Error),f=function(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t},l=function(){function t(){this.u=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype._=function(){},t.prototype.l=function(t){this.u=t,t(a.UNAUTHENTICATED)},t.prototype.T=function(){this.u=null},t}(),p=function(){function t(t){var e=this;this.I=null,this.currentUser=a.UNAUTHENTICATED,this.R=!1,this.A=0,this.u=null,this.forceRefresh=!1,this.I=function(){e.A++,e.currentUser=e.m(),e.R=!0,e.u&&e.u(e.currentUser)},this.A=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.I):(this.I(null),t.get().then(function(t){e.auth=t,e.I&&e.auth.addAuthTokenListener(e.I)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.A,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){if(t.A!==e)throw new c(h.ABORTED,"getToken aborted due to token change.");return n?(me("string"==typeof n.accessToken),new f(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype._=function(){this.forceRefresh=!0},t.prototype.l=function(t){this.u=t,this.R&&t(this.currentUser)},t.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.I),this.I=null,this.u=null},t.prototype.m=function(){var t=this.auth&&this.auth.getUid();return me(null===t||"string"==typeof t),new a(t)},t}(),d=function(){function t(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=a.h}return Object.defineProperty(t.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.g([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),t}(),y=function(){function t(t,e){this.P=t,this.V=e}return t.prototype.getToken=function(){return Promise.resolve(new d(this.P,this.V))},t.prototype.l=function(t){t(a.h)},t.prototype.T=function(){},t.prototype._=function(){},t}(),v=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new c(h.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new c(h.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new c(h.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new c(h.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.p=function(t){return this.seconds===t.seconds?be(this.nanoseconds,t.nanoseconds):be(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),g=function(){function t(t){this.timestamp=t}return t.v=function(e){return new t(e)},t.min=function(){return new t(new v(0,0))},t.prototype.S=function(t){return this.timestamp.p(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.D=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.C=function(){return this.timestamp},t}(),m=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&ge(),void 0===n?n=t.length-e:n>t.length-e&&ge(),this.segments=t,this.offset=e,this.F=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.F},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.N(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.$(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.k=function(t){return t=void 0===t?1:t,this.$(this.segments,this.offset+t,this.length-t)},t.prototype.L=function(){return this.$(this.segments,this.offset,this.length-1)},t.prototype.M=function(){return this.segments[this.offset]},t.prototype.O=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.B=function(){return 0===this.length},t.prototype.q=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.U=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.W=function(){return this.segments.slice(this.offset,this.limit())},t.N=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),w=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),n.prototype.$=function(t,e,r){return new n(t,e,r)},n.prototype.j=function(){return this.W().join("/")},n.prototype.toString=function(){return this.j()},n.K=function(t){if(t.indexOf("//")>=0)throw new c(h.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new n(t.split("/").filter(function(t){return t.length>0}))},n}(m);w.G=new w([]);var E=/^[_a-zA-Z][_a-zA-Z0-9]*$/,b=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),n.prototype.$=function(t,e,r){return new n(t,e,r)},n.H=function(t){return E.test(t)},n.prototype.j=function(){return this.W().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),n.H(t)||(t="`"+t+"`"),t}).join(".")},n.prototype.toString=function(){return this.j()},n.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},n.J=function(){return new n(["__name__"])},n.X=function(t){for(var e=[],r="",i=0,o=function(){if(0===r.length)throw new c(h.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new c(h.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new c(h.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new c(h.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new n(e)},n}(m);b.G=new b([]);var _=function(){function t(t){this.path=t}return t.Z=function(e){return new t(w.K(e).k(5))},t.prototype.tt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===w.N(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.N=function(t,e){return w.N(t.path,e.path)},t.et=function(t){return t.length%2==0},t.st=function(e){return new t(new w(e.slice()))},t}();function T(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function I(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function N(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}_.EMPTY=new _(new w([]));var A=function(){function t(t){this.it=t}return t.fromBase64String=function(e){return new t(ce.nt().atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return ce.nt().btoa(this.it)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.it)},t.prototype.rt=function(){return 2*this.it.length},t.prototype.S=function(t){return be(this.it,t.it)},t.prototype.isEqual=function(t){return this.it===t.it},t}();function k(t){return null==t}function D(t){return-0===t&&1/t==-1/0}function x(t){return"number"==typeof t&&Number.isInteger(t)&&!D(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function S(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function R(t){var e=M(t.mapValue.fields.__local_write_time__.timestampValue);return new v(e.seconds,e.nanos)}A.ht=new A("");var L=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function O(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?S(t)?4:10:ge()}function V(t,e){var n=O(t);if(n!==O(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return R(t).isEqual(R(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=M(t.timestampValue),r=M(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return F(t.bytesValue).isEqual(F(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return j(t.geoPointValue.latitude)===j(e.geoPointValue.latitude)&&j(t.geoPointValue.longitude)===j(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return j(t.integerValue)===j(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=j(t.doubleValue),r=j(e.doubleValue);return n===r?D(n)===D(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return _e(t.arrayValue.values||[],e.arrayValue.values||[],V);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(T(n)!==T(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!V(n[i],r[i])))return!1;return!0}(t,e);default:return ge()}}function P(t,e){return void 0!==(t.values||[]).find(function(t){return V(t,e)})}function U(t,e){var n=O(t),r=O(e);if(n!==r)return be(n,r);switch(n){case 0:return 0;case 1:return be(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=j(t.integerValue||t.doubleValue),r=j(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return C(t.timestampValue,e.timestampValue);case 4:return C(R(t),R(e));case 5:return be(t.stringValue,e.stringValue);case 6:return function(t,e){var n=F(t),r=F(e);return n.S(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=be(n[i],r[i]);if(0!==o)return o}return be(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=be(j(t.latitude),j(e.latitude));return 0!==n?n:be(j(t.longitude),j(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=U(n[i],r[i]);if(o)return o}return be(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=be(r[s],o[s]);if(0!==u)return u;var a=U(n[r[s]],i[o[s]]);if(0!==a)return a}return be(r.length,o.length)}(t.mapValue,e.mapValue);default:throw ge()}}function C(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return be(t,e);var n=M(t),r=M(e),i=be(n.seconds,r.seconds);return 0!==i?i:be(n.nanos,r.nanos)}function q(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=M(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?F(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,_.Z(r).toString()):"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=t(s)}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):ge();var n,r}(t)}function M(t){if(me(!!t),"string"==typeof t){var e=0,n=L.exec(t);if(me(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:j(t.seconds),nanos:j(t.nanos)}}function j(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function F(t){return"string"==typeof t?A.fromBase64String(t):A.fromUint8Array(t)}function B(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.j()}}function z(t){return!!t&&"integerValue"in t}function G(t){return!!t&&"arrayValue"in t}function W(t){return!!t&&"nullValue"in t}function Q(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function K(t){return!!t&&"mapValue"in t}var Y=function(){function t(){}return t.prototype.ot=function(t,e){return function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(e,t)},t.prototype.at=function(t,e){return e},t.prototype.ut=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t},t}();Y.instance=new Y;var $=function(){function t(t){this.elements=t}return t.prototype.ot=function(t,e){return this.apply(t)},t.prototype.at=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=X(t),n=function(t){e.some(function(e){return V(e,t)})||e.push(t)},r=0,i=this.elements;r<i.length;r++)n(i[r]);return{arrayValue:{values:e}}},t.prototype.ut=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&_e(this.elements,e.elements,V)},t}(),J=function(){function t(t){this.elements=t}return t.prototype.ot=function(t,e){return this.apply(t)},t.prototype.at=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=X(t),n=function(t){e=e.filter(function(e){return!V(e,t)})},r=0,i=this.elements;r<i.length;r++)n(i[r]);return{arrayValue:{values:e}}},t.prototype.ut=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&_e(this.elements,e.elements,V)},t}(),H=function(){function t(t,e){this.serializer=t,this.ct=e}return t.prototype.ot=function(t,e){var n=this.ut(t),r=this.asNumber(n)+this.asNumber(this.ct);return z(n)&&z(this.ct)?this.serializer._t(r):this.serializer.lt(r)},t.prototype.at=function(t,e){return e},t.prototype.ut=function(t){return z(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},t.prototype.isEqual=function(e){return e instanceof t&&V(this.ct,e.ct)},t.prototype.asNumber=function(t){return j(t.integerValue||t.doubleValue)},t}();function X(t){return G(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Z=function(){function t(t){this.fields=t,t.sort(b.N)}return t.prototype.dt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].q(t))return!0;return!1},t.prototype.isEqual=function(t){return _e(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),tt=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),et=function(t,e){this.version=t,this.transformResults=e},nt=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.ft=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Tt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.Et=function(t){return void 0!==this.updateTime?t instanceof yt&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof yt},t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}(),rt=function(){function t(){}return t.prototype.It=function(t){},t.wt=function(t){return t instanceof yt?t.version:g.min()},t}(),it=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Rt=r,i.type=0,i}return e.__extends(n,t),n.prototype.at=function(t,e){this.It(t);var n=e.version;return new yt(this.key,n,this.value,{hasCommittedMutations:!0})},n.prototype.ot=function(t,e,n){if(this.It(t),!this.Rt.Et(t))return t;var r=rt.wt(t);return new yt(this.key,r,this.value,{At:!0})},n.prototype.Pt=function(t){return null},n.prototype.isEqual=function(t){return t instanceof n&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Rt.isEqual(t.Rt)},n}(rt),ot=function(t){function n(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.Vt=r,o.Rt=i,o.type=1,o}return e.__extends(n,t),n.prototype.at=function(t,e){if(this.It(t),!this.Rt.Et(t))return new gt(this.key,e.version);var n=this.gt(t);return new yt(this.key,e.version,n,{hasCommittedMutations:!0})},n.prototype.ot=function(t,e,n){if(this.It(t),!this.Rt.Et(t))return t;var r=rt.wt(t),i=this.gt(t);return new yt(this.key,r,i,{At:!0})},n.prototype.Pt=function(t){return null},n.prototype.isEqual=function(t){return t instanceof n&&this.key.isEqual(t.key)&&this.Vt.isEqual(t.Vt)&&this.Rt.isEqual(t.Rt)},n.prototype.gt=function(t){var e;return e=t instanceof yt?t.data():ht.empty(),this.pt(e)},n.prototype.pt=function(t){var e=this,n=new ct(t);return this.Vt.fields.forEach(function(t){if(!t.B()){var r=e.data.field(t);null!==r?n.set(t,r):n.delete(t)}}),n.yt()},n}(rt),st=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Rt=nt.exists(!0),r}return e.__extends(n,t),n.prototype.at=function(t,e){if(this.It(t),me(null!=e.transformResults),!this.Rt.Et(t))return new gt(this.key,e.version);var n=this.bt(t),r=this.vt(t,e.transformResults),i=e.version,o=this.St(n.data(),r);return new yt(this.key,i,o,{hasCommittedMutations:!0})},n.prototype.ot=function(t,e,n){if(this.It(t),!this.Rt.Et(t))return t;var r=this.bt(t),i=this.Dt(n,t,e),o=this.St(r.data(),i);return new yt(this.key,r.version,o,{At:!0})},n.prototype.Pt=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof yt?t.field(i.field):void 0,s=i.transform.ut(o||null);null!=s&&(e=null==e?(new ct).set(i.field,s):e.set(i.field,s))}return e?e.yt():null},n.prototype.isEqual=function(t){return t instanceof n&&this.key.isEqual(t.key)&&_e(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Rt.isEqual(t.Rt)},n.prototype.bt=function(t){return t},n.prototype.vt=function(t,e){var n=[];me(this.fieldTransforms.length===e.length);for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,s=null;t instanceof yt&&(s=t.field(i.field)),n.push(o.at(s,e[r]))}return n},n.prototype.Dt=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var s=o[i],u=s.transform,a=null;e instanceof yt&&(a=e.field(s.field)),null===a&&n instanceof yt&&(a=n.field(s.field)),r.push(u.ot(a,t))}return r},n.prototype.St=function(t,e){for(var n=new ct(t),r=0;r<this.fieldTransforms.length;r++){var i=this.fieldTransforms[r].field;n.set(i,e[r])}return n.yt()},n}(rt),ut=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Rt=n,r.type=3,r}return e.__extends(n,t),n.prototype.at=function(t,e){return this.It(t),new vt(this.key,e.version,{hasCommittedMutations:!0})},n.prototype.ot=function(t,e,n){return this.It(t),this.Rt.Et(t)?new vt(this.key,g.min()):t},n.prototype.Pt=function(t){return null},n.prototype.isEqual=function(t){return t instanceof n&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},n}(rt),at=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Rt=n,r.type=4,r}return e.__extends(n,t),n.prototype.at=function(t,e){ge()},n.prototype.ot=function(t,e,n){ge()},n.prototype.Pt=function(t){ge()},n.prototype.isEqual=function(t){return t instanceof n&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},n}(rt),ht=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.B())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!K(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.O()])||null},t.prototype.isEqual=function(t){return V(this.proto,t.proto)},t}(),ct=function(){function t(t){void 0===t&&(t=ht.empty()),this.Ct=t,this.Ft=new Map}return t.prototype.set=function(t,e){return this.Nt(t,e),this},t.prototype.delete=function(t){return this.Nt(t,null),this},t.prototype.Nt=function(t,e){for(var n=this.Ft,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===O(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.O(),e)},t.prototype.yt=function(){var t=this.$t(b.G,this.Ft);return null!=t?new ht(t):this.Ct},t.prototype.$t=function(t,e){var n=this,r=!1,i=this.Ct.field(t),o=K(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.$t(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function ft(t){var e=[];return I(t.fields||{},function(t,n){var r=new b([t]);if(K(n)){var i=ft(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var u=s[o];e.push(r.child(u))}}else e.push(r)}),new Z(e)}var lt,pt,dt=function(t,e){this.key=t,this.version=e},yt=function(t){function n(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).kt=r,o.At=!!i.At,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return e.__extends(n,t),n.prototype.field=function(t){return this.kt.field(t)},n.prototype.data=function(){return this.kt},n.prototype.Lt=function(){return this.kt.proto},n.prototype.isEqual=function(t){return t instanceof n&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.At===t.At&&this.hasCommittedMutations===t.hasCommittedMutations&&this.kt.isEqual(t.kt)},n.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.kt.toString()+", {hasLocalMutations: "+this.At+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(n.prototype,"hasPendingWrites",{get:function(){return this.At||this.hasCommittedMutations},enumerable:!0,configurable:!0}),n}(dt),vt=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return e.__extends(n,t),n.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(n.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),n.prototype.isEqual=function(t){return t instanceof n&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},n}(dt),gt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),n.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(n.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),n.prototype.isEqual=function(t){return t instanceof n&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},n}(dt),mt=function(){function t(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Mt=null}return t.prototype.canonicalId=function(){if(null===this.Mt){var t=this.path.j();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),k(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.Mt=t}return this.Mt},t.prototype.toString=function(){var t=this.path.j();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),k(this.limit)||(t+=", limit: "+this.limit),this.orderBy.length>0&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},t.prototype.Ot=function(){return _.et(this.path)&&null===this.collectionGroup&&0===this.filters.length},t}(),wt=function(){function t(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.xt=n,this.filters=r,this.limit=i,this.Bt=o,this.startAt=s,this.endAt=u,this.qt=null,this.Ut=null,this.startAt&&this.Qt(this.startAt),this.endAt&&this.Qt(this.endAt)}return t.Wt=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.qt){this.qt=[];var t=this.jt(),e=this.Kt();if(null!==t&&null===e)t.Y()||this.qt.push(new kt(t)),this.qt.push(new kt(b.J(),"asc"));else{for(var n=!1,r=0,i=this.xt;r<i.length;r++){var o=i[r];this.qt.push(o),o.field.Y()&&(n=!0)}if(!n){var s=this.xt.length>0?this.xt[this.xt.length-1].dir:"asc";this.qt.push(new kt(b.J(),s))}}}return this.qt},enumerable:!0,configurable:!0}),t.prototype.Gt=function(e){var n=this.filters.concat([e]);return new t(this.path,this.collectionGroup,this.xt.slice(),n,this.limit,this.Bt,this.startAt,this.endAt)},t.prototype.zt=function(e){var n=this.xt.concat([e]);return new t(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.Bt,this.startAt,this.endAt)},t.prototype.Ht=function(e){return new t(this.path,this.collectionGroup,this.xt.slice(),this.filters.slice(),e,"F",this.startAt,this.endAt)},t.prototype.Yt=function(e){return new t(this.path,this.collectionGroup,this.xt.slice(),this.filters.slice(),e,"L",this.startAt,this.endAt)},t.prototype.Jt=function(e){return new t(this.path,this.collectionGroup,this.xt.slice(),this.filters.slice(),this.limit,this.Bt,e,this.endAt)},t.prototype.Xt=function(e){return new t(this.path,this.collectionGroup,this.xt.slice(),this.filters.slice(),this.limit,this.Bt,this.startAt,e)},t.prototype.Zt=function(e){return new t(e,null,this.xt.slice(),this.filters.slice(),this.limit,this.Bt,this.startAt,this.endAt)},t.prototype.te=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.xt.length||1===this.xt.length&&this.xt[0].field.Y())},t.prototype.canonicalId=function(){return this.ee().canonicalId()+"|lt:"+this.Bt},t.prototype.toString=function(){return"Query(target="+this.ee().toString()+"; limitType="+this.Bt+")"},t.prototype.isEqual=function(t){return this.ee().isEqual(t.ee())&&this.Bt===t.Bt},t.prototype.se=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},t.prototype.matches=function(t){return this.ie(t)&&this.ne(t)&&this.re(t)&&this.he(t)},t.prototype.oe=function(){return!k(this.limit)&&"F"===this.Bt},t.prototype.ae=function(){return!k(this.limit)&&"L"===this.Bt},t.prototype.Kt=function(){return this.xt.length>0?this.xt[0].field:null},t.prototype.jt=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Et&&n.ue())return n.field}return null},t.prototype.ce=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof Et&&t.indexOf(r.op)>=0)return r.op}return null},t.prototype.Ot=function(){return this.ee().Ot()},t.prototype._e=function(){return null!==this.collectionGroup},t.prototype.ee=function(){if(!this.Ut)if("F"===this.Bt)this.Ut=new mt(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i="desc"===r.dir?"asc":"desc";t.push(new kt(r.field,i))}var o=this.endAt?new At(this.endAt.position,!this.endAt.before):null,s=this.startAt?new At(this.startAt.position,!this.startAt.before):null;this.Ut=new mt(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Ut},t.prototype.ie=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.tt(this.collectionGroup)&&this.path.q(e):_.et(this.path)?this.path.isEqual(e):this.path.U(e)},t.prototype.ne=function(t){for(var e=0,n=this.xt;e<n.length;e++){var r=n[e];if(!r.field.Y()&&null===t.field(r.field))return!1}return!0},t.prototype.re=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},t.prototype.he=function(t){return!(this.startAt&&!this.startAt.le(this.orderBy,t)||this.endAt&&this.endAt.le(this.orderBy,t))},t.prototype.Qt=function(t){},t}(),Et=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return e.__extends(n,t),n.create=function(t,e,r){if(t.Y())return"in"===e?new _t(t,r):new bt(t,e,r);if(W(r)){if("=="!==e)throw new c(h.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new n(t,e,r)}if(Q(r)){if("=="!==e)throw new c(h.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new n(t,e,r)}return"array-contains"===e?new Tt(t,r):"in"===e?new It(t,r):"array-contains-any"===e?new Nt(t,r):new n(t,e,r)},n.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&O(this.value)===O(e)&&this.de(U(e,this.value))},n.prototype.de=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return t>0;case">=":return t>=0;default:return ge()}},n.prototype.ue=function(){return["<","<=",">",">="].indexOf(this.op)>=0},n.prototype.canonicalId=function(){return this.field.j()+this.op.toString()+q(this.value)},n.prototype.isEqual=function(t){return t instanceof n&&this.op===t.op&&this.field.isEqual(t.field)&&V(this.value,t.value)},n.prototype.toString=function(){return this.field.j()+" "+this.op+" "+q(this.value)},n}(function(){}),bt=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=_.Z(r.referenceValue),i}return e.__extends(n,t),n.prototype.matches=function(t){var e=_.N(t.key,this.key);return this.de(e)},n}(Et),_t=function(t){function n(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=(n.arrayValue.values||[]).map(function(t){return _.Z(t.referenceValue)}),r}return e.__extends(n,t),n.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},n}(Et),Tt=function(t){function n(e,n){return t.call(this,e,"array-contains",n)||this}return e.__extends(n,t),n.prototype.matches=function(t){var e=t.field(this.field);return G(e)&&P(e.arrayValue,this.value)},n}(Et),It=function(t){function n(e,n){return t.call(this,e,"in",n)||this}return e.__extends(n,t),n.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&P(this.value.arrayValue,e)},n}(Et),Nt=function(t){function n(e,n){return t.call(this,e,"array-contains-any",n)||this}return e.__extends(n,t),n.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!G(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return P(e.value.arrayValue,t)})},n}(Et),At=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(function(t){return q(t)}).join(",")},t.prototype.le=function(t,e){for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(n=i.field.Y()?_.N(_.Z(o.referenceValue),e.key):U(o,e.field(i.field)),"desc"===i.dir&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!V(this.position[e],t.position[e]))return!1;return!0},t}(),kt=function(){function t(t,e){this.field=t,void 0===e&&(e="asc"),this.dir=e,this.fe=t.Y()}return t.prototype.compare=function(t,e){var n=this.fe?_.N(t.key,e.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?U(r,i):ge()}(this.field,t,e);switch(this.dir){case"asc":return n;case"desc":return-1*n;default:return ge()}},t.prototype.canonicalId=function(){return this.field.j()+this.dir.toString()},t.prototype.toString=function(){return this.field.j()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),Dt=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=g.min()),void 0===o&&(o=g.min()),void 0===s&&(s=A.ht),this.target=t,this.targetId=e,this.Te=n,this.sequenceNumber=r,this.Ee=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.Ie=function(e){return new t(this.target,this.targetId,this.Te,e,this.Ee,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.we=function(e,n){return new t(this.target,this.targetId,this.Te,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Re=function(e){return new t(this.target,this.targetId,this.Te,this.sequenceNumber,this.Ee,e,this.resumeToken)},t}(),xt=function(t){this.count=t};function St(t){switch(t){case h.OK:return ge();case h.CANCELLED:case h.UNKNOWN:case h.DEADLINE_EXCEEDED:case h.RESOURCE_EXHAUSTED:case h.INTERNAL:case h.UNAVAILABLE:case h.UNAUTHENTICATED:return!1;case h.INVALID_ARGUMENT:case h.NOT_FOUND:case h.ALREADY_EXISTS:case h.PERMISSION_DENIED:case h.FAILED_PRECONDITION:case h.ABORTED:case h.OUT_OF_RANGE:case h.UNIMPLEMENTED:case h.DATA_LOSS:return!0;default:return ge()}}function Rt(t){if(void 0===t)return ye("GRPC error has no .code"),h.UNKNOWN;switch(t){case lt.OK:return h.OK;case lt.CANCELLED:return h.CANCELLED;case lt.UNKNOWN:return h.UNKNOWN;case lt.DEADLINE_EXCEEDED:return h.DEADLINE_EXCEEDED;case lt.RESOURCE_EXHAUSTED:return h.RESOURCE_EXHAUSTED;case lt.INTERNAL:return h.INTERNAL;case lt.UNAVAILABLE:return h.UNAVAILABLE;case lt.UNAUTHENTICATED:return h.UNAUTHENTICATED;case lt.INVALID_ARGUMENT:return h.INVALID_ARGUMENT;case lt.NOT_FOUND:return h.NOT_FOUND;case lt.ALREADY_EXISTS:return h.ALREADY_EXISTS;case lt.PERMISSION_DENIED:return h.PERMISSION_DENIED;case lt.FAILED_PRECONDITION:return h.FAILED_PRECONDITION;case lt.ABORTED:return h.ABORTED;case lt.OUT_OF_RANGE:return h.OUT_OF_RANGE;case lt.UNIMPLEMENTED:return h.UNIMPLEMENTED;case lt.DATA_LOSS:return h.DATA_LOSS;default:return ge()}}(pt=lt||(lt={}))[pt.OK=0]="OK",pt[pt.CANCELLED=1]="CANCELLED",pt[pt.UNKNOWN=2]="UNKNOWN",pt[pt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pt[pt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pt[pt.NOT_FOUND=5]="NOT_FOUND",pt[pt.ALREADY_EXISTS=6]="ALREADY_EXISTS",pt[pt.PERMISSION_DENIED=7]="PERMISSION_DENIED",pt[pt.UNAUTHENTICATED=16]="UNAUTHENTICATED",pt[pt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pt[pt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pt[pt.ABORTED=10]="ABORTED",pt[pt.OUT_OF_RANGE=11]="OUT_OF_RANGE",pt[pt.UNIMPLEMENTED=12]="UNIMPLEMENTED",pt[pt.INTERNAL=13]="INTERNAL",pt[pt.UNAVAILABLE=14]="UNAVAILABLE",pt[pt.DATA_LOSS=15]="DATA_LOSS";var Lt=function(){function t(t,e){this.N=t,this.root=e||Vt.EMPTY}return t.prototype.Ae=function(e,n){return new t(this.N,this.root.Ae(e,n,this.N).me(null,null,Vt.Pe,null,null))},t.prototype.remove=function(e){return new t(this.N,this.root.remove(e,this.N).me(null,null,Vt.Pe,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.B();){var n=this.N(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.B();){var r=this.N(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.B=function(){return this.root.B()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.Ve=function(){return this.root.Ve()},t.prototype.ge=function(){return this.root.ge()},t.prototype.pe=function(t){return this.root.pe(t)},t.prototype.forEach=function(t){this.pe(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.pe(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.ye=function(t){return this.root.ye(t)},t.prototype.be=function(){return new Ot(this.root,null,this.N,!1)},t.prototype.ve=function(t){return new Ot(this.root,t,this.N,!1)},t.prototype.Se=function(){return new Ot(this.root,null,this.N,!0)},t.prototype.De=function(t){return new Ot(this.root,t,this.N,!0)},t}(),Ot=function(){function t(t,e,n,r){this.Ce=r,this.Fe=[];for(var i=1;!t.B();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ce?t.left:t.right;else{if(0===i){this.Fe.push(t);break}this.Fe.push(t),t=this.Ce?t.right:t.left}}return t.prototype.Ne=function(){var t=this.Fe.pop(),e={key:t.key,value:t.value};if(this.Ce)for(t=t.left;!t.B();)this.Fe.push(t),t=t.right;else for(t=t.right;!t.B();)this.Fe.push(t),t=t.left;return e},t.prototype.$e=function(){return this.Fe.length>0},t.prototype.ke=function(){if(0===this.Fe.length)return null;var t=this.Fe[this.Fe.length-1];return{key:t.key,value:t.value}},t}(),Vt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.me=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.B=function(){return!1},t.prototype.pe=function(t){return this.left.pe(t)||t(this.key,this.value)||this.right.pe(t)},t.prototype.ye=function(t){return this.right.ye(t)||t(this.key,this.value)||this.left.ye(t)},t.prototype.min=function(){return this.left.B()?this:this.left.min()},t.prototype.Ve=function(){return this.min().key},t.prototype.ge=function(){return this.right.B()?this.key:this.right.ge()},t.prototype.Ae=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.me(null,null,null,r.left.Ae(t,e,n),null):0===i?r.me(null,e,null,null,null):r.me(null,null,null,null,r.right.Ae(t,e,n))).Le()},t.prototype.Me=function(){if(this.left.B())return t.EMPTY;var e=this;return e.left.Oe()||e.left.left.Oe()||(e=e.xe()),(e=e.me(null,null,null,e.left.Me(),null)).Le()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.B()||i.left.Oe()||i.left.left.Oe()||(i=i.xe()),i=i.me(null,null,null,i.left.remove(e,n),null);else{if(i.left.Oe()&&(i=i.Be()),i.right.B()||i.right.Oe()||i.right.left.Oe()||(i=i.qe()),0===n(e,i.key)){if(i.right.B())return t.EMPTY;r=i.right.min(),i=i.me(r.key,r.value,null,null,i.right.Me())}i=i.me(null,null,null,null,i.right.remove(e,n))}return i.Le()},t.prototype.Oe=function(){return this.color},t.prototype.Le=function(){var t=this;return t.right.Oe()&&!t.left.Oe()&&(t=t.Ue()),t.left.Oe()&&t.left.left.Oe()&&(t=t.Be()),t.left.Oe()&&t.right.Oe()&&(t=t.Qe()),t},t.prototype.xe=function(){var t=this.Qe();return t.right.left.Oe()&&(t=(t=(t=t.me(null,null,null,null,t.right.Be())).Ue()).Qe()),t},t.prototype.qe=function(){var t=this.Qe();return t.left.left.Oe()&&(t=(t=t.Be()).Qe()),t},t.prototype.Ue=function(){var e=this.me(null,null,t.RED,null,this.right.left);return this.right.me(null,null,this.color,e,null)},t.prototype.Be=function(){var e=this.me(null,null,t.RED,this.left.right,null);return this.left.me(null,null,this.color,null,e)},t.prototype.Qe=function(){var t=this.left.me(null,null,!this.left.color,null,null),e=this.right.me(null,null,!this.right.color,null,null);return this.me(null,null,!this.color,t,e)},t.prototype.We=function(){var t=this.je();return Math.pow(2,t)<=this.size+1},t.prototype.je=function(){if(this.Oe()&&this.left.Oe())throw ge();if(this.right.Oe())throw ge();var t=this.left.je();if(t!==this.right.je())throw ge();return t+(this.Oe()?0:1)},t}();Vt.EMPTY=null,Vt.RED=!0,Vt.Pe=!1,Vt.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw ge()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw ge()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw ge()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw ge()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw ge()},enumerable:!0,configurable:!0}),t.prototype.me=function(t,e,n,r,i){return this},t.prototype.Ae=function(t,e,n){return new Vt(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.B=function(){return!0},t.prototype.pe=function(t){return!1},t.prototype.ye=function(t){return!1},t.prototype.Ve=function(){return null},t.prototype.ge=function(){return null},t.prototype.Oe=function(){return!1},t.prototype.We=function(){return!0},t.prototype.je=function(){return 0},t}());var Pt=function(){function t(t){this.N=t,this.data=new Lt(this.N)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Ve()},t.prototype.last=function(){return this.data.ge()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.pe(function(e,n){return t(e),!1})},t.prototype.Ke=function(t,e){for(var n=this.data.ve(t[0]);n.$e();){var r=n.Ne();if(this.N(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ge=function(t,e){var n;for(n=void 0!==e?this.data.ve(e):this.data.be();n.$e();)if(!t(n.Ne().key))return},t.prototype.ze=function(t){var e=this.data.ve(t);return e.$e()?e.Ne().key:null},t.prototype.be=function(){return new Ut(this.data.be())},t.prototype.ve=function(t){return new Ut(this.data.ve(t))},t.prototype.add=function(t){return this.me(this.data.remove(t).Ae(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.me(this.data.remove(t)):this},t.prototype.B=function(){return this.data.B()},t.prototype.He=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.be(),r=e.data.be();n.$e();){var i=n.Ne().key,o=r.Ne().key;if(0!==this.N(i,o))return!1}return!0},t.prototype.W=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.me=function(e){var n=new t(this.N);return n.data=e,n},t}(),Ut=function(){function t(t){this.Ye=t}return t.prototype.Ne=function(){return this.Ye.Ne().key},t.prototype.$e=function(){return this.Ye.$e()},t}(),Ct=new Lt(_.N);function qt(){return Ct}function Mt(){return qt()}var jt=new Lt(_.N);function Ft(){return jt}var Bt=new Lt(_.N);function zt(){return Bt}var Gt=new Pt(_.N);function Wt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Gt,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Qt=new Pt(be);function Kt(){return Qt}var Yt=function(){function t(t){this.N=t?function(e,n){return t(e,n)||_.N(e.key,n.key)}:function(t,e){return _.N(t.key,e.key)},this.Je=Ft(),this.Xe=new Lt(this.N)}return t.Ze=function(e){return new t(e.N)},t.prototype.has=function(t){return null!=this.Je.get(t)},t.prototype.get=function(t){return this.Je.get(t)},t.prototype.first=function(){return this.Xe.Ve()},t.prototype.last=function(){return this.Xe.ge()},t.prototype.B=function(){return this.Xe.B()},t.prototype.indexOf=function(t){var e=this.Je.get(t);return e?this.Xe.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Xe.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.Xe.pe(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.me(e.Je.Ae(t.key,t),e.Xe.Ae(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.me(this.Je.remove(t),this.Xe.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Xe.be(),r=e.Xe.be();n.$e();){var i=n.Ne().key,o=r.Ne().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.me=function(e,n){var r=new t;return r.N=this.N,r.Je=e,r.Xe=n,r},t}(),$t=function(){function t(){this.ts=new Lt(_.N)}return t.prototype.track=function(t){var e=t.doc.key,n=this.ts.get(e);n?0!==t.type&&3===n.type?this.ts=this.ts.Ae(e,t):3===t.type&&1!==n.type?this.ts=this.ts.Ae(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ts=this.ts.Ae(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ts=this.ts.Ae(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ts=this.ts.remove(e):1===t.type&&2===n.type?this.ts=this.ts.Ae(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ts=this.ts.Ae(e,{type:2,doc:t.doc}):ge():this.ts=this.ts.Ae(e,t)},t.prototype.es=function(){var t=[];return this.ts.pe(function(e,n){t.push(n)}),t},t}(),Jt=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.ss=n,this.docChanges=r,this.ns=i,this.fromCache=o,this.rs=s,this.hs=u}return t.os=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,Yt.Ze(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.ns.B()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.rs===t.rs&&this.ns.isEqual(t.ns)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.ss.isEqual(t.ss)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Ht=function(){function t(t,e,n,r,i){this.Ee=t,this.as=e,this.us=n,this.cs=r,this._s=i}return t.ls=function(e,n){var r=new Map;return r.set(e,Xt.ds(e,n)),new t(g.min(),r,Kt(),qt(),Wt())},t}(),Xt=function(){function t(t,e,n,r,i){this.resumeToken=t,this.fs=e,this.Ts=n,this.Es=r,this.Is=i}return t.ds=function(e,n){return new t(A.ht,n,Wt(),Wt(),Wt())},t}(),Zt=function(t,e,n,r){this.ws=t,this.removedTargetIds=e,this.key=n,this.Rs=r},te=function(t,e){this.targetId=t,this.As=e},ee=function(t,e,n,r){void 0===n&&(n=A.ht),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},ne=function(){function t(){this.ms=0,this.Ps=oe(),this.Vs=A.ht,this.gs=!1,this.ps=!0}return Object.defineProperty(t.prototype,"fs",{get:function(){return this.gs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Vs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ys",{get:function(){return 0!==this.ms},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bs",{get:function(){return this.ps},enumerable:!0,configurable:!0}),t.prototype.vs=function(t){t.rt()>0&&(this.ps=!0,this.Vs=t)},t.prototype.Ss=function(){var t=Wt(),e=Wt(),n=Wt();return this.Ps.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:ge()}}),new Xt(this.Vs,this.gs,t,e,n)},t.prototype.Ds=function(){this.ps=!1,this.Ps=oe()},t.prototype.Cs=function(t,e){this.ps=!0,this.Ps=this.Ps.Ae(t,e)},t.prototype.Fs=function(t){this.ps=!0,this.Ps=this.Ps.remove(t)},t.prototype.Ns=function(){this.ms+=1},t.prototype.$s=function(){this.ms-=1},t.prototype.ks=function(){this.ps=!0,this.gs=!0},t}(),re=function(){function t(t){this.Ls=t,this.Ms=new Map,this.Os=qt(),this.xs=ie(),this.Bs=new Pt(be)}return t.prototype.qs=function(t){for(var e=0,n=t.ws;e<n.length;e++){var r=n[e];t.Rs instanceof yt?this.Us(r,t.Rs):t.Rs instanceof vt&&this.Qs(r,t.key,t.Rs)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Qs(s,t.key,t.Rs)}},t.prototype.Ws=function(t){var e=this;this.js(t,function(n){var r=e.Ks(n);switch(t.state){case 0:e.Gs(n)&&r.vs(t.resumeToken);break;case 1:r.$s(),r.ys||r.Ds(),r.vs(t.resumeToken);break;case 2:r.$s(),r.ys||e.removeTarget(n);break;case 3:e.Gs(n)&&(r.ks(),r.vs(t.resumeToken));break;case 4:e.Gs(n)&&(e.zs(n),r.vs(t.resumeToken));break;default:ge()}})},t.prototype.js=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Ms.forEach(function(t,r){n.Gs(r)&&e(r)})},t.prototype.Hs=function(t){var e=t.targetId,n=t.As.count,r=this.Ys(e);if(r){var i=r.target;if(i.Ot())if(0===n){var o=new _(i.path);this.Qs(e,o,new vt(o,g.min()))}else me(1===n);else this.Js(e)!==n&&(this.zs(e),this.Bs=this.Bs.add(e))}},t.prototype.Xs=function(t){var e=this,n=new Map;this.Ms.forEach(function(r,i){var o=e.Ys(i);if(o){if(r.fs&&o.target.Ot()){var s=new _(o.target.path);null!==e.Os.get(s)||e.Zs(i,s)||e.Qs(i,s,new vt(s,t))}r.bs&&(n.set(i,r.Ss()),r.Ds())}});var r=Wt();this.xs.forEach(function(t,n){var i=!0;n.Ge(function(t){var n=e.Ys(t);return!n||2===n.Te||(i=!1,!1)}),i&&(r=r.add(t))});var i=new Ht(t,n,this.Bs,this.Os,r);return this.Os=qt(),this.xs=ie(),this.Bs=new Pt(be),i},t.prototype.Us=function(t,e){if(this.Gs(t)){var n=this.Zs(t,e.key)?2:0;this.Ks(t).Cs(e.key,n),this.Os=this.Os.Ae(e.key,e),this.xs=this.xs.Ae(e.key,this.ti(e.key).add(t))}},t.prototype.Qs=function(t,e,n){if(this.Gs(t)){var r=this.Ks(t);this.Zs(t,e)?r.Cs(e,1):r.Fs(e),this.xs=this.xs.Ae(e,this.ti(e).delete(t)),n&&(this.Os=this.Os.Ae(e,n))}},t.prototype.removeTarget=function(t){this.Ms.delete(t)},t.prototype.Js=function(t){var e=this.Ks(t).Ss();return this.Ls.ei(t).size+e.Ts.size-e.Is.size},t.prototype.Ns=function(t){this.Ks(t).Ns()},t.prototype.Ks=function(t){var e=this.Ms.get(t);return e||(e=new ne,this.Ms.set(t,e)),e},t.prototype.ti=function(t){var e=this.xs.get(t);return e||(e=new Pt(be),this.xs=this.xs.Ae(t,e)),e},t.prototype.Gs=function(t){var e=null!==this.Ys(t);return e||de("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Ys=function(t){var e=this.Ms.get(t);return e&&e.ys?null:this.Ls.si(t)},t.prototype.zs=function(t){var e=this;this.Ms.set(t,new ne),this.Ls.ei(t).forEach(function(n){e.Qs(t,n,null)})},t.prototype.Zs=function(t,e){return this.Ls.ei(t).has(e)},t}();function ie(){return new Lt(_.N)}function oe(){return new Lt(_.N)}var se={asc:"ASCENDING",desc:"DESCENDING"},ue={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ae=function(){function t(t,e){this.ii=t,this.options=e}return t.prototype.ni=function(t){var e=void 0===t.code?h.UNKNOWN:Rt(t.code);return new c(e,t.message||"")},t.prototype.ri=function(t){return this.options.hi||k(t)?t:{value:t}},t.prototype.oi=function(t){var e;return k(e="object"==typeof t?t.value:t)?null:e},t.prototype._t=function(t){return{integerValue:""+t}},t.prototype.lt=function(t){if(this.options.hi){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:D(t)?"-0":t}},t.prototype.ai=function(t){return x(t)?this._t(t):this.lt(t)},t.prototype.C=function(t){return this.options.hi?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},t.prototype.v=function(t){var e=M(t);return new v(e.seconds,e.nanos)},t.prototype.ui=function(t){return this.options.hi?t.toBase64():t.toUint8Array()},t.prototype.ci=function(t){return this.options.hi?(me(void 0===t||"string"==typeof t),A.fromBase64String(t||"")):(me(void 0===t||t instanceof Uint8Array),A.fromUint8Array(t||new Uint8Array))},t.prototype.toVersion=function(t){return this.C(t.C())},t.prototype.fromVersion=function(t){return me(!!t),g.v(this.v(t))},t.prototype._i=function(t,e){return this.li(e||this.ii).child("documents").child(t).j()},t.prototype.di=function(t){var e=w.K(t);return me(he(e)),e},t.prototype.fi=function(t){return this._i(t.path)},t.prototype.Z=function(t){var e=this.di(t);return me(e.get(1)===this.ii.projectId),me(!e.get(3)&&!this.ii.database||e.get(3)===this.ii.database),new _(this.Ti(e))},t.prototype.Ei=function(t){return this._i(t)},t.prototype.Ii=function(t){var e=this.di(t);return 4===e.length?w.G:this.Ti(e)},Object.defineProperty(t.prototype,"wi",{get:function(){return new w(["projects",this.ii.projectId,"databases",this.ii.database]).j()},enumerable:!0,configurable:!0}),t.prototype.li=function(t){return new w(["projects",t.projectId,"databases",t.database])},t.prototype.Ti=function(t){return me(t.length>4&&"documents"===t.get(4)),t.k(5)},t.prototype.Ri=function(t,e){return{name:this.fi(t),fields:e.proto.mapValue.fields}},t.prototype.Ai=function(t){return{name:this.fi(t.key),fields:t.Lt().mapValue.fields,updateTime:this.C(t.version.C())}},t.prototype.mi=function(t,e){var n=this.Z(t.name),r=this.fromVersion(t.updateTime),i=new ht({mapValue:{fields:t.fields}});return new yt(n,r,i,{hasCommittedMutations:!!e})},t.prototype.Pi=function(t){me(!!t.found),t.found.name,t.found.updateTime;var e=this.Z(t.found.name),n=this.fromVersion(t.found.updateTime),r=new ht({mapValue:{fields:t.found.fields}});return new yt(e,n,r,{})},t.prototype.Vi=function(t){me(!!t.missing),me(!!t.readTime);var e=this.Z(t.missing),n=this.fromVersion(t.readTime);return new vt(e,n)},t.prototype.gi=function(t){return"found"in t?this.Pi(t):"missing"in t?this.Vi(t):ge()},t.prototype.pi=function(t){var e;if("targetChange"in t){t.targetChange;var n=this.yi(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],i=this.ci(t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&this.ni(o);e=new ee(n,r,i,s||null)}else if("documentChange"in t){t.documentChange;var u=t.documentChange;u.document,u.document.name,u.document.updateTime;var a=this.Z(u.document.name),h=this.fromVersion(u.document.updateTime),c=new ht({mapValue:{fields:u.document.fields}}),f=new yt(a,h,c,{}),l=u.targetIds||[],p=u.removedTargetIds||[];e=new Zt(l,p,f.key,f)}else if("documentDelete"in t){t.documentDelete;var d=t.documentDelete;d.document;var y=this.Z(d.document),v=d.readTime?this.fromVersion(d.readTime):g.min(),m=new vt(y,v),w=d.removedTargetIds||[];e=new Zt([],w,m.key,m)}else if("documentRemove"in t){t.documentRemove;var E=t.documentRemove;E.document;var b=this.Z(E.document),_=E.removedTargetIds||[];e=new Zt([],_,b,null)}else{if(!("filter"in t))return ge();t.filter;var T=t.filter;T.targetId;var I=T.count||0,N=new xt(I),A=T.targetId;e=new te(A,N)}return e},t.prototype.yi=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:ge()},t.prototype.bi=function(t){if(!("targetChange"in t))return g.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?g.min():e.readTime?this.fromVersion(e.readTime):g.min()},t.prototype.vi=function(t){var e,n=this;if(t instanceof it)e={update:this.Ri(t.key,t.value)};else if(t instanceof ut)e={delete:this.fi(t.key)};else if(t instanceof ot)e={update:this.Ri(t.key,t.data),updateMask:this.Si(t.Vt)};else if(t instanceof st)e={transform:{document:this.fi(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Di(t)})}};else{if(!(t instanceof at))return ge();e={verify:this.fi(t.key)}}return t.Rt.Tt||(e.currentDocument=this.Ci(t.Rt)),e},t.prototype.Fi=function(t){var e=this,n=t.currentDocument?this.Ni(t.currentDocument):nt.ft();if(t.update){t.update.name;var r=this.Z(t.update.name),i=new ht({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.$i(t.updateMask);return new ot(r,i,o,n)}return new it(r,i,n)}if(t.delete){var s=this.Z(t.delete);return new ut(s,n)}if(t.transform){var u=this.Z(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.ki(t)});return me(!0===n.exists),new st(u,a)}if(t.verify){var h=this.Z(t.verify);return new at(h,n)}return ge()},t.prototype.Ci=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:ge()},t.prototype.Ni=function(t){return void 0!==t.updateTime?nt.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?nt.exists(t.exists):nt.ft()},t.prototype.Li=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(g.min())&&(n=this.fromVersion(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new et(n,r)},t.prototype.Mi=function(t,e){var n=this;return t&&t.length>0?(me(void 0!==e),t.map(function(t){return n.Li(t,e)})):[]},t.prototype.Di=function(t){var e=t.transform;if(e instanceof Y)return{fieldPath:t.field.j(),setToServerValue:"REQUEST_TIME"};if(e instanceof $)return{fieldPath:t.field.j(),appendMissingElements:{values:e.elements}};if(e instanceof J)return{fieldPath:t.field.j(),removeAllFromArray:{values:e.elements}};if(e instanceof H)return{fieldPath:t.field.j(),increment:e.ct};throw ge()},t.prototype.ki=function(t){var e=null;if("setToServerValue"in t)me("REQUEST_TIME"===t.setToServerValue),e=Y.instance;else if("appendMissingElements"in t){var n=t.appendMissingElements.values||[];e=new $(n)}else if("removeAllFromArray"in t){var r=t.removeAllFromArray.values||[];e=new J(r)}else"increment"in t?e=new H(this,t.increment):ge();var i=b.X(t.fieldPath);return new tt(i,e)},t.prototype.Oi=function(t){return{documents:[this.Ei(t.path)]}},t.prototype.xi=function(t){me(1===t.documents.length);var e=t.documents[0];return wt.Wt(this.Ii(e)).ee()},t.prototype.Bi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Ei(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Ei(n.L()),e.structuredQuery.from=[{collectionId:n.O()}]);var r=this.qi(t.filters);r&&(e.structuredQuery.where=r);var i=this.Ui(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.ri(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Qi(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Qi(t.endAt)),e},t.prototype.Wi=function(t){var e=this.Ii(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){me(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.ji(n.where));var u=[];n.orderBy&&(u=this.Ki(n.orderBy));var a=null;n.limit&&(a=this.oi(n.limit));var h=null;n.startAt&&(h=this.Gi(n.startAt));var c=null;return n.endAt&&(c=this.Gi(n.endAt)),new wt(e,i,u,s,a,"F",h,c).ee()},t.prototype.zi=function(t){var e=this.Hi(t.Te);return null==e?null:{"goog-listen-tags":e}},t.prototype.Hi=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ge()}},t.prototype.ee=function(t){var e,n=t.target;return(e=n.Ot()?{documents:this.Oi(n)}:{query:this.Bi(n)}).targetId=t.targetId,t.resumeToken.rt()>0&&(e.resumeToken=this.ui(t.resumeToken)),e},t.prototype.qi=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Et?e.Yi(t):ge()});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.ji=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.Ji(t)]:void 0!==t.fieldFilter?[this.Xi(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.ji(t)}).reduce(function(t,e){return t.concat(e)}):ge():[]},t.prototype.Ui=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.Zi(t)})},t.prototype.Ki=function(t){var e=this;return t.map(function(t){return e.tn(t)})},t.prototype.Qi=function(t){return{before:t.before,values:t.position}},t.prototype.Gi=function(t){var e=!!t.before,n=t.values||[];return new At(n,e)},t.prototype.en=function(t){return se[t]},t.prototype.sn=function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}},t.prototype.nn=function(t){return ue[t]},t.prototype.rn=function(t){switch(t){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return ge()}},t.prototype.hn=function(t){return{fieldPath:t.j()}},t.prototype.on=function(t){return b.X(t.fieldPath)},t.prototype.Zi=function(t){return{field:this.hn(t.field),direction:this.en(t.dir)}},t.prototype.tn=function(t){return new kt(this.on(t.field),this.sn(t.direction))},t.prototype.Xi=function(t){return Et.create(this.on(t.fieldFilter.field),this.rn(t.fieldFilter.op),t.fieldFilter.value)},t.prototype.Yi=function(t){if("=="===t.op){if(Q(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NAN"}};if(W(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.hn(t.field),op:this.nn(t.op),value:t.value}}},t.prototype.Ji=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.on(t.unaryFilter.field);return Et.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=this.on(t.unaryFilter.field);return Et.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return ge()}},t.prototype.Si=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.j())}),{fieldPaths:e}},t.prototype.$i=function(t){var e=t.fieldPaths||[];return new Z(e.map(function(t){return b.X(t)}))},t}();function he(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var ce=function(){function t(){}return t.an=function(e){t.platform&&ge(),t.platform=e},t.nt=function(){return t.platform||ge(),t.platform},t}(),fe=new r.Logger("@firebase/firestore");function le(){return fe.logLevel}function pe(t){fe.logLevel=t}function de(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(fe.logLevel<=r.LogLevel.DEBUG){var o=n.map(ve);fe.debug.apply(fe,e.__spreadArrays(["Firestore ("+u+"): "+t],o))}}function ye(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(fe.logLevel<=r.LogLevel.ERROR){var o=n.map(ve);fe.error.apply(fe,e.__spreadArrays(["Firestore ("+u+"): "+t],o))}}function ve(t){if("string"==typeof t)return t;var e=ce.nt();try{return e.un(t)}catch(e){return t}}function ge(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+u+") INTERNAL ASSERTION FAILED: "+t;throw ye(e),new Error(e)}function me(t,e){t||ge()}function we(t,e){return t}var Ee=function(){function t(){}return t.cn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=ce.nt()._n(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function be(t,e){return t<e?-1:t>e?1:0}function _e(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function Te(t){return t+"\0"}var Ie=function(t,e,n,r,i){this.ii=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},Ne=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"ln",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.S=function(t){return be(this.projectId,t.projectId)||be(this.database,t.database)},t}(),Ae=function(){function t(t){this.dn=t,this.fn={}}return t.prototype.get=function(t){var e=this.dn(t),n=this.fn[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(s.isEqual(t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.dn(t),r=this.fn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.fn[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.dn(t),n=this.fn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.fn[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){I(this.fn,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];t(s,u)}})},t.prototype.B=function(){return N(this.fn)},t}(),ke=function(){function t(t,e,n,r){this.batchId=t,this.Tn=e,this.baseMutations=n,this.mutations=r}return t.prototype.at=function(t,e,n){for(var r=n.En,i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var s=r[i];e=o.at(e,s)}}return e},t.prototype.ot=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=i.ot(e,e,this.Tn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.ot(e,o,this.Tn))}return e},t.prototype.In=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.ot(r.key,t.get(r.key));i&&(n=n.Ae(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Wt())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&_e(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&_e(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},t}(),De=function(){function t(t,e,n,r,i){this.batch=t,this.wn=e,this.En=n,this.streamToken=r,this.Rn=i}return t.from=function(e,n,r,i){me(e.mutations.length===r.length);for(var o=zt(),s=e.mutations,u=0;u<s.length;u++)o=o.Ae(s[u].key,r[u].version);return new t(e,n,r,i,o)},t}(),xe=function(){function t(t){var e=this;this.An=null,this.mn=null,this.result=void 0,this.error=void 0,this.Pn=!1,this.Vn=!1,t(function(t){e.Pn=!0,e.result=t,e.An&&e.An(t)},function(t){e.Pn=!0,e.error=t,e.mn&&e.mn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Vn&&ge(),this.Vn=!0,this.Pn?this.error?this.gn(n,this.error):this.pn(e,this.result):new t(function(t,i){r.An=function(n){r.pn(e,n).next(t,i)},r.mn=function(e){r.gn(n,e).next(t,i)}})},t.prototype.yn=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.bn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.pn=function(e,n){return e?this.bn(function(){return e(n)}):t.resolve(n)},t.prototype.gn=function(e,n){return e?this.bn(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.vn=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Sn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.vn(r)},t}(),Se=function(){function t(){this.Dn=new Ae(function(t){return t.toString()}),this.Cn=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return this.Fn},set:function(t){this.Fn=t},enumerable:!0,configurable:!0}),t.prototype.Nn=function(t,e){this.$n(),this.readTime=e,this.Dn.set(t.key,t)},t.prototype.kn=function(t,e){this.$n(),e&&(this.readTime=e),this.Dn.set(t,null)},t.prototype.Ln=function(t,e){this.$n();var n=this.Dn.get(e);return void 0!==n?xe.resolve(n):this.Mn(t,e)},t.prototype.getEntries=function(t,e){return this.On(t,e)},t.prototype.apply=function(t){return this.$n(),this.Cn=!0,this.xn(t)},t.prototype.$n=function(){},t}(),Re="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Le=function(){function t(){this.Bn=[]}return t.prototype.qn=function(t){this.Bn.push(t)},t.prototype.Un=function(){this.Bn.forEach(function(t){return t()})},t}(),Oe=function(){function t(t,e,n){this.Qn=t,this.Wn=e,this.jn=n}return t.prototype.Kn=function(t,e){var n=this;return this.Wn.Gn(t,e).next(function(r){return n.zn(t,e,r)})},t.prototype.zn=function(t,e,n){return this.Qn.Ln(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].ot(e,t);return t})},t.prototype.Hn=function(t,e,n){var r=Mt();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].ot(t,e);r=r.Ae(t,e)}),r},t.prototype.Yn=function(t,e){var n=this;return this.Qn.getEntries(t,e).next(function(e){return n.Jn(t,e)})},t.prototype.Jn=function(t,e){var n=this;return this.Wn.Xn(t,e).next(function(r){var i=n.Hn(t,e,r),o=qt();return i.forEach(function(t,e){e||(e=new vt(t,g.min())),o=o.Ae(t,e)}),o})},t.prototype.Zn=function(t,e,n){return e.Ot()?this.tr(t,e.path):e._e()?this.er(t,e,n):this.sr(t,e,n)},t.prototype.tr=function(t,e){return this.Kn(t,new _(e)).next(function(t){var e=Ft();return t instanceof yt&&(e=e.Ae(t.key,t)),e})},t.prototype.er=function(t,e,n){var r=this,i=e.collectionGroup,o=Ft();return this.jn.ir(t,i).next(function(s){return xe.forEach(s,function(s){var u=e.Zt(s.child(i));return r.sr(t,u,n).next(function(t){t.forEach(function(t,e){o=o.Ae(t,e)})})}).next(function(){return o})})},t.prototype.sr=function(t,e,n){var r,i,o=this;return this.Qn.Zn(t,e,n).next(function(n){return r=n,o.Wn.nr(t,e)}).next(function(e){return i=e,o.rr(t,i,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],h=a.key,c=r.get(h),f=a.ot(c,c,o.Tn);r=f instanceof yt?r.Ae(h,f):r.remove(h)}})}).next(function(){return r.forEach(function(t,n){e.matches(n)||(r=r.remove(t))}),r})},t.prototype.rr=function(t,e,n){for(var r=Wt(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof ot&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof yt&&(h=h.Ae(t,e))}),h})},t}(),Ve=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.hr=n,this.or=r}return t.ar=function(e,n){for(var r=Wt(),i=Wt(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Pe=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.ur=function(t){return n.cr(t)},this._r=function(t){return e.lr(t)})}return t.prototype.cr=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this._r&&this._r(t),t},t}();Pe.dr=-1;var Ue=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},Ce=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Tr=t,this.Er=e,this.Ir=n,this.wr=r,this.Rr=i,this.Ar=0,this.mr=null,this.Pr=Date.now(),this.reset()}return t.prototype.reset=function(){this.Ar=0},t.prototype.Vr=function(){this.Ar=this.Rr},t.prototype.gr=function(t){var e=this;this.cancel();var n=Math.floor(this.Ar+this.pr()),r=Math.max(0,Date.now()-this.Pr),i=Math.max(0,n-r);i>0&&de("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ar+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.mr=this.Tr.yr(this.Er,i,function(){return e.Pr=Date.now(),t()}),this.Ar*=this.wr,this.Ar<this.Ir&&(this.Ar=this.Ir),this.Ar>this.Rr&&(this.Ar=this.Rr)},t.prototype.br=function(){null!==this.mr&&(this.mr.vr(),this.mr=null)},t.prototype.cancel=function(){null!==this.mr&&(this.mr.cancel(),this.mr=null)},t.prototype.pr=function(){return(Math.random()-.5)*this.Ar},t}();function qe(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=je(e)),e=Me(t.get(n),e);return je(e)}function Me(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function je(t){return t+""}function Fe(t){var e=t.length;if(me(e>=2),2===e)return me(""===t.charAt(0)&&""===t.charAt(1)),w.G;for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&ge(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:ge()}o=s+2}return new w(r)}var Be=function(){function t(){this.Sr=new ze}return t.prototype.Dr=function(t,e){return this.Sr.add(e),xe.resolve()},t.prototype.ir=function(t,e){return xe.resolve(this.Sr.getEntries(e))},t}(),ze=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.O(),n=t.L(),r=this.index[e]||new Pt(w.N),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.O(),n=t.L(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Pt(w.N)).W()},t}(),Ge=function(){function t(){this.Cr=new ze}return t.prototype.Dr=function(t,e){var n=this;if(!this.Cr.has(e)){var r=e.O(),i=e.L();t.qn(function(){n.Cr.add(e)});var o={collectionId:r,parent:qe(i)};return We(t).put(o)}return xe.resolve()},t.prototype.ir=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Te(e),""],!1,!0);return We(t).Fr(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Fe(o.parent))}return n})},t}();function We(t){return sn.Nr(t,Rn.store)}var Qe=function(){function t(t,e){this.serializer=t,this.jn=e}return t.prototype.Nn=function(t,e,n){return Ye(t).put($e(e),n)},t.prototype.kn=function(t,e){var n=Ye(t),r=$e(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.$r(t,r)})},t.prototype.Ln=function(t,e){var n=this;return Ye(t).get($e(e)).next(function(t){return n.kr(t)})},t.prototype.Lr=function(t,e){var n=this;return Ye(t).get($e(e)).next(function(t){var e=n.kr(t);return e?{Mr:e,size:Je(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=Mt();return this.Or(t,e,function(t,e){var i=n.kr(e);r=r.Ae(t,i)}).next(function(){return r})},t.prototype.xr=function(t,e){var n=this,r=Mt(),i=new Lt(_.N);return this.Or(t,e,function(t,e){var o=n.kr(e);o?(r=r.Ae(t,o),i=i.Ae(t,Je(e))):(r=r.Ae(t,null),i=i.Ae(t,0))}).next(function(){return{Br:r,qr:i}})},t.prototype.Or=function(t,e,n){if(e.B())return xe.resolve();var r=IDBKeyRange.bound(e.first().path.W(),e.last().path.W()),i=e.be(),o=i.Ne();return Ye(t).Ur({range:r},function(t,e,r){for(var s=_.st(t);o&&_.N(o,s)<0;)n(o,null),o=i.Ne();o&&o.isEqual(s)&&(n(o,e),o=i.$e()?i.Ne():null),o?r.Qr(o.path.W()):r.done()}).next(function(){for(;o;)n(o,null),o=i.$e()?i.Ne():null})},t.prototype.Zn=function(t,e,n){var r=this,i=Ft(),o=e.path.length+1,s={};if(n.isEqual(g.min())){var u=e.path.W();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.W(),h=this.serializer.Wr(n);s.range=IDBKeyRange.lowerBound([a,h],!0),s.index=An.collectionReadTimeIndex}return Ye(t).Ur(s,function(t,n,s){if(t.length===o){var u=r.serializer.jr(n);e.path.q(u.key.path)?u instanceof yt&&e.matches(u)&&(i=i.Ae(u.key,u)):s.done()}}).next(function(){return i})},t.prototype.Kr=function(t,e){var n=this,r=qt(),i=this.serializer.Wr(e),o=Ye(t),s=IDBKeyRange.lowerBound(i,!0);return o.Ur({index:An.readTimeIndex,range:s},function(t,e){var o=n.serializer.jr(e);r=r.Ae(o.key,o),i=e.readTime}).next(function(){return{Gr:r,readTime:n.serializer.zr(i)}})},t.prototype.Hr=function(t){var e=this,n=Ye(t),r=g.min();return n.Ur({index:An.readTimeIndex,reverse:!0},function(t,n,i){n.readTime&&(r=e.serializer.zr(n.readTime)),i.done()}).next(function(){return r})},t.prototype.Yr=function(e){return new t.Jr(this,!!e&&e.Xr)},t.prototype.Zr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Ke(t).get(kn.key).next(function(t){return me(!!t),t})},t.prototype.$r=function(t,e){return Ke(t).put(kn.key,e)},t.prototype.kr=function(t){if(t){var e=this.serializer.jr(t);return e instanceof vt&&e.version.isEqual(g.min())?null:e}return null},t}();function Ke(t){return sn.Nr(t,kn.store)}function Ye(t){return sn.Nr(t,An.store)}function $e(t){return t.path.W()}function Je(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ge();e=t.noDocument}return JSON.stringify(e).length}Qe.Jr=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).th=e,r.Xr=n,r.eh=new Ae(function(t){return t.toString()}),r}return e.__extends(n,t),n.prototype.xn=function(t){var e=this,n=[],r=0,i=new Pt(function(t,e){return be(t.j(),e.j())});return this.Dn.forEach(function(o,s){var u=e.eh.get(o);if(s){var a=e.th.serializer.sh(s,e.readTime);i=i.add(o.path.L());var h=Je(a);r+=h-u,n.push(e.th.Nn(t,o,a))}else if(r-=u,e.Xr){var c=e.th.serializer.sh(new vt(o,g.min()),e.readTime);n.push(e.th.Nn(t,o,c))}else n.push(e.th.kn(t,o))}),i.forEach(function(r){n.push(e.th.jn.Dr(t,r))}),n.push(this.th.updateMetadata(t,r)),xe.vn(n)},n.prototype.Mn=function(t,e){var n=this;return this.th.Lr(t,e).next(function(t){return null===t?(n.eh.set(e,0),null):(n.eh.set(e,t.size),t.Mr)})},n.prototype.On=function(t,e){var n=this;return this.th.xr(t,e).next(function(t){var e=t.Br;return t.qr.forEach(function(t,e){n.eh.set(t,e)}),e})},n}(Se);var He=function(){function t(t){this.ih=t}return t.prototype.next=function(){return this.ih+=2,this.ih},t.nh=function(){return new t(0)},t.rh=function(){return new t(-1)},t}(),Xe=function(){function t(t,e){this.hh=t,this.serializer=e}return t.prototype.oh=function(t){var e=this;return this.ah(t).next(function(n){var r=new He(n.highestTargetId);return n.highestTargetId=r.next(),e.uh(t,n).next(function(){return n.highestTargetId})})},t.prototype._h=function(t){return this.ah(t).next(function(t){return g.v(new v(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.lh=function(t){return this.ah(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.dh=function(t,e,n){var r=this;return this.ah(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.C()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.uh(t,i)})},t.prototype.fh=function(t,e){var n=this;return this.Th(t,e).next(function(){return n.ah(t).next(function(r){return r.targetCount+=1,n.Eh(e,r),n.uh(t,r)})})},t.prototype.Ih=function(t,e){return this.Th(t,e)},t.prototype.wh=function(t,e){var n=this;return this.Rh(t,e.targetId).next(function(){return Ze(t).delete(e.targetId)}).next(function(){return n.ah(t)}).next(function(e){return me(e.targetCount>0),e.targetCount-=1,n.uh(t,e)})},t.prototype.Ah=function(t,e,n){var r=this,i=0,o=[];return Ze(t).Ur(function(s,u){var a=r.serializer.mh(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.wh(t,a)))}).next(function(){return xe.vn(o)}).next(function(){return i})},t.prototype.js=function(t,e){var n=this;return Ze(t).Ur(function(t,r){var i=n.serializer.mh(r);e(i)})},t.prototype.ah=function(t){return tn(t).get(Sn.key).next(function(t){return me(null!==t),t})},t.prototype.uh=function(t,e){return tn(t).put(Sn.key,e)},t.prototype.Th=function(t,e){return Ze(t).put(this.serializer.Ph(e))},t.prototype.Eh=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Vh=function(t){return this.ah(t).next(function(t){return t.targetCount})},t.prototype.gh=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Ze(t).Ur({range:i,index:Dn.queryTargetsIndexName},function(t,r,i){var s=n.serializer.mh(r);e.isEqual(s.target)&&(o=s,i.done())}).next(function(){return o})},t.prototype.ph=function(t,e,n){var r=this,i=[],o=en(t);return e.forEach(function(e){var s=qe(e.path);i.push(o.put(new xn(n,s))),i.push(r.hh.yh(t,n,e))}),xe.vn(i)},t.prototype.bh=function(t,e,n){var r=this,i=en(t);return xe.forEach(e,function(e){var o=qe(e.path);return xe.vn([i.delete([n,o]),r.hh.vh(t,n,e)])})},t.prototype.Rh=function(t,e){var n=en(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.Sh=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=en(t),i=Wt();return r.Ur({range:n,Dh:!0},function(t,e,n){var r=Fe(t[1]),o=new _(r);i=i.add(o)}).next(function(){return i})},t.prototype.Ch=function(t,e){var n=qe(e.path),r=IDBKeyRange.bound([n],[Te(n)],!1,!0),i=0;return en(t).Ur({index:xn.documentTargetsIndex,Dh:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return i>0})},t.prototype.si=function(t,e){var n=this;return Ze(t).get(e).next(function(t){return t?n.serializer.mh(t):null})},t}();function Ze(t){return sn.Nr(t,Dn.store)}function tn(t){return sn.Nr(t,Sn.store)}function en(t){return sn.Nr(t,xn.store)}var nn=function(){function t(t){this.Fh=t}return t.prototype.jr=function(t){if(t.document)return this.Fh.mi(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=_.st(t.noDocument.path),n=this.Nh(t.noDocument.readTime);return new vt(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){var r=_.st(t.unknownDocument.path),i=this.Nh(t.unknownDocument.version);return new gt(r,i)}return ge()},t.prototype.sh=function(t,e){var n=this.Wr(e),r=t.key.path.L().W();if(t instanceof yt){var i=this.Fh.Ai(t),o=t.hasCommittedMutations;return new An(null,null,i,o,n,r)}if(t instanceof vt){var s=t.key.path.W(),u=this.$h(t.version),a=t.hasCommittedMutations;return new An(null,new In(s,u),null,a,n,r)}if(t instanceof gt){var h=t.key.path.W(),c=this.$h(t.version);return new An(new Nn(h,c),null,null,!0,n,r)}return ge()},t.prototype.Wr=function(t){var e=t.C();return[e.seconds,e.nanoseconds]},t.prototype.zr=function(t){var e=new v(t[0],t[1]);return g.v(e)},t.prototype.$h=function(t){var e=t.C();return new wn(e.seconds,e.nanoseconds)},t.prototype.Nh=function(t){var e=new v(t.seconds,t.nanoseconds);return g.v(e)},t.prototype.kh=function(t,e){var n=this,r=e.baseMutations.map(function(t){return n.Fh.vi(t)}),i=e.mutations.map(function(t){return n.Fh.vi(t)});return new _n(t,e.batchId,e.Tn.toMillis(),r,i)},t.prototype.Lh=function(t){var e=this,n=(t.baseMutations||[]).map(function(t){return e.Fh.Fi(t)}),r=t.mutations.map(function(t){return e.Fh.Fi(t)}),i=v.fromMillis(t.localWriteTimeMs);return new ke(t.batchId,i,n,r)},t.prototype.mh=function(t){var e,n=this.Nh(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?this.Nh(t.lastLimboFreeSnapshotVersion):g.min();return e=void 0!==t.query.documents?this.Fh.xi(t.query):this.Fh.Wi(t.query),new Dt(e,t.targetId,0,t.lastListenSequenceNumber,n,r,A.fromBase64String(t.resumeToken))},t.prototype.Ph=function(t){var e,n=this.$h(t.Ee),r=this.$h(t.lastLimboFreeSnapshotVersion);e=t.target.Ot()?this.Fh.Oi(t.target):this.Fh.Bi(t.target);var i=t.resumeToken.toBase64();return new Dn(t.targetId,t.target.canonicalId(),n,i,t.sequenceNumber,r,e)},t}(),rn="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",on=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).Mh=e,r.Oh=n,r}return e.__extends(n,t),n}(Le),sn=function(){function t(e,n,r,i,o,s,u,a){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Tr=s,this.xh=a,this.Bh=null,this.qh=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Uh=null,this.inForeground=!1,this.Qh=null,this.Wh=null,this.jh=Number.NEGATIVE_INFINITY,this.Kh=function(t){return Promise.resolve()},!t.Gh())throw new c(h.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");if(this.hh=new hn(this,o),this.zh=n+t.Hh,this.serializer=new nn(u),this.document=i.document,this.Yh=new Xe(this.hh,this.serializer),this.jn=new Ge,this.Qn=new Qe(this.serializer,this.jn),!i.window||!i.window.localStorage)throw new c(h.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=i.window,this.Jh=this.window.localStorage}return t.Nr=function(t,e){if(t instanceof on)return Pn.Nr(t.Mh,e);throw ge()},t.prototype.start=function(){var t=this;return Pn.Xh(this.zh,gn,new mn(this.serializer)).then(function(e){return t.Zh=e,t.to()}).then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new c(h.FAILED_PRECONDITION,rn);return t.eo(),t.so(),t.io(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.Yh.lh(e)})}).then(function(e){t.Bh=new Pe(e,t.xh)}).then(function(){t.qh=!0}).catch(function(e){return t.Zh&&t.Zh.close(),Promise.reject(e)})},t.prototype.no=function(t){var n=this;return this.Kh=function(r){return e.__awaiter(n,void 0,void 0,function(){return e.__generator(this,function(e){return this.ro?[2,t(r)]:[2]})})},t(this.isPrimary)},t.prototype.ho=function(t){var n=this;this.Zh.oo(function(r){return e.__awaiter(n,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return null===r.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.ao=function(t){var n=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Tr.uo(function(){return e.__awaiter(n,void 0,void 0,function(){return e.__generator(this,function(t){switch(t.label){case 0:return this.ro?[4,this.to()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.to=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return an(e).put(new On(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.co(e).next(function(e){e||(t.isPrimary=!1,t.Tr.uo(function(){return t.Kh(!1)}))})}).next(function(){return t._o(e)}).next(function(n){return t.isPrimary&&!n?t.lo(e).next(function(){return!1}):!!n&&t.do(e).next(function(){return!0})})}).catch(function(e){if(!t.allowTabSynchronization){if(qn(e))return de("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;throw e}return de("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Tr.uo(function(){return t.Kh(e)}),t.isPrimary=e})},t.prototype.co=function(t){var e=this;return un(t).get(En.key).next(function(t){return xe.resolve(e.fo(t))})},t.prototype.To=function(t){return an(t).delete(this.clientId)},t.prototype.Eo=function(){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(e){switch(e.label){case 0:return!this.isPrimary||this.Io(this.jh,18e5)?[3,2]:(this.jh=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(e){var r=t.Nr(e,On.store);return r.Fr().next(function(t){var e=n.wo(t,18e5),i=t.filter(function(t){return-1===e.indexOf(t)});return xe.forEach(i,function(t){return r.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:e.sent().forEach(function(t){n.window.localStorage.removeItem(n.Ro(t.clientId))}),e.label=2;case 2:return[2]}})})},t.prototype.io=function(){var t=this;this.Wh=this.Tr.yr("client_metadata_refresh",4e3,function(){return t.to().then(function(){return t.Eo()}).then(function(){return t.io()})})},t.prototype.fo=function(t){return!!t&&t.ownerId===this.clientId},t.prototype._o=function(t){var e=this;return un(t).get(En.key).next(function(n){if(null!==n&&e.Io(n.leaseTimestampMs,5e3)&&!e.Ao(n.ownerId)){if(e.fo(n)&&e.networkEnabled)return!0;if(!e.fo(n)){if(!n.allowTabSynchronization)throw new c(h.FAILED_PRECONDITION,rn);return!1}}return!(!e.networkEnabled||!e.inForeground)||an(t).Fr().next(function(t){return void 0===e.wo(t,5e3).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(t){return e.isPrimary!==t&&de("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.mo=function(){return e.__awaiter(this,void 0,void 0,function(){var t=this;return e.__generator(this,function(e){switch(e.label){case 0:return this.qh=!1,this.Po(),this.Wh&&(this.Wh.cancel(),this.Wh=null),this.Vo(),this.po(),[4,this.runTransaction("shutdown","readwrite",function(e){return t.lo(e).next(function(){return t.To(e)})}).catch(function(t){de("IndexedDbPersistence","Proceeding with shutdown despite failure: ",t)})];case 1:return e.sent(),this.Zh.close(),this.yo(),[2]}})})},t.prototype.wo=function(t,e){var n=this;return t.filter(function(t){return n.Io(t.updateTimeMs,e)&&!n.Ao(t.clientId)})},t.prototype.bo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return an(e).Fr().next(function(e){return t.wo(e,18e5).map(function(t){return t.clientId})})})},t.clearPersistence=function(n){return e.__awaiter(this,void 0,void 0,function(){var r;return e.__generator(this,function(e){switch(e.label){case 0:return t.Gh()?(r=n+t.Hh,[4,Pn.delete(r)]):[2,Promise.resolve()];case 1:return e.sent(),[2]}})})},Object.defineProperty(t.prototype,"ro",{get:function(){return this.qh},enumerable:!0,configurable:!0}),t.prototype.vo=function(t){return fn.So(t,this.serializer,this.jn,this.hh)},t.prototype.Do=function(){return this.Yh},t.prototype.Co=function(){return this.Qn},t.prototype.Fo=function(){return this.jn},t.prototype.runTransaction=function(t,e,n){var r=this;de("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Zh.runTransaction(o,Vn,function(o){return i=new on(o,r.Bh?r.Bh.next():Pe.dr),"readwrite-primary"===e?r.co(i).next(function(t){return!!t||r._o(i)}).next(function(e){if(!e)throw ye("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Tr.uo(function(){return r.Kh(!1)}),new c(h.FAILED_PRECONDITION,Re);return n(i)}).next(function(t){return r.do(i).next(function(){return t})}):r.No(i).next(function(){return n(i)})}).then(function(t){return i.Un(),t})},t.prototype.No=function(t){var e=this;return un(t).get(En.key).next(function(t){if(null!==t&&e.Io(t.leaseTimestampMs,5e3)&&!e.Ao(t.ownerId)&&!e.fo(t)&&(!e.allowTabSynchronization||!t.allowTabSynchronization))throw new c(h.FAILED_PRECONDITION,rn)})},t.prototype.do=function(t){var e=new En(this.clientId,this.allowTabSynchronization,Date.now());return un(t).put(En.key,e)},t.Gh=function(){return Pn.Gh()},t.$o=function(t){var e=t.ii.projectId;return t.ii.ln||(e+="."+t.ii.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.lo=function(t){var e=this,n=un(t);return n.get(En.key).next(function(t){return e.fo(t)?(de("IndexedDbPersistence","Releasing primary lease."),n.delete(En.key)):xe.resolve()})},t.prototype.Io=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(ye("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.eo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Qh=function(){t.Tr.uo(function(){return t.inForeground="visible"===t.document.visibilityState,t.to()})},this.document.addEventListener("visibilitychange",this.Qh),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Vo=function(){this.Qh&&(this.document.removeEventListener("visibilitychange",this.Qh),this.Qh=null)},t.prototype.so=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.Uh=function(){t.Po(),t.Tr.uo(function(){return t.mo()})},this.window.addEventListener("unload",this.Uh))},t.prototype.po=function(){this.Uh&&(this.window.removeEventListener("unload",this.Uh),this.Uh=null)},t.prototype.Ao=function(t){try{var e=null!==this.Jh.getItem(this.Ro(t));return de("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return ye("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.Po=function(){try{this.Jh.setItem(this.Ro(this.clientId),String(Date.now()))}catch(t){ye("Failed to set zombie client id.",t)}},t.prototype.yo=function(){try{this.Jh.removeItem(this.Ro(this.clientId))}catch(t){}},t.prototype.Ro=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function un(t){return sn.Nr(t,En.store)}function an(t){return sn.Nr(t,On.store)}sn.Hh="main";var hn=function(){function t(t,e){this.db=t,this.ko=new Xn(this,e)}return t.prototype.Lo=function(t){var e=this.Mo(t);return this.db.Do().Vh(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Mo=function(t){var e=0;return this.Oo(t,function(t){e++}).next(function(){return e})},t.prototype.js=function(t,e){return this.db.Do().js(t,e)},t.prototype.Oo=function(t,e){return this.xo(t,function(t,n){return e(n)})},t.prototype.yh=function(t,e,n){return cn(t,n)},t.prototype.vh=function(t,e,n){return cn(t,n)},t.prototype.Ah=function(t,e,n){return this.db.Do().Ah(t,e,n)},t.prototype.Bo=function(t,e){return cn(t,e)},t.prototype.qo=function(t,e){return function(t,e){var n=!1;return vn(t).Uo(function(r){return ln(t,r,e).next(function(t){return t&&(n=!0),xe.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.Qo=function(t,e){var n=this,r=this.db.Co().Yr(),i=[],o=0;return this.xo(t,function(s,u){if(u<=e){var a=n.qo(t,s).next(function(e){if(!e)return o++,r.Ln(t,s).next(function(){return r.kn(s),en(t).delete([0,qe(s.path)])})});i.push(a)}}).next(function(){return xe.vn(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.Ie(t.Oh);return this.db.Do().Ih(t,n)},t.prototype.Wo=function(t,e){return cn(t,e)},t.prototype.xo=function(t,e){var n,r=en(t),i=Pe.dr;return r.Ur({index:xn.documentTargetsIndex},function(t,r){var o=t[0],s=(t[1],r.path),u=r.sequenceNumber;0===o?(i!==Pe.dr&&e(new _(Fe(n)),i),i=u,n=s):i=Pe.dr}).next(function(){i!==Pe.dr&&e(new _(Fe(n)),i)})},t.prototype.jo=function(t){return this.db.Co().Zr(t)},t}();function cn(t,e){return en(t).put(function(t,e){return new xn(0,qe(t.path),e)}(e,t.Oh))}var fn=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.jn=n,this.hh=r,this.Ko={}}return t.So=function(e,n,r,i){return me(""!==e.uid),new t(e.t()?e.uid:"",n,r,i)},t.prototype.Go=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return dn(t).Ur({index:_n.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.zo=function(t,e,n){return this.Ho(t).next(function(e){return e.lastStreamToken=n.toBase64(),vn(t).put(e)})},t.prototype.Yo=function(t){return this.Ho(t).next(function(t){return A.fromBase64String(t.lastStreamToken)})},t.prototype.Jo=function(t,e){return this.Ho(t).next(function(n){return n.lastStreamToken=e.toBase64(),vn(t).put(n)})},t.prototype.Xo=function(t,e,n,r){var i=this,o=yn(t),s=dn(t);return s.add({}).next(function(u){me("number"==typeof u);for(var a=new ke(u,e,n,r),h=i.serializer.kh(i.userId,a),c=[],f=new Pt(function(t,e){return be(t.j(),e.j())}),l=0,p=r;l<p.length;l++){var d=p[l],y=Tn.key(i.userId,d.key.path,u);f=f.add(d.key.path.L()),c.push(s.put(h)),c.push(o.put(y,Tn.PLACEHOLDER))}return f.forEach(function(e){c.push(i.jn.Dr(t,e))}),t.qn(function(){i.Ko[u]=a.keys()}),xe.vn(c).next(function(){return a})})},t.prototype.Zo=function(t,e){var n=this;return dn(t).get(e).next(function(t){return t?(me(t.userId===n.userId),n.serializer.Lh(t)):null})},t.prototype.ta=function(t,e){var n=this;return this.Ko[e]?xe.resolve(this.Ko[e]):this.Zo(t,e).next(function(t){if(t){var r=t.keys();return n.Ko[e]=r,r}return null})},t.prototype.ea=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return dn(t).Ur({index:_n.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(me(e.batchId>=r),o=n.serializer.Lh(e)),i.done()}).next(function(){return o})},t.prototype.sa=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return dn(t).Ur({index:_n.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.ia=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return dn(t).Fr(_n.userMutationsIndex,n).next(function(t){return t.map(function(t){return e.serializer.Lh(t)})})},t.prototype.Gn=function(t,e){var n=this,r=Tn.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return yn(t).Ur({range:i},function(r,i,s){var u=r[0],a=r[1],h=r[2],c=Fe(a);if(u===n.userId&&e.path.isEqual(c))return dn(t).get(h).next(function(t){if(!t)throw ge();me(t.userId===n.userId),o.push(n.serializer.Lh(t))});s.done()}).next(function(){return o})},t.prototype.Xn=function(t,e){var n=this,r=new Pt(be),i=[];return e.forEach(function(e){var o=Tn.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=yn(t).Ur({range:s},function(t,i,o){var s=t[0],u=t[1],a=t[2],h=Fe(u);s===n.userId&&e.path.isEqual(h)?r=r.add(a):o.done()});i.push(u)}),xe.vn(i).next(function(){return n.na(t,r)})},t.prototype.nr=function(t,e){var n=this,r=e.path,i=r.length+1,o=Tn.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new Pt(be);return yn(t).Ur({range:s},function(t,e,o){var s=t[0],a=t[1],h=t[2],c=Fe(a);s===n.userId&&r.q(c)?c.length===i&&(u=u.add(h)):o.done()}).next(function(){return n.na(t,u)})},t.prototype.na=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(dn(t).get(e).next(function(t){if(null===t)throw ge();me(t.userId===n.userId),r.push(n.serializer.Lh(t))}))}),xe.vn(i).next(function(){return r})},t.prototype.ra=function(t,e){var n=this;return pn(t.Mh,this.userId,e).next(function(r){return t.qn(function(){n.ha(e.batchId)}),xe.forEach(r,function(e){return n.hh.Bo(t,e)})})},t.prototype.ha=function(t){delete this.Ko[t]},t.prototype.oa=function(t){var e=this;return this.Go(t).next(function(n){if(!n)return xe.resolve();var r=IDBKeyRange.lowerBound(Tn.prefixForUser(e.userId)),i=[];return yn(t).Ur({range:r},function(t,n,r){if(t[0]===e.userId){var o=Fe(t[1]);i.push(o)}else r.done()}).next(function(){me(0===i.length)})})},t.prototype.Ch=function(t,e){return ln(t,this.userId,e)},t.prototype.Ho=function(t){var e=this;return vn(t).get(this.userId).next(function(t){return t||new bn(e.userId,-1,"")})},t}();function ln(t,e,n){var r=Tn.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return yn(t).Ur({range:o,Dh:!0},function(t,n,r){var o=t[0],u=t[1];t[2],o===e&&u===i&&(s=!0),r.done()}).next(function(){return s})}function pn(t,e,n){var r=t.store(_n.store),i=t.store(Tn.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Ur({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){me(1===u)}));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=Tn.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return xe.vn(o).next(function(){return h})}function dn(t){return sn.Nr(t,_n.store)}function yn(t){return sn.Nr(t,Tn.store)}function vn(t){return sn.Nr(t,bn.store)}var gn=10,mn=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;me(n<r&&n>=0&&r<=gn);var o=new Mn(e);n<1&&r>=1&&(function(t){t.createObjectStore(En.store)}(t),function(t){t.createObjectStore(bn.store,{keyPath:bn.keyPath}),t.createObjectStore(_n.store,{keyPath:_n.keyPath,autoIncrement:!0}).createIndex(_n.userMutationsIndex,_n.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Tn.store)}(t),Ln(t),function(t){t.createObjectStore(An.store)}(t));var s=xe.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(xn.store),t.deleteObjectStore(Dn.store),t.deleteObjectStore(Sn.store)}(t),Ln(t)),s=s.next(function(){return t=o.store(Sn.store),e=new Sn(0,0,g.min().C(),0),t.put(Sn.key,e);var t,e})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(_n.store).Fr().next(function(n){t.deleteObjectStore(_n.store),t.createObjectStore(_n.store,{keyPath:_n.keyPath,autoIncrement:!0}).createIndex(_n.userMutationsIndex,_n.userMutationsKeyPath,{unique:!0});var r=e.store(_n.store),i=n.map(function(t){return r.put(t)});return xe.vn(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(On.store,{keyPath:On.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.removeAcknowledgedMutations(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(kn.store)}(t),i.addDocumentGlobal(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ensureSequenceNumbers(o)})),n<8&&r>=8&&(s=s.next(function(){return i.createCollectionParentIndex(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(An.store);e.createIndex(An.readTimeIndex,An.readTimeIndexPath,{unique:!1}),e.createIndex(An.collectionReadTimeIndex,An.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.rewriteCanonicalIds(o)})),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(An.store).Ur(function(t,n){e+=Je(n)}).next(function(){var n=new kn(e);return t.store(kn.store).put(kn.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(bn.store),r=t.store(_n.store);return n.Fr().next(function(n){return xe.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Fr(_n.userMutationsIndex,i).next(function(r){return xe.forEach(r,function(r){me(r.userId===n.userId);var i=e.serializer.Lh(r);return pn(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(xn.store),n=t.store(An.store);return t.store(Sn.store).get(Sn.key).next(function(t){var r=[];return n.Ur(function(n,i){var o=new w(n),s=[0,qe(o)];r.push(e.get(s).next(function(n){return n?xe.resolve():function(n){return e.put(new xn(0,qe(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return xe.vn(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Rn.store,{keyPath:Rn.keyPath});var n=e.store(Rn.store),r=new ze,i=function(t){if(r.add(t)){var e=t.O(),i=t.L();return n.put({collectionId:e,parent:qe(i)})}};return e.store(An.store).Ur({Dh:!0},function(t,e){var n=new w(t);return i(n.L())}).next(function(){return e.store(Tn.store).Ur({Dh:!0},function(t,e){t[0];var n=t[1],r=(t[2],Fe(n));return i(r.L())})})},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(Dn.store);return n.Ur(function(t,r){var i=e.serializer.mh(r),o=e.serializer.Ph(i);return n.put(o)})},t}(),wn=function(t,e){this.seconds=t,this.nanoseconds=e},En=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};En.store="owner",En.key="owner";var bn=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};bn.store="mutationQueues",bn.keyPath="userId";var _n=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};_n.store="mutations",_n.keyPath="batchId",_n.userMutationsIndex="userMutationsIndex",_n.userMutationsKeyPath=["userId","batchId"];var Tn=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,qe(e)]},t.key=function(t,e,n){return[t,qe(e),n]},t}();Tn.store="documentMutations",Tn.PLACEHOLDER=new Tn;var In=function(t,e){this.path=t,this.readTime=e},Nn=function(t,e){this.path=t,this.version=e},An=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};An.store="remoteDocuments",An.readTimeIndex="readTimeIndex",An.readTimeIndexPath="readTime",An.collectionReadTimeIndex="collectionReadTimeIndex",An.collectionReadTimeIndexPath=["parentPath","readTime"];var kn=function(t){this.byteSize=t};kn.store="remoteDocumentGlobal",kn.key="remoteDocumentGlobalKey";var Dn=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Dn.store="targets",Dn.keyPath="targetId",Dn.queryTargetsIndexName="queryTargetsIndex",Dn.queryTargetsKeyPath=["canonicalId","targetId"];var xn=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};xn.store="targetDocuments",xn.keyPath=["targetId","path"],xn.documentTargetsIndex="documentTargetsIndex",xn.documentTargetsKeyPath=["path","targetId"];var Sn=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Sn.key="targetGlobalKey",Sn.store="targetGlobal";var Rn=function(t,e){this.collectionId=t,this.parent=e};function Ln(t){t.createObjectStore(xn.store,{keyPath:xn.keyPath}).createIndex(xn.documentTargetsIndex,xn.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Dn.store,{keyPath:Dn.keyPath}).createIndex(Dn.queryTargetsIndexName,Dn.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Sn.store)}Rn.store="collectionParents",Rn.keyPath=["collectionId","parent"];var On=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};On.store="clientMetadata",On.keyPath="clientId";var Vn=e.__spreadArrays(e.__spreadArrays(e.__spreadArrays([bn.store,_n.store,Tn.store,An.store,Dn.store,En.store,Sn.store,xn.store],[On.store]),[kn.store]),[Rn.store]),Pn=function(){function t(e){this.db=e,12.2===t.aa(i.getUA())&&ye("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.Xh=function(e,n,r){return de("SimpleDb","Opening database:",e),new xe(function(i,o){var s=window.indexedDB.open(e,n);s.onsuccess=function(e){var n=e.target.result;i(new t(n))},s.onblocked=function(){o(new c(h.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=function(t){var e=t.target.error;"VersionError"===e.name?o(new c(h.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o(e)},s.onupgradeneeded=function(t){de("SimpleDb",'Database "'+e+'" requires upgrade from version:',t.oldVersion);var n=t.target.result;r.createOrUpgrade(n,s.transaction,t.oldVersion,gn).next(function(){de("SimpleDb","Database upgrade to version "+gn+" complete")})}}).yn()},t.delete=function(t){return de("SimpleDb","Removing database:",t),Fn(window.indexedDB.deleteDatabase(t)).yn()},t.Gh=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(t.ua())return!0;if(void 0===window.navigator)return!1;var e=i.getUA(),n=t.aa(e),r=0<n&&n<10,o=t.ca(e),s=0<o&&o<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)},t.ua=function(){var t;return"undefined"!=typeof __PRIVATE_process&&"YES"===(null===(t=__PRIVATE_process.__PRIVATE_env)||void 0===t?void 0:t._a)},t.Nr=function(t,e){return t.store(e)},t.aa=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.ca=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.oo=function(t){this.db.onversionchange=function(e){return t(e)}},t.prototype.runTransaction=function(t,n,r){return e.__awaiter(this,void 0,void 0,function(){var i,o,s,u,a;return e.__generator(this,function(h){switch(h.label){case 0:i="readonly"===t,o=0,s=function(){var t,s,a,h,c;return e.__generator(this,function(e){switch(e.label){case 0:++o,t=Mn.open(u.db,i?"readonly":"readwrite",n),e.label=1;case 1:return e.trys.push([1,3,,4]),s=r(t).catch(function(e){return t.abort(e),xe.reject(e)}).yn(),a={},s.catch(function(){}),[4,t.la];case 2:return[2,(a.value=(e.sent(),s),a)];case 3:return h=e.sent(),c="FirebaseError"!==h.name&&o<3,de("SimpleDb","Transaction failed with error: %s. Retrying: %s.",h.message,c),c?[3,4]:[2,{value:Promise.reject(h)}];case 4:return[2]}})},u=this,h.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=h.sent()))return[2,a.value];h.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db.close()},t}(),Un=function(){function t(t){this.da=t,this.fa=!1,this.Ta=null}return Object.defineProperty(t.prototype,"Pn",{get:function(){return this.fa},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Ea",{get:function(){return this.Ta},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.da=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.fa=!0},t.prototype.Qr=function(t){this.Ta=t},t.prototype.delete=function(){return Fn(this.da.delete())},t}(),Cn=function(t){function n(e){var n=this;return(n=t.call(this,h.UNAVAILABLE,"IndexedDB transaction failed: "+e)||this).name="IndexedDbTransactionError",n}return e.__extends(n,t),n}(c);function qn(t){return"IndexedDbTransactionError"===t.name}var Mn=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.Ia=new Ue,this.transaction.oncomplete=function(){e.Ia.resolve()},this.transaction.onabort=function(){t.error?e.Ia.reject(new Cn(t.error)):e.Ia.resolve()},this.transaction.onerror=function(t){var n=zn(t.target.error);e.Ia.reject(new Cn(n))}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"la",{get:function(){return this.Ia.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this.Ia.reject(t),this.aborted||(de("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new jn(e)},t}(),jn=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(de("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(de("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Fn(n)},t.prototype.add=function(t){return de("SimpleDb","ADD",this.store.name,t,t),Fn(this.store.add(t))},t.prototype.get=function(t){var e=this;return Fn(this.store.get(t)).next(function(n){return void 0===n&&(n=null),de("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return de("SimpleDb","DELETE",this.store.name,t),Fn(this.store.delete(t))},t.prototype.count=function(){return de("SimpleDb","COUNT",this.store.name),Fn(this.store.count())},t.prototype.Fr=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.wa(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.Ra=function(t,e){de("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Dh=!1;var r=this.cursor(n);return this.wa(r,function(t,e,n){return n.delete()})},t.prototype.Ur=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.wa(r,e)},t.prototype.Uo=function(t){var e=this.cursor({});return new xe(function(n,r){e.onerror=function(t){var e=zn(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.wa=function(t,e){var n=[];return new xe(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Un(i),s=e(i.primaryKey,i.value,o);if(s instanceof xe){var u=s.catch(function(t){return o.done(),xe.reject(t)});n.push(u)}o.Pn?r():null===o.Ea?i.continue():i.continue(o.Ea)}else r()}}).next(function(){return xe.vn(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Dh?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Fn(t){return new xe(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=zn(t.target.error);n(e)}})}var Bn=!1;function zn(t){var e=Pn.aa(i.getUA());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new c("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Bn||(Bn=!0,setTimeout(function(){throw r},0)),r}}return t}var Gn=function(){function t(t,e,n,r,i){this.Aa=t,this.Er=e,this.ma=n,this.op=r,this.Pa=i,this.Va=new Ue,this.then=this.Va.promise.then.bind(this.Va.promise),this.Va.promise.catch(function(t){})}return t.ga=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.pa=setTimeout(function(){return e.ya()},t)},t.prototype.vr=function(){return this.ya()},t.prototype.cancel=function(t){null!==this.pa&&(this.clearTimeout(),this.Va.reject(new c(h.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.ya=function(){var t=this;this.Aa.uo(function(){return null!==t.pa?(t.clearTimeout(),t.op().then(function(e){return t.Va.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.pa&&(this.Pa(this),clearTimeout(this.pa),this.pa=null)},t}(),Wn=function(){function t(){var t=this;this.ba=Promise.resolve(),this.va=Promise.resolve(),this.Sa=!1,this.Da=[],this.Ca=null,this.Fa=!1,this.Na=[],this.$a=new Ce(this,"async_queue_retry"),this.ka=function(){return t.$a.br()};var e=ce.nt().window;e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.ka)}return Object.defineProperty(t.prototype,"La",{get:function(){return this.Sa},enumerable:!0,configurable:!0}),t.prototype.uo=function(t){this.enqueue(t)},t.prototype.Ma=function(t){this.Oa(),this.xa(t)},t.prototype.Ba=function(t){return this.Oa(),this.xa(t)},t.prototype.qa=function(t){return e.__awaiter(this,void 0,void 0,function(){var n;return e.__generator(this,function(e){switch(e.label){case 0:return this.Oa(),this.Sa?[3,2]:(this.Sa=!0,(n=ce.nt().window)&&n.removeEventListener("visibilitychange",this.ka),[4,this.Ba(t)]);case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.enqueue=function(t){return this.Oa(),this.Sa?new Promise(function(t){}):this.xa(t)},t.prototype.Ua=function(t){var n=this;this.Oa(),this.Sa||(this.va=this.va.then(function(){var r=new Ue,i=function(){return e.__awaiter(n,void 0,void 0,function(){var n;return e.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,t()];case 1:return e.sent(),r.resolve(),this.$a.reset(),[3,3];case 2:if(!qn(n=e.sent()))throw r.resolve(),n;return de("AsyncQueue","Operation failed with retryable error: "+n),this.$a.gr(i),[3,3];case 3:return[2]}})})};return n.uo(i),r.promise}))},t.prototype.xa=function(t){var e=this,n=this.ba.then(function(){return e.Fa=!0,t().catch(function(t){throw e.Ca=t,e.Fa=!1,ye("INTERNAL UNHANDLED ERROR: ",t.stack||t.message||""),t}).then(function(t){return e.Fa=!1,t})});return this.ba=n,n},t.prototype.yr=function(t,e,n){var r=this;this.Oa(),this.Na.indexOf(t)>-1&&(e=0);var i=Gn.ga(this,t,e,n,function(t){return r.Qa(t)});return this.Da.push(i),i},t.prototype.Oa=function(){this.Ca&&ge()},t.prototype.Wa=function(){},t.prototype.ja=function(){return e.__awaiter(this,void 0,void 0,function(){var t;return e.__generator(this,function(e){switch(e.label){case 0:return[4,t=this.ba];case 1:e.sent(),e.label=2;case 2:if(t!==this.ba)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Ka=function(t){for(var e=0,n=this.Da;e<n.length;e++)if(n[e].Er===t)return!0;return!1},t.prototype.Ga=function(t){var e=this;return this.ja().then(function(){e.Da.sort(function(t,e){return t.ma-e.ma});for(var n=0,r=e.Da;n<r.length;n++){var i=r[n];if(i.vr(),"all"!==t&&i.Er===t)break}return e.ja()})},t.prototype.za=function(t){this.Na.push(t)},t.prototype.Qa=function(t){var e=this.Da.indexOf(t);this.Da.splice(e,1)},t}();function Qn(t,e){if(ye("AsyncQueue",e+": "+t),qn(t))return new c(h.UNAVAILABLE,e+": "+t);throw t}function Kn(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=be(n,i);return 0===s?be(r,o):s}var Yn=function(){function t(t){this.Ha=t,this.buffer=new Pt(Kn),this.Ya=0}return t.prototype.Ja=function(){return++this.Ya},t.prototype.Xa=function(t){var e=[t,this.Ja()];if(this.buffer.size<this.Ha)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Kn(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),$n={Za:!1,tu:0,eu:0,su:0},Jn=function(){function t(t,e,n){this.iu=t,this.nu=e,this.ru=n}return t.hu=function(e){return new t(e,t.ou,t.au)},t}();Jn.uu=-1,Jn.cu=1048576,Jn._u=41943040,Jn.ou=10,Jn.au=1e3,Jn.lu=new Jn(Jn._u,Jn.ou,Jn.au),Jn.DISABLED=new Jn(Jn.uu,0,0);var Hn=function(){function t(t,e){this.ko=t,this.Aa=e,this.du=!1,this.fu=null}return t.prototype.start=function(t){this.ko.Tu.iu!==Jn.uu&&this.Eu(t)},t.prototype.stop=function(){this.fu&&(this.fu.cancel(),this.fu=null)},Object.defineProperty(t.prototype,"ro",{get:function(){return null!==this.fu},enumerable:!0,configurable:!0}),t.prototype.Eu=function(t){var n=this,r=this.du?3e5:6e4;de("LruGarbageCollector","Garbage collection scheduled in "+r+"ms"),this.fu=this.Aa.yr("lru_garbage_collection",r,function(){return e.__awaiter(n,void 0,void 0,function(){var n;return e.__generator(this,function(e){switch(e.label){case 0:this.fu=null,this.du=!0,e.label=1;case 1:return e.trys.push([1,3,,7]),[4,t.Iu(this.ko)];case 2:return e.sent(),[3,7];case 3:return qn(n=e.sent())?(de("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n),[3,6]):[3,4];case 4:return[4,er(n)];case 5:e.sent(),e.label=6;case 6:return[3,7];case 7:return[4,this.Eu(t)];case 8:return e.sent(),[2]}})})})},t}(),Xn=function(){function t(t,e){this.wu=t,this.Tu=e}return t.prototype.Ru=function(t,e){return this.wu.Lo(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.Au=function(t,e){var n=this;if(0===e)return xe.resolve(Pe.dr);var r=new Yn(e);return this.wu.js(t,function(t){return r.Xa(t.sequenceNumber)}).next(function(){return n.wu.Oo(t,function(t){return r.Xa(t)})}).next(function(){return r.maxValue})},t.prototype.Ah=function(t,e,n){return this.wu.Ah(t,e,n)},t.prototype.Qo=function(t,e){return this.wu.Qo(t,e)},t.prototype.mu=function(t,e){var n=this;return this.Tu.iu===Jn.uu?(de("LruGarbageCollector","Garbage collection skipped; disabled"),xe.resolve($n)):this.jo(t).next(function(r){return r<n.Tu.iu?(de("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.Tu.iu),$n):n.Pu(t,e)})},t.prototype.jo=function(t){return this.wu.jo(t)},t.prototype.Pu=function(t,e){var n,i,o,s,u,a,h,c=this,f=Date.now();return this.Ru(t,this.Tu.nu).next(function(e){return e>c.Tu.ru?(de("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.Tu.ru+" from "+e),i=c.Tu.ru):i=e,s=Date.now(),c.Au(t,i)}).next(function(r){return n=r,u=Date.now(),c.Ah(t,n,e)}).next(function(e){return o=e,a=Date.now(),c.Qo(t,n)}).next(function(t){return h=Date.now(),le()<=r.LogLevel.DEBUG&&de("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),xe.resolve({Za:!0,tu:i,eu:o,su:t})})},t}(),Zn=function(){function t(t,e,n){this.persistence=t,this.Vu=e,this.gu=new Lt(be),this.pu=new Ae(function(t){return t.canonicalId()}),this.yu=g.min(),this.Wn=t.vo(n),this.bu=t.Co(),this.Yh=t.Do(),this.vu=new Oe(this.bu,this.Wn,this.persistence.Fo()),this.Vu.Su(this.vu)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Du=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r,i,o=this;return e.__generator(this,function(e){switch(e.label){case 0:return n=this.Wn,r=this.vu,[4,this.persistence.runTransaction("Handle user change","readonly",function(e){var i;return o.Wn.ia(e).next(function(s){return i=s,n=o.persistence.vo(t),r=new Oe(o.bu,n,o.persistence.Fo()),n.ia(e)}).next(function(t){for(var n=[],o=[],s=Wt(),u=0,a=i;u<a.length;u++){var h=a[u];n.push(h.batchId);for(var c=0,f=h.mutations;c<f.length;c++){var l=f[c];s=s.add(l.key)}}for(var p=0,d=t;p<d.length;p++){var y=d[p];o.push(y.batchId);for(var v=0,g=y.mutations;v<g.length;v++){var m=g[v];s=s.add(m.key)}}return r.Yn(e,s).next(function(t){return{Cu:t,Fu:n,Nu:o}})})})];case 1:return i=e.sent(),[2,(this.Wn=n,this.vu=r,this.Vu.Su(this.vu),i)]}})})},t.prototype.$u=function(t){var e,n=this,r=v.now(),i=t.reduce(function(t,e){return t.add(e.key)},Wt());return this.persistence.runTransaction("Locally write mutations","readwrite",function(o){return n.vu.Yn(o,i).next(function(i){e=i;for(var s=[],u=0,a=t;u<a.length;u++){var h=a[u],c=h.Pt(e.get(h.key));null!=c&&s.push(new ot(h.key,c,ft(c.proto.mapValue),nt.exists(!0)))}return n.Wn.Xo(o,r,s,t)})}).then(function(t){var n=t.In(e);return{batchId:t.batchId,Dn:n}})},t.prototype.zo=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(n){var r=t.batch.keys(),i=e.bu.Yr({Xr:!0});return e.Wn.zo(n,t.batch,t.streamToken).next(function(){return e.ku(n,t,i)}).next(function(){return i.apply(n)}).next(function(){return e.Wn.oa(n)}).next(function(){return e.vu.Yn(n,r)})})},t.prototype.Lu=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(n){var r;return e.Wn.Zo(n,t).next(function(t){return me(null!==t),r=t.keys(),e.Wn.ra(n,t)}).next(function(){return e.Wn.oa(n)}).next(function(){return e.vu.Yn(n,r)})})},t.prototype.sa=function(){var t=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(e){return t.Wn.sa(e)})},t.prototype.Yo=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly",function(e){return t.Wn.Yo(e)})},t.prototype.Jo=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(n){return e.Wn.Jo(n,t)})},t.prototype._h=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.Yh._h(e)})},t.prototype.Mu=function(e){var n=this,r=e.Ee,i=this.gu;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var s=n.bu.Yr({Xr:!0});i=n.gu;var u=[];e.as.forEach(function(e,s){var a=i.get(s);if(a){u.push(n.Yh.bh(o,e.Is,s).next(function(){return n.Yh.ph(o,e.Ts,s)}));var h=e.resumeToken;if(h.rt()>0){var c=a.we(h,r).Ie(o.Oh);i=i.Ae(s,c),t.Ou(a,c,e)&&u.push(n.Yh.Ih(o,c))}}});var a=qt(),h=Wt();if(e.cs.forEach(function(t,e){h=h.add(t)}),u.push(s.getEntries(o,h).next(function(t){e.cs.forEach(function(i,h){var c=t.get(i);h instanceof vt&&h.version.isEqual(g.min())?(s.kn(i,r),a=a.Ae(i,h)):null==c||h.version.S(c.version)>0||0===h.version.S(c.version)&&c.hasPendingWrites?(s.Nn(h,r),a=a.Ae(i,h)):de("LocalStore","Ignoring outdated watch update for ",i,". Current version:",c.version," Watch version:",h.version),e._s.has(i)&&u.push(n.persistence.hh.Wo(o,i))})})),!r.isEqual(g.min())){var c=n.Yh._h(o).next(function(t){return n.Yh.dh(o,o.Oh,r)});u.push(c)}return xe.vn(u).next(function(){return s.apply(o)}).next(function(){return n.vu.Jn(o,a)})}).then(function(t){return n.gu=i,t})},t.Ou=function(t,e,n){return me(e.resumeToken.rt()>0),0===t.resumeToken.rt()||e.Ee.D()-t.Ee.D()>=this.xu||n.Ts.size+n.Es.size+n.Is.size>0},t.prototype.Bu=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r,i,o,s,u,a,h,c=this;return e.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return xe.forEach(t,function(t){return xe.forEach(t.hr,function(n){return c.persistence.hh.yh(e,t.targetId,n)}).next(function(){return xe.forEach(t.or,function(n){return c.persistence.hh.vh(e,t.targetId,n)})})})})];case 1:return e.sent(),[3,3];case 2:if(!qn(n=e.sent()))throw n;return de("LocalStore","Failed to update sequence numbers: "+n),[3,3];case 3:for(r=0,i=t;r<i.length;r++)o=i[r],s=o.targetId,o.fromCache||(u=this.gu.get(s),a=u.Ee,h=u.Re(a),this.gu=this.gu.Ae(s,h));return[2]}})})},t.prototype.qu=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(n){return void 0===t&&(t=-1),e.Wn.ea(n,t)})},t.prototype.Uu=function(t){var e=this;return this.persistence.runTransaction("read document","readonly",function(n){return e.vu.Kn(n,t)})},t.prototype.Qu=function(t){var e=this;return this.persistence.runTransaction("Allocate target","readwrite",function(n){var r;return e.Yh.gh(n,t).next(function(i){return i?(r=i,xe.resolve(r)):e.Yh.oh(n).next(function(i){return r=new Dt(t,i,0,n.Oh),e.Yh.fh(n,r).next(function(){return r})})})}).then(function(n){return null===e.gu.get(n.targetId)&&(e.gu=e.gu.Ae(n.targetId,n),e.pu.set(t,n.targetId)),n})},t.prototype.gh=function(t,e){var n=this.pu.get(e);return void 0!==n?xe.resolve(this.gu.get(n)):this.Yh.gh(t,e)},t.prototype.Wu=function(t,e){var n=this,r=this.gu.get(t),i=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",i,function(t){return e?xe.resolve():n.persistence.hh.removeTarget(t,r)}).then(function(){n.gu=n.gu.remove(t),n.pu.delete(r.target)})},t.prototype.ju=function(t,e){var n=this,r=g.min(),i=Wt();return this.persistence.runTransaction("Execute query","readonly",function(o){return n.gh(o,t.ee()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,n.Yh.Sh(o,t.targetId).next(function(t){i=t})}).next(function(){return n.Vu.Zn(o,t,e?r:g.min(),e?i:Wt())}).next(function(t){return{documents:t,Ku:i}})})},t.prototype.ku=function(t,e,n){var r=this,i=e.batch,o=i.keys(),s=xe.resolve();return o.forEach(function(r){s=s.next(function(){return n.Ln(t,r)}).next(function(t){var o=t,s=e.Rn.get(r);me(null!==s),(!o||o.version.S(s)<0)&&(o=i.at(r,o,e))&&n.Nn(o,e.wn)})}),s.next(function(){return r.Wn.ra(t,i)})},t.prototype.Iu=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.mu(n,e.gu)})},t}();Zn.xu=3e8;var tr=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).persistence=e,i.Wn=e.vo(r),i.bu=e.Co(),i.Yh=e.Do(),i}return e.__extends(n,t),n.prototype.start=function(){return this.Gu()},n.prototype.zu=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(n){return e.Wn.ta(n,t).next(function(t){return t?e.vu.Yn(n,t):xe.resolve(null)})})},n.prototype.Hu=function(t){this.Wn.ha(t)},n.prototype.ao=function(t){this.persistence.ao(t)},n.prototype.bo=function(){return this.persistence.bo()},n.prototype.Yu=function(t){var e=this,n=this.gu.get(t);return n?Promise.resolve(n.target):this.persistence.runTransaction("Get target data","readonly",function(n){return e.Yh.si(n,t).next(function(t){return t?t.target:null})})},n.prototype.Kr=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly",function(e){return t.bu.Kr(e,t.yu)}).then(function(e){var n=e.Gr,r=e.readTime;return t.yu=r,n})},n.prototype.Gu=function(){return e.__awaiter(this,void 0,void 0,function(){var t,n=this;return e.__generator(this,function(e){switch(e.label){case 0:return t=this,[4,this.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.bu.Hr(t)})];case 1:return t.yu=e.sent(),[2]}})})},n}(Zn);function er(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){if(t.code!==h.FAILED_PRECONDITION||t.message!==Re)throw t;return de("LocalStore","Unexpectedly lost primary lease"),[2]})})}var nr=function(){function t(){this.Ju=new Pt(rr.Xu),this.Zu=new Pt(rr.tc)}return t.prototype.B=function(){return this.Ju.B()},t.prototype.yh=function(t,e){var n=new rr(t,e);this.Ju=this.Ju.add(n),this.Zu=this.Zu.add(n)},t.prototype.ec=function(t,e){var n=this;t.forEach(function(t){return n.yh(t,e)})},t.prototype.vh=function(t,e){this.sc(new rr(t,e))},t.prototype.ic=function(t,e){var n=this;t.forEach(function(t){return n.vh(t,e)})},t.prototype.nc=function(t){var e=this,n=_.EMPTY,r=new rr(n,t),i=new rr(n,t+1),o=[];return this.Zu.Ke([r,i],function(t){e.sc(t),o.push(t.key)}),o},t.prototype.rc=function(){var t=this;this.Ju.forEach(function(e){return t.sc(e)})},t.prototype.sc=function(t){this.Ju=this.Ju.delete(t),this.Zu=this.Zu.delete(t)},t.prototype.hc=function(t){var e=_.EMPTY,n=new rr(e,t),r=new rr(e,t+1),i=Wt();return this.Zu.Ke([n,r],function(t){i=i.add(t.key)}),i},t.prototype.Ch=function(t){var e=new rr(t,0),n=this.Ju.ze(e);return null!==n&&t.isEqual(n.key)},t}(),rr=function(){function t(t,e){this.key=t,this.oc=e}return t.Xu=function(t,e){return _.N(t.key,e.key)||be(t.oc,e.oc)},t.tc=function(t,e){return be(t.oc,e.oc)||_.N(t.key,e.key)},t}();function ir(t,e){if(0!==e.length)throw new c(h.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+br(e.length,"argument")+".")}function or(t,e,n){if(e.length!==n)throw new c(h.INVALID_ARGUMENT,"Function "+t+"() requires "+br(n,"argument")+", but was called with "+br(e.length,"argument")+".")}function sr(t,e,n){if(e.length<n)throw new c(h.INVALID_ARGUMENT,"Function "+t+"() requires at least "+br(n,"argument")+", but was called with "+br(e.length,"argument")+".")}function ur(t,e,n,r){if(e.length<n||e.length>r)throw new c(h.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+br(e.length,"argument")+".")}function ar(t,e,n,r){pr(t,e,Er(n)+" argument",r)}function hr(t,e,n,r){void 0!==r&&ar(t,e,n,r)}function cr(t,e,n,r){pr(t,e,n+" option",r)}function fr(t,e,n,r){void 0!==r&&cr(t,e,n,r)}function lr(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],s=0,u=i;s<u.length;s++){var a=u[s];if(a===r)return;o.push(yr(a))}var f=yr(r);throw new c(h.INVALID_ARGUMENT,"Invalid value "+f+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function pr(t,e,n,r){if(!("object"===e?dr(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=yr(r);throw new c(h.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function dr(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function yr(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":ge()}function vr(t,e,n){if(void 0===n)throw new c(h.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Er(e)+" argument, but it was undefined.")}function gr(t,e,n){I(e,function(e,r){if(n.indexOf(e)<0)throw new c(h.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))})}function mr(t,e,n,r){var i=yr(r);return new c(h.INVALID_ARGUMENT,"Function "+t+"() requires its "+Er(n)+" argument to be a "+e+", but it was: "+i)}function wr(t,e,n){if(n<=0)throw new c(h.INVALID_ARGUMENT,"Function "+t+"() requires its "+Er(e)+" argument to be a positive number, but it was: "+n+".")}function Er(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function br(t,e){return t+" "+e+(1===t?"":"s")}function _r(){if("undefined"==typeof Uint8Array)throw new c(h.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Tr(){if(!ce.nt().ac)throw new c(h.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ir=function(){function t(t){Tr(),this.uc=t}return t.fromBase64String=function(e){or("Blob.fromBase64String",arguments,1),ar("Blob.fromBase64String","string",1,e),Tr();try{return new t(A.fromBase64String(e))}catch(e){throw new c(h.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+e)}},t.fromUint8Array=function(e){if(or("Blob.fromUint8Array",arguments,1),_r(),!(e instanceof Uint8Array))throw mr("Blob.fromUint8Array","Uint8Array",1,e);return new t(A.fromUint8Array(e))},t.prototype.toBase64=function(){return or("Blob.toBase64",arguments,0),Tr(),this.uc.toBase64()},t.prototype.toUint8Array=function(){return or("Blob.toUint8Array",arguments,0),_r(),this.uc.toUint8Array()},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.uc.isEqual(t.uc)},t}(),Nr=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new c(h.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+br(1,"element")+".")}(0,t);for(var n=0;n<t.length;++n)if(ar("FieldPath","string",n,t[n]),0===t[n].length)throw new c(h.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.cc=new b(t)}return t.documentId=function(){return t._c},t.prototype.isEqual=function(e){if(!(e instanceof t))throw mr("isEqual","FieldPath",1,e);return this.cc.isEqual(e.cc)},t}();Nr._c=new Nr(b.J().j());var Ar=new RegExp("[~\\*/\\[\\]]"),kr=function(t){this.lc=t},Dr=function(t){function n(){return t.call(this,"FieldValue.delete")||this}return e.__extends(n,t),n.prototype.Di=function(t){if(2!==t.dc)throw 1===t.dc?t.fc("FieldValue.delete() can only appear at the top level of your update data"):t.fc("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");return t.Vt.push(t.path),null},n.prototype.isEqual=function(t){return t instanceof n},n}(kr),xr=function(t){function n(){return t.call(this,"FieldValue.serverTimestamp")||this}return e.__extends(n,t),n.prototype.Di=function(t){return new tt(t.path,Y.instance)},n.prototype.isEqual=function(t){return t instanceof n},n}(kr),Sr=function(t){function n(e){var n=this;return(n=t.call(this,"FieldValue.arrayUnion")||this).Tc=e,n}return e.__extends(n,t),n.prototype.Di=function(t){var e=new qr({dc:3,methodName:this.lc,Ec:!0},t.ii,t.serializer,t.ignoreUndefinedProperties),n=this.Tc.map(function(t){return jr(t,e)}),r=new $(n);return new tt(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(kr),Rr=function(t){function n(e){var n=this;return(n=t.call(this,"FieldValue.arrayRemove")||this).Tc=e,n}return e.__extends(n,t),n.prototype.Di=function(t){var e=new qr({dc:3,methodName:this.lc,Ec:!0},t.ii,t.serializer,t.ignoreUndefinedProperties),n=this.Tc.map(function(t){return jr(t,e)}),r=new J(n);return new tt(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(kr),Lr=function(t){function n(e){var n=this;return(n=t.call(this,"FieldValue.increment")||this).Ic=e,n}return e.__extends(n,t),n.prototype.Di=function(t){var e=new qr({dc:3,methodName:this.lc},t.ii,t.serializer,t.ignoreUndefinedProperties),n=jr(this.Ic,e),r=new H(t.serializer,n);return new tt(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(kr),Or=function(){function t(t,e){if(or("GeoPoint",arguments,2),ar("GeoPoint","number",1,t),ar("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new c(h.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new c(h.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.wc=t,this.Rc=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.wc},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.Rc},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this.wc===t.wc&&this.Rc===t.Rc},t.prototype.p=function(t){return be(this.wc,t.wc)||be(this.Rc,t.Rc)},t}(),Vr=/^__.*__$/,Pr=function(){function t(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}return t.prototype.Ac=function(t,e){var n=[];return null!==this.Vt?n.push(new ot(t,this.data,this.Vt,e)):n.push(new it(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new st(t,this.fieldTransforms)),n},t}(),Ur=function(){function t(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}return t.prototype.Ac=function(t,e){var n=[new ot(t,this.data,this.Vt,e)];return this.fieldTransforms.length>0&&n.push(new st(t,this.fieldTransforms)),n},t}();function Cr(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ge()}}var qr=function(){function t(t,e,n,r,i,o){this.settings=t,this.ii=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.mc(),this.fieldTransforms=i||[],this.Vt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dc",{get:function(){return this.settings.dc},enumerable:!0,configurable:!0}),t.prototype.Pc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.ii,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Vt)},t.prototype.Vc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Pc({path:n,Ec:!1});return r.gc(t),r},t.prototype.pc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Pc({path:n,Ec:!1});return r.mc(),r},t.prototype.yc=function(t){return this.Pc({path:void 0,Ec:!0})},t.prototype.fc=function(t){var e=!this.path||this.path.B()?"":" (found in field "+this.path.toString()+")";return new c(h.INVALID_ARGUMENT,"Function "+this.settings.methodName+"() called with invalid data. "+t+e)},t.prototype.contains=function(t){return void 0!==this.Vt.find(function(e){return t.q(e)})||void 0!==this.fieldTransforms.find(function(e){return t.q(e.field)})},t.prototype.mc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.gc(this.path.get(t))},t.prototype.gc=function(t){if(0===t.length)throw this.fc("Document fields must not be empty");if(Cr(this.dc)&&Vr.test(t))throw this.fc('Document fields cannot begin and end with "__"')},t}(),Mr=function(){function t(t,e,n){this.ii=t,this.ignoreUndefinedProperties=e,this.serializer=n||ce.nt().bc(t)}return t.prototype.vc=function(t,e){var n=this.Sc(0,t);zr("Data must be an object, but it was:",n,e);var r=Fr(e,n);return new Pr(new ht(r),null,n.fieldTransforms)},t.prototype.Dc=function(t,e,n){var r=this.Sc(2,t);zr("Data must be an object, but it was:",r,e);var i,o,s=Fr(e,r);if(n){for(var u=[],a=0,f=n;a<f.length;a++){var l=f[a],p=void 0;if(l instanceof Nr)p=l.cc;else{if("string"!=typeof l)throw ge();p=Wr(t,l)}if(!r.contains(p))throw new c(h.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Qr(u,p)||u.push(p)}i=new Z(u),o=r.fieldTransforms.filter(function(t){return i.dt(t.field)})}else i=new Z(r.Vt),o=r.fieldTransforms;return new Pr(new ht(s),i,o)},t.prototype.Cc=function(t,e){var n=this.Sc(1,t);zr("Data must be an object, but it was:",n,e);var r=[],i=new ct;I(e,function(e,o){var s=Wr(t,e),u=n.pc(s);if(o instanceof Dr)r.push(s);else{var a=jr(o,u);null!=a&&(r.push(s),i.set(s,a))}});var o=new Z(r);return new Ur(i.yt(),o,n.fieldTransforms)},t.prototype.Fc=function(t,e,n,r){var i=this.Sc(1,t),o=[Gr(t,e)],s=[n];if(r.length%2!=0)throw new c(h.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<r.length;u+=2)o.push(Gr(t,r[u])),s.push(r[u+1]);for(var a=[],f=new ct,l=o.length-1;l>=0;--l)if(!Qr(a,o[l])){var p=o[l],d=s[l],y=i.pc(p);if(d instanceof Dr)a.push(p);else{var v=jr(d,y);null!=v&&(a.push(p),f.set(p,v))}}var g=new Z(a);return new Ur(f.yt(),g,i.fieldTransforms)},t.prototype.Sc=function(t,e){return new qr({dc:t,methodName:e,path:b.G,Ec:!1},this.ii,this.serializer,this.ignoreUndefinedProperties)},t.prototype.Nc=function(t,e,n){return void 0===n&&(n=!1),jr(e,this.Sc(n?4:3,t))},t}();function jr(t,e){if(Br(t))return zr("Unsupported field value:",e,t),Fr(t,e);if(t instanceof kr)return function(t,e){if(!Cr(e.dc))throw e.fc(t.lc+"() can only be used with update() and set()");if(null===e.path)throw e.fc(t.lc+"() is not currently supported inside arrays");var n=t.Di(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Vt.push(e.path),t instanceof Array){if(e.settings.Ec&&4!==e.dc)throw e.fc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=jr(o[i],e.yc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return e.serializer.ai(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=v.fromDate(t);return{timestampValue:e.serializer.C(n)}}if(t instanceof v){var r=new v(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:e.serializer.C(r)}}if(t instanceof Or)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ir)return{bytesValue:e.serializer.ui(t)};if(t instanceof Mi){var i=e.ii,o=t.firestore.$c;if(!o.isEqual(i))throw e.fc("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:e.serializer._i(t.kc.path,t.firestore.$c)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.fc("Unsupported field value: "+yr(t))}(t,e)}function Fr(t,e){var n={};return N(t)?e.path&&e.path.length>0&&e.Vt.push(e.path):I(t,function(t,r){var i=jr(r,e.Vc(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Br(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof v||t instanceof Or||t instanceof Ir||t instanceof Mi||t instanceof kr)}function zr(t,e,n){if(!Br(n)||!dr(n)){var r=yr(n);throw"an object"===r?e.fc(t+" a custom object"):e.fc(t+" "+r)}}function Gr(t,e){if(e instanceof Nr)return e.cc;if("string"==typeof e)return Wr(t,e);throw new c(h.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Wr(t,n){try{return function(t){if(t.search(Ar)>=0)throw new c(h.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Nr.bind.apply(Nr,e.__spreadArrays([void 0],t.split("."))))}catch(e){throw new c(h.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(n).cc}catch(n){var r=(i=n)instanceof Error?i.message:i.toString();throw new c(h.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+r)}var i}function Qr(t,e){return t.some(function(t){return t.isEqual(e)})}var Kr=function(){function t(t,e,n,r,i,o){this.Tr=t,this.Lc=n,this.Mc=r,this.Oc=i,this.listener=o,this.state=0,this.xc=0,this.Bc=null,this.stream=null,this.$a=new Ce(t,e)}return t.prototype.qc=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Uc=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Qc()},t.prototype.stop=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){switch(t.label){case 0:return this.qc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Wc=function(){this.state=0,this.$a.reset()},t.prototype.jc=function(){var t=this;this.Uc()&&null===this.Bc&&(this.Bc=this.Tr.yr(this.Lc,6e4,function(){return t.Kc()}))},t.prototype.Gc=function(t){this.zc(),this.stream.send(t)},t.prototype.Kc=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return this.Uc()?[2,this.close(0)]:[2]})})},t.prototype.zc=function(){this.Bc&&(this.Bc.cancel(),this.Bc=null)},t.prototype.close=function(t,n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return this.zc(),this.$a.cancel(),this.xc++,3!==t?this.$a.reset():n&&n.code===h.RESOURCE_EXHAUSTED?(ye(n.toString()),ye("Using maximum backoff delay to prevent overloading the backend."),this.$a.Vr()):n&&n.code===h.UNAUTHENTICATED&&this.Oc._(),null!==this.stream&&(this.Hc(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Yc(n)];case 1:return e.sent(),[2]}})})},t.prototype.Hc=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.Jc(this.xc),n=this.xc;this.Oc.getToken().then(function(e){t.xc===n&&t.Xc(e)},function(n){e(function(){var e=new c(h.UNKNOWN,"Fetching auth token failed: "+n.message);return t.Zc(e)})})},t.prototype.Xc=function(t){var e=this,n=this.Jc(this.xc);this.stream=this.t_(t),this.stream.e_(function(){n(function(){return e.state=2,e.listener.e_()})}),this.stream.Yc(function(t){n(function(){return e.Zc(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Qc=function(){var t=this;this.state=4,this.$a.gr(function(){return e.__awaiter(t,void 0,void 0,function(){return e.__generator(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.Zc=function(t){return de("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.Jc=function(t){var e=this;return function(n){e.Tr.uo(function(){return e.xc===t?n():(de("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Yr=function(t){function n(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return e.__extends(n,t),n.prototype.t_=function(t){return this.Mc.s_("Listen",t)},n.prototype.onMessage=function(t){this.$a.reset();var e=this.serializer.pi(t),n=this.serializer.bi(t);return this.listener.i_(e,n)},n.prototype.n_=function(t){var e={};e.database=this.serializer.wi,e.addTarget=this.serializer.ee(t);var n=this.serializer.zi(t);n&&(e.labels=n),this.Gc(e)},n.prototype.r_=function(t){var e={};e.database=this.serializer.wi,e.removeTarget=t,this.Gc(e)},n}(Kr),$r=function(t){function n(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s.h_=!1,s.lastStreamToken=A.ht,s}return e.__extends(n,t),Object.defineProperty(n.prototype,"o_",{get:function(){return this.h_},enumerable:!0,configurable:!0}),n.prototype.start=function(){this.h_=!1,t.prototype.start.call(this)},n.prototype.Hc=function(){this.h_&&this.a_([])},n.prototype.t_=function(t){return this.Mc.s_("Write",t)},n.prototype.onMessage=function(t){if(me(!!t.streamToken),this.lastStreamToken=this.serializer.ci(t.streamToken),this.h_){this.$a.reset();var e=this.serializer.Mi(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.u_(n,e)}return me(!t.writeResults||0===t.writeResults.length),this.h_=!0,this.listener.c_()},n.prototype.__=function(){var t={};t.database=this.serializer.wi,this.Gc(t)},n.prototype.a_=function(t){var e=this,n={streamToken:this.serializer.ui(this.lastStreamToken),writes:t.map(function(t){return e.serializer.vi(t)})};this.Gc(n)},n}(Kr),Jr=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).Mc=e,i.credentials=n,i.serializer=r,i}return e.__extends(n,t),n.prototype.d_=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.Mc.d_(t,e,r)}).catch(function(t){throw t.code===h.UNAUTHENTICATED&&n.credentials._(),t})},n.prototype.f_=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.Mc.f_(t,e,r)}).catch(function(t){throw t.code===h.UNAUTHENTICATED&&n.credentials._(),t})},n}(function(){this.l_=void 0}),Hr=function(){function t(t){this.T_=t,this.E_=zt(),this.mutations=[],this.I_=!1,this.w_=null,this.R_=new Set}return t.prototype.A_=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r=this;return e.__generator(this,function(i){switch(i.label){case 0:if(this.m_(),this.mutations.length>0)throw new c(h.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,n){return e.__awaiter(this,void 0,void 0,function(){var r,i,o,s,u;return e.__generator(this,function(e){switch(e.label){case 0:return r=we(t),i={database:r.serializer.wi,documents:n.map(function(t){return r.serializer.fi(t)})},[4,r.f_("BatchGetDocuments",i)];case 1:return o=e.sent(),s=new Map,o.forEach(function(t){var e=r.serializer.gi(t);s.set(e.key.toString(),e)}),u=[],[2,(n.forEach(function(t){var e=s.get(t.toString());me(!!e),u.push(e)}),u)]}})})}(this.T_,t)];case 1:return[2,((n=i.sent()).forEach(function(t){t instanceof vt||t instanceof yt?r.P_(t):ge()}),n)]}})})},t.prototype.set=function(t,e){this.write(e.Ac(t,this.Rt(t))),this.R_.add(t)},t.prototype.update=function(t,e){try{this.write(e.Ac(t,this.V_(t)))}catch(t){this.w_=t}this.R_.add(t)},t.prototype.delete=function(t){this.write([new ut(t,this.Rt(t))]),this.R_.add(t)},t.prototype.commit=function(){return e.__awaiter(this,void 0,void 0,function(){var t,n=this;return e.__generator(this,function(r){switch(r.label){case 0:if(this.m_(),this.w_)throw this.w_;return t=this.E_,this.mutations.forEach(function(e){t=t.remove(e.key)}),t.forEach(function(t,e){n.mutations.push(new at(t,n.Rt(t)))}),[4,function(t,n){return e.__awaiter(this,void 0,void 0,function(){var r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:return r=we(t),i={database:r.serializer.wi,writes:n.map(function(t){return r.serializer.vi(t)})},[4,r.d_("Commit",i)];case 1:return o=e.sent(),[2,r.serializer.Mi(o.writeResults,o.commitTime)]}})})}(this.T_,this.mutations)];case 1:return r.sent(),this.I_=!0,[2]}})})},t.prototype.P_=function(t){var e;if(t instanceof yt)e=t.version;else{if(!(t instanceof vt))throw ge();e=g.min()}var n=this.E_.get(t.key);if(null!==n){if(!e.isEqual(n))throw new c(h.ABORTED,"Document version changed between two reads.")}else this.E_=this.E_.Ae(t.key,e)},t.prototype.Rt=function(t){var e=this.E_.get(t);return!this.R_.has(t)&&e?nt.updateTime(e):nt.ft()},t.prototype.V_=function(t){var e=this.E_.get(t);if(!this.R_.has(t)&&e){if(e.isEqual(g.min()))throw new c(h.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return nt.updateTime(e)}return nt.exists(!0)},t.prototype.write=function(t){this.m_(),this.mutations=this.mutations.concat(t)},t.prototype.m_=function(){},t}(),Xr=function(){function t(t,e){this.Aa=t,this.g_=e,this.state="Unknown",this.p_=0,this.y_=null,this.b_=!0}return t.prototype.v_=function(){var t=this;0===this.p_&&(this.S_("Unknown"),this.y_=this.Aa.yr("online_state_timeout",1e4,function(){return t.y_=null,t.D_("Backend didn't respond within 10 seconds."),t.S_("Offline"),Promise.resolve()}))},t.prototype.C_=function(t){"Online"===this.state?this.S_("Unknown"):(this.p_++,this.p_>=1&&(this.F_(),this.D_("Connection failed 1 times. Most recent error: "+t.toString()),this.S_("Offline")))},t.prototype.set=function(t){this.F_(),this.p_=0,"Online"===t&&(this.b_=!1),this.S_(t)},t.prototype.S_=function(t){t!==this.state&&(this.state=t,this.g_(t))},t.prototype.D_=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.b_?(ye(e),this.b_=!1):de("OnlineStateTracker",e)},t.prototype.F_=function(){null!==this.y_&&(this.y_.cancel(),this.y_=null)},t}(),Zr=function(){function t(t,n,r,i,o){var s=this;this.N_=t,this.T_=n,this.Aa=r,this.k_=[],this.L_=new Map,this.M_=null,this.networkEnabled=!1,this.isPrimary=!1,this.O_=!1,this.x_=o,this.x_.B_(function(t){r.uo(function(){return e.__awaiter(s,void 0,void 0,function(){return e.__generator(this,function(t){switch(t.label){case 0:return this.q_()?(de("RemoteStore","Restarting streams for network reachability change."),[4,this.U_()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Q_=new Xr(r,i),this.W_=function(t,e,n){var r=we(t);return new Yr(e,r.Mc,r.credentials,r.serializer,n)}(this.T_,r,{e_:this.j_.bind(this),Yc:this.K_.bind(this),i_:this.G_.bind(this)}),this.z_=function(t,e,n){var r=we(t);return new $r(e,r.Mc,r.credentials,r.serializer,n)}(this.T_,r,{e_:this.H_.bind(this),Yc:this.Y_.bind(this),c_:this.J_.bind(this),u_:this.u_.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return this.networkEnabled=!0,this.X_()},t.prototype.X_=function(){return e.__awaiter(this,void 0,void 0,function(){var t;return e.__generator(this,function(e){switch(e.label){case 0:return this.q_()?(t=this.z_,[4,this.N_.Yo()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.Z_()?this.tl():this.Q_.set("Unknown"),[4,this.el()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.disableNetwork=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.sl()];case 1:return t.sent(),this.Q_.set("Offline"),[2]}})})},t.prototype.sl=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){switch(t.label){case 0:return[4,this.z_.stop()];case 1:return t.sent(),[4,this.W_.stop()];case 2:return t.sent(),this.k_.length>0&&(de("RemoteStore","Stopping write stream with "+this.k_.length+" pending writes"),this.k_=[]),this.il(),[2]}})})},t.prototype.mo=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){switch(t.label){case 0:return de("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.sl()];case 1:return t.sent(),this.x_.mo(),this.Q_.set("Unknown"),[2]}})})},t.prototype.listen=function(t){this.L_.has(t.targetId)||(this.L_.set(t.targetId,t),this.Z_()?this.tl():this.W_.Uc()&&this.nl(t))},t.prototype.rl=function(t){this.L_.delete(t),this.W_.Uc()&&this.hl(t),0===this.L_.size&&(this.W_.Uc()?this.W_.jc():this.q_()&&this.Q_.set("Unknown"))},t.prototype.si=function(t){return this.L_.get(t)||null},t.prototype.ei=function(t){return this.ol.ei(t)},t.prototype.nl=function(t){this.M_.Ns(t.targetId),this.W_.n_(t)},t.prototype.hl=function(t){this.M_.Ns(t),this.W_.r_(t)},t.prototype.tl=function(){this.M_=new re(this),this.W_.start(),this.Q_.v_()},t.prototype.Z_=function(){return this.q_()&&!this.W_.qc()&&this.L_.size>0},t.prototype.q_=function(){return!this.O_&&this.isPrimary&&this.networkEnabled},t.prototype.il=function(){this.M_=null},t.prototype.j_=function(){return e.__awaiter(this,void 0,void 0,function(){var t=this;return e.__generator(this,function(e){return this.L_.forEach(function(e,n){t.nl(e)}),[2]})})},t.prototype.K_=function(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return this.il(),this.Z_()?(this.Q_.C_(t),this.tl()):this.Q_.set("Unknown"),[2]})})},t.prototype.G_=function(t,n){return e.__awaiter(this,void 0,void 0,function(){var r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:if(this.Q_.set("Online"),!(t instanceof ee&&2===t.state&&t.cause))return[3,6];e.label=1;case 1:return e.trys.push([1,3,,5]),[4,this.al(t)];case 2:return e.sent(),[3,5];case 3:return r=e.sent(),de("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),[4,this.ul(r)];case 4:return e.sent(),[3,5];case 5:return[3,13];case 6:if(t instanceof Zt?this.M_.qs(t):t instanceof te?this.M_.Hs(t):this.M_.Ws(t),n.isEqual(g.min()))return[3,13];e.label=7;case 7:return e.trys.push([7,11,,13]),[4,this.N_._h()];case 8:return i=e.sent(),n.S(i)>=0?[4,this.cl(n)]:[3,10];case 9:e.sent(),e.label=10;case 10:return[3,13];case 11:return de("RemoteStore","Failed to raise snapshot:",o=e.sent()),[4,this.ul(o)];case 12:return e.sent(),[3,13];case 13:return[2]}})})},t.prototype.ul=function(t){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(r){switch(r.label){case 0:if(!qn(t))throw t;return this.O_=!0,[4,this.sl()];case 1:return r.sent(),this.Q_.set("Offline"),this.Aa.Ua(function(){return e.__awaiter(n,void 0,void 0,function(){return e.__generator(this,function(t){switch(t.label){case 0:return de("RemoteStore","Retrying IndexedDB access"),[4,this.N_._h()];case 1:return t.sent(),this.O_=!1,[4,this.X_()];case 2:return t.sent(),[2]}})})}),[2]}})})},t.prototype.cl=function(t){var e=this,n=this.M_.Xs(t);return n.as.forEach(function(n,r){if(n.resumeToken.rt()>0){var i=e.L_.get(r);i&&e.L_.set(r,i.we(n.resumeToken,t))}}),n.us.forEach(function(t){var n=e.L_.get(t);if(n){e.L_.set(t,n.we(A.ht,n.Ee)),e.hl(t);var r=new Dt(n.target,t,1,n.sequenceNumber);e.nl(r)}}),this.ol.Mu(n)},t.prototype.al=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:n=t.cause,r=0,i=t.targetIds,e.label=1;case 1:return r<i.length?(o=i[r],this.L_.has(o)?[4,this.ol._l(o,n)]:[3,3]):[3,5];case 2:e.sent(),this.L_.delete(o),this.M_.removeTarget(o),e.label=3;case 3:e.label=4;case 4:return r++,[3,1];case 5:return[2]}})})},t.prototype.el=function(){return e.__awaiter(this,void 0,void 0,function(){var t,n;return e.__generator(this,function(e){switch(e.label){case 0:return this.ll()?(t=this.k_.length>0?this.k_[this.k_.length-1].batchId:-1,[4,this.N_.qu(t)]):[3,5];case 1:return null!==(n=e.sent())?[3,2]:(0===this.k_.length&&this.z_.jc(),[3,4]);case 2:return this.dl(n),[4,this.el()];case 3:e.sent(),e.label=4;case 4:e.label=5;case 5:return this.fl()&&this.Tl(),[2]}})})},t.prototype.ll=function(){return this.q_()&&this.k_.length<10},t.prototype.El=function(){return this.k_.length},t.prototype.dl=function(t){this.k_.push(t),this.z_.Uc()&&this.z_.o_&&this.z_.a_(t.mutations)},t.prototype.fl=function(){return this.q_()&&!this.z_.qc()&&this.k_.length>0},t.prototype.Tl=function(){this.z_.start()},t.prototype.H_=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return this.z_.__(),[2]})})},t.prototype.J_=function(){var t=this;return this.N_.Jo(this.z_.lastStreamToken).then(function(){for(var e=0,n=t.k_;e<n.length;e++){var r=n[e];t.z_.a_(r.mutations)}}).catch(er)},t.prototype.u_=function(t,e){var n=this,r=this.k_.shift(),i=De.from(r,t,e,this.z_.lastStreamToken);return this.ol.Il(i).then(function(){return n.el()})},t.prototype.Y_=function(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return t&&this.k_.length>0?this.z_.o_?[4,this.wl(t)]:[3,2]:[3,5];case 1:return e.sent(),[3,4];case 2:return[4,this.Rl(t)];case 3:e.sent(),e.label=4;case 4:this.fl()&&this.Tl(),e.label=5;case 5:return[2]}})})},t.prototype.Rl=function(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return St(t.code)?[2,(de("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.z_.lastStreamToken),this.z_.lastStreamToken=A.ht,this.N_.Jo(A.ht).catch(er))]:[2]})})},t.prototype.wl=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r,i=this;return e.__generator(this,function(e){return St(r=t.code)&&r!==h.ABORTED?(n=this.k_.shift(),[2,(this.z_.Wc(),this.ol.Al(n.batchId,t).then(function(){return i.el()}))]):[2]})})},t.prototype.ml=function(){return new Hr(this.T_)},t.prototype.U_=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.sl()];case 1:return t.sent(),this.Q_.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},t.prototype.Pl=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){switch(t.label){case 0:return this.q_()?(de("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.U_()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Vl=function(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return this.isPrimary=t,t&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,5];case 2:return t?[3,4]:[4,this.sl()];case 3:e.sent(),this.Q_.set("Unknown"),e.label=4;case 4:e.label=5;case 5:return[2]}})})},t}();function ti(t,e){return"firestore_clients_"+t+"_"+e}function ei(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.t()&&(r+="_"+e.uid),r}function ni(t,e){return"firestore_targets_"+t+"_"+e}var ri=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.gl=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new c(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(ye("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.pl=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),ii=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.gl=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new c(r.error.code,r.error.message)),i?new t(e,r.state,o):(ye("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.pl=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),oi=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.gl=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Kt(),s=0;i&&s<r.activeTargetIds.length;++s)i=x(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(ye("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),si=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.gl=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(ye("SharedClientState","Failed to parse online state: "+e),null)},t}(),ui=function(){function t(){this.activeTargetIds=Kt()}return t.prototype.yl=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.bl=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.pl=function(){var t={activeTargetIds:this.activeTargetIds.W(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),ai=function(){function t(e,n,r,i,o){if(this.Tr=e,this.platform=n,this.persistenceKey=r,this.vl=i,this.ol=null,this.g_=null,this.ur=null,this.Sl=this.Dl.bind(this),this.Cl=new Lt(be),this.ro=!1,this.Fl=[],!t.Gh(this.platform))throw new c(h.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.Nl=ti(this.persistenceKey,this.vl),this.$l=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Cl=this.Cl.Ae(this.vl,new ui),this.kl=new RegExp("^firestore_clients_"+s+"_([^_]*)$"),this.Ll=new RegExp("^firestore_mutations_"+s+"_(\\d+)(?:_(.*))?$"),this.Ml=new RegExp("^firestore_targets_"+s+"_(\\d+)$"),this.Ol=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.platform.window.addEventListener("storage",this.Sl)}return t.Gh=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return e.__awaiter(this,void 0,void 0,function(){var t,n,r,i,o,s,u,a,h,c,f,l=this;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.ol.bo()];case 1:for(t=e.sent(),n=0,r=t;n<r.length;n++)(i=r[n])!==this.vl&&(o=this.getItem(ti(this.persistenceKey,i)))&&(s=oi.gl(i,o))&&(this.Cl=this.Cl.Ae(s.clientId,s));for(this.xl(),(u=this.storage.getItem(this.Ol))&&(a=this.Bl(u))&&this.ql(a),h=0,c=this.Fl;h<c.length;h++)f=c[h],this.Dl(f);return this.Fl=[],this.platform.window.addEventListener("unload",function(){return l.mo()}),this.ro=!0,[2]}})})},t.prototype.lr=function(t){this.setItem(this.$l,JSON.stringify(t))},t.prototype.Ul=function(){return this.Ql(this.Cl)},t.prototype.Wl=function(t){var e=!1;return this.Cl.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.jl=function(t){this.Kl(t,"pending")},t.prototype.Gl=function(t,e,n){this.Kl(t,e,n),this.zl(t)},t.prototype.Hl=function(t){var e="not-current";if(this.Wl(t)){var n=this.storage.getItem(ni(this.persistenceKey,t));if(n){var r=ii.gl(t,n);r&&(e=r.state)}}return this.Yl.yl(t),this.xl(),e},t.prototype.Jl=function(t){this.Yl.bl(t),this.xl()},t.prototype.Xl=function(t){return this.Yl.activeTargetIds.has(t)},t.prototype.Zl=function(t){this.removeItem(ni(this.persistenceKey,t))},t.prototype.td=function(t,e,n){this.ed(t,e,n)},t.prototype.Du=function(t,e,n){var r=this;e.forEach(function(t){r.zl(t)}),this.currentUser=t,n.forEach(function(t){r.jl(t)})},t.prototype.sd=function(t){this.nd(t)},t.prototype.mo=function(){this.ro&&(this.platform.window.removeEventListener("storage",this.Sl),this.removeItem(this.Nl),this.ro=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return de("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){de("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){de("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Dl=function(t){var n=this;if(t.storageArea===this.storage){if(de("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Nl)return void ye("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Tr.Ua(function(){return e.__awaiter(n,void 0,void 0,function(){var n,r,i,o,s,u;return e.__generator(this,function(e){if(this.ro){if(null!==t.key)if(this.kl.test(t.key)){if(null==t.newValue)return n=this.rd(t.key),[2,this.hd(n,null)];if(r=this.od(t.key,t.newValue))return[2,this.hd(r.clientId,r)]}else if(this.Ll.test(t.key)){if(null!==t.newValue&&(i=this.ad(t.key,t.newValue)))return[2,this.ud(i)]}else if(this.Ml.test(t.key)){if(null!==t.newValue&&(o=this._d(t.key,t.newValue)))return[2,this.ld(o)]}else if(t.key===this.Ol){if(null!==t.newValue&&(s=this.Bl(t.newValue)))return[2,this.ql(s)]}else t.key===this.$l&&(u=function(t){var e=Pe.dr;if(null!=t)try{var n=JSON.parse(t);me("number"==typeof n),e=n}catch(t){ye("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(t.newValue))!==Pe.dr&&this.ur(u)}else this.Fl.push(t);return[2]})})})}},Object.defineProperty(t.prototype,"Yl",{get:function(){return this.Cl.get(this.vl)},enumerable:!0,configurable:!0}),t.prototype.xl=function(){this.setItem(this.Nl,this.Yl.pl())},t.prototype.Kl=function(t,e,n){var r=new ri(this.currentUser,t,e,n),i=ei(this.persistenceKey,this.currentUser,t);this.setItem(i,r.pl())},t.prototype.zl=function(t){var e=ei(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.nd=function(t){var e={clientId:this.vl,onlineState:t};this.storage.setItem(this.Ol,JSON.stringify(e))},t.prototype.ed=function(t,e,n){var r=ni(this.persistenceKey,t),i=new ii(t,e,n);this.setItem(r,i.pl())},t.prototype.rd=function(t){var e=this.kl.exec(t);return e?e[1]:null},t.prototype.od=function(t,e){var n=this.rd(t);return oi.gl(n,e)},t.prototype.ad=function(t,e){var n=this.Ll.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return ri.gl(new a(i),r,e)},t.prototype._d=function(t,e){var n=this.Ml.exec(t),r=Number(n[1]);return ii.gl(r,e)},t.prototype.Bl=function(t){return si.gl(t)},t.prototype.ud=function(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.ol.dd(t.batchId,t.state,t.error)]:(de("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.ld=function(t){return this.ol.fd(t.targetId,t.state,t.error)},t.prototype.hd=function(t,e){var n=this,r=e?this.Cl.Ae(t,e):this.Cl.remove(t),i=this.Ql(this.Cl),o=this.Ql(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.ol.Td(s,u).then(function(){n.Cl=r})},t.prototype.ql=function(t){this.Cl.get(t.clientId)&&this.g_(t.onlineState)},t.prototype.Ql=function(t){var e=Kt();return t.forEach(function(t,n){e=e.He(n.activeTargetIds)}),e},t}(),hi=function(){function t(){this.Ed=new ui,this.Id={},this.ol=null,this.g_=null,this.ur=null}return t.prototype.jl=function(t){},t.prototype.Gl=function(t,e,n){},t.prototype.Hl=function(t){return this.Ed.yl(t),this.Id[t]||"not-current"},t.prototype.td=function(t,e,n){this.Id[t]=e},t.prototype.Jl=function(t){this.Ed.bl(t)},t.prototype.Xl=function(t){return this.Ed.activeTargetIds.has(t)},t.prototype.Zl=function(t){delete this.Id[t]},t.prototype.Ul=function(){return this.Ed.activeTargetIds},t.prototype.Wl=function(t){return this.Ed.activeTargetIds.has(t)},t.prototype.start=function(){return this.Ed=new ui,Promise.resolve()},t.prototype.Du=function(t,e,n){},t.prototype.sd=function(t){},t.prototype.mo=function(){},t.prototype.lr=function(t){},t}(),ci=function(t){this.key=t},fi=function(t){this.key=t},li=function(){function t(t,e){this.query=t,this.wd=e,this.Rd=null,this.fs=!1,this.Ad=Wt(),this.ns=Wt(),this.md=new Yt(t.se.bind(t))}return Object.defineProperty(t.prototype,"Pd",{get:function(){return this.wd},enumerable:!0,configurable:!0}),t.prototype.Vd=function(t,e){var n=this,r=e?e.gd:new $t,i=e?e.md:this.md,o=e?e.ns:this.ns,s=i,u=!1,a=this.query.oe()&&i.size===this.query.limit?i.last():null,h=this.query.ae()&&i.size===this.query.limit?i.first():null;if(t.pe(function(t,e){var c=i.get(t),f=e instanceof yt?e:null;f&&(f=n.query.matches(f)?f:null);var l=!!c&&n.ns.has(c.key),p=!!f&&(f.At||n.ns.has(f.key)&&f.hasCommittedMutations),d=!1;c&&f?c.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.pd(c,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.query.se(f,a)>0||h&&n.query.se(f,h)<0)&&(u=!0)):!c&&f?(r.track({type:0,doc:f}),d=!0):c&&!f&&(r.track({type:1,doc:c}),d=!0,(a||h)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),this.query.oe()||this.query.ae())for(;s.size>this.query.limit;){var c=this.query.oe()?s.last():s.first();s=s.delete(c.key),o=o.delete(c.key),r.track({type:1,doc:c})}return{md:s,gd:r,yd:u,ns:o}},t.prototype.pd=function(t,e){return t.At&&e.hasCommittedMutations&&!e.At},t.prototype.xn=function(t,e,n){var r=this,i=this.md;this.md=t.md,this.ns=t.ns;var o=t.gd.es();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ge()}};return n(t)-n(e)}(t.type,e.type)||r.query.se(t.doc,e.doc)}),this.bd(n);var s=e?this.vd():[],u=0===this.Ad.size&&this.fs?1:0,a=u!==this.Rd;return this.Rd=u,0!==o.length||a?{snapshot:new Jt(this.query,t.md,i,o,t.ns,0===u,a,!1),Sd:s}:{Sd:s}},t.prototype.Dd=function(t){return this.fs&&"Offline"===t?(this.fs=!1,this.xn({md:this.md,gd:new $t,ns:this.ns,yd:!1},!1)):{Sd:[]}},t.prototype.Cd=function(t){return!this.wd.has(t)&&!!this.md.has(t)&&!this.md.get(t).At},t.prototype.bd=function(t){var e=this;t&&(t.Ts.forEach(function(t){return e.wd=e.wd.add(t)}),t.Es.forEach(function(t){}),t.Is.forEach(function(t){return e.wd=e.wd.delete(t)}),this.fs=t.fs)},t.prototype.vd=function(){var t=this;if(!this.fs)return[];var e=this.Ad;this.Ad=Wt(),this.md.forEach(function(e){t.Cd(e.key)&&(t.Ad=t.Ad.add(e.key))});var n=[];return e.forEach(function(e){t.Ad.has(e)||n.push(new fi(e))}),this.Ad.forEach(function(t){e.has(t)||n.push(new ci(t))}),n},t.prototype.Fd=function(t){this.wd=t.Ku,this.Ad=Wt();var e=this.Vd(t.documents);return this.xn(e,!0)},t.prototype.Nd=function(){return Jt.os(this.query,this.md,this.ns,0===this.Rd)},t}(),pi=function(){function t(t,e,n,r){this.Aa=t,this.$d=e,this.updateFunction=n,this.Va=r,this.kd=5,this.$a=new Ce(this.Aa,"transaction_retry")}return t.prototype.Ld=function(){this.Md()},t.prototype.Md=function(){var t=this;this.$a.gr(function(){return e.__awaiter(t,void 0,void 0,function(){var t,n,r=this;return e.__generator(this,function(e){return t=this.$d.ml(),(n=this.Od(t))&&n.then(function(e){r.Aa.uo(function(){return t.commit().then(function(){r.Va.resolve(e)}).catch(function(t){r.xd(t)})})}).catch(function(t){r.xd(t)}),[2]})})})},t.prototype.Od=function(t){try{var e=this.updateFunction(t);return!k(e)&&e.catch&&e.then?e:(this.Va.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Va.reject(t),null}},t.prototype.xd=function(t){var e=this;this.kd>0&&this.Bd(t)?(this.kd-=1,this.Aa.uo(function(){return e.Md(),Promise.resolve()})):this.Va.reject(t)},t.prototype.Bd=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!St(e)}return!1},t}(),di=function(t,e,n){this.query=t,this.targetId=e,this.view=n},yi=function(t){this.key=t,this.qd=!1},vi=function(){function t(t,e,n,r,i){this.N_=t,this.$d=e,this.Ud=n,this.currentUser=r,this.Qd=i,this.Wd=null,this.jd=new Ae(function(t){return t.canonicalId()}),this.Kd=new Map,this.Gd=[],this.zd=new Lt(_.N),this.Hd=new Map,this.Yd=new nr,this.Jd={},this.Xd=new Map,this.Zd=He.rh(),this.onlineState="Unknown"}return Object.defineProperty(t.prototype,"tf",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){this.Wd=t},t.prototype.listen=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r,i,o,s;return e.__generator(this,function(e){switch(e.label){case 0:return this.ef("listen()"),(i=this.jd.get(t))?(n=i.targetId,this.Ud.Hl(n),r=i.view.Nd(),[3,4]):[3,1];case 1:return[4,this.N_.Qu(t.ee())];case 2:return o=e.sent(),s=this.Ud.Hl(o.targetId),n=o.targetId,[4,this.sf(t,n,"current"===s)];case 3:r=e.sent(),this.tf&&this.$d.listen(o),e.label=4;case 4:return[2,r]}})})},t.prototype.sf=function(t,n,r){return e.__awaiter(this,void 0,void 0,function(){var i,o,s,u,a,h;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.N_.ju(t,!0)];case 1:return i=e.sent(),o=new li(t,i.Ku),s=o.Vd(i.documents),u=Xt.ds(n,r&&"Offline"!==this.onlineState),a=o.xn(s,this.tf,u),this.if(n,a.Sd),h=new di(t,n,o),[2,(this.jd.set(t,h),this.Kd.has(n)?this.Kd.get(n).push(t):this.Kd.set(n,[t]),a.snapshot)]}})})},t.prototype.rl=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r,i=this;return e.__generator(this,function(e){switch(e.label){case 0:return this.ef("unlisten()"),n=this.jd.get(t),(r=this.Kd.get(n.targetId)).length>1?[2,(this.Kd.set(n.targetId,r.filter(function(e){return!e.isEqual(t)})),void this.jd.delete(t))]:this.tf?(this.Ud.Jl(n.targetId),this.Ud.Wl(n.targetId)?[3,2]:[4,this.N_.Wu(n.targetId,!1).then(function(){i.Ud.Zl(n.targetId),i.$d.rl(n.targetId),i.nf(n.targetId)}).catch(er)]):[3,3];case 1:e.sent(),e.label=2;case 2:return[3,5];case 3:return this.nf(n.targetId),[4,this.N_.Wu(n.targetId,!0)];case 4:e.sent(),e.label=5;case 5:return[2]}})})},t.prototype.write=function(t,n){return e.__awaiter(this,void 0,void 0,function(){var r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:this.ef("write()"),e.label=1;case 1:return e.trys.push([1,5,,6]),[4,this.N_.$u(t)];case 2:return r=e.sent(),this.Ud.jl(r.batchId),this.rf(r.batchId,n),[4,this.hf(r.Dn)];case 3:return e.sent(),[4,this.$d.el()];case 4:return e.sent(),[3,6];case 5:return i=e.sent(),o=Qn(i,"Failed to persist write"),n.reject(o),[3,6];case 6:return[2]}})})},t.prototype.runTransaction=function(t,e,n){new pi(t,this.$d,e,n).Ld()},t.prototype.Mu=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r=this;return e.__generator(this,function(e){switch(e.label){case 0:this.ef("applyRemoteEvent()"),e.label=1;case 1:return e.trys.push([1,4,,6]),[4,this.N_.Mu(t)];case 2:return n=e.sent(),t.as.forEach(function(t,e){var n=r.Hd.get(e);n&&(me(t.Ts.size+t.Es.size+t.Is.size<=1),t.Ts.size>0?n.qd=!0:t.Es.size>0?me(n.qd):t.Is.size>0&&(me(n.qd),n.qd=!1))}),[4,this.hf(n,t)];case 3:return e.sent(),[3,6];case 4:return[4,er(e.sent())];case 5:return e.sent(),[3,6];case 6:return[2]}})})},t.prototype.Dd=function(t,e){this.ef("applyOnlineStateChange()");var n=[];this.jd.forEach(function(e,r){var i=r.view.Dd(t);i.snapshot&&n.push(i.snapshot)}),this.Wd.af(t),this.Wd.i_(n),this.onlineState=t},t.prototype._l=function(t,n){return e.__awaiter(this,void 0,void 0,function(){var r,i,o,s,u,a=this;return e.__generator(this,function(e){switch(e.label){case 0:return this.ef("rejectListens()"),this.Ud.td(t,"rejected",n),r=this.Hd.get(t),(i=r&&r.key)?(o=(o=new Lt(_.N)).Ae(i,new vt(i,g.min())),s=Wt().add(i),u=new Ht(g.min(),new Map,new Pt(be),o,s),[4,this.Mu(u)]):[3,2];case 1:return e.sent(),this.zd=this.zd.remove(i),this.Hd.delete(t),this.uf(),[3,4];case 2:return[4,this.N_.Wu(t,!1).then(function(){return a.nf(t,n)}).catch(er)];case 3:e.sent(),e.label=4;case 4:return[2]}})})},t.prototype.Il=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r;return e.__generator(this,function(e){switch(e.label){case 0:this.ef("applySuccessfulWrite()"),n=t.batch.batchId,this.cf(n,null),this._f(n),e.label=1;case 1:return e.trys.push([1,4,,6]),[4,this.N_.zo(t)];case 2:return r=e.sent(),this.Ud.Gl(n,"acknowledged"),[4,this.hf(r)];case 3:return e.sent(),[3,6];case 4:return[4,er(e.sent())];case 5:return e.sent(),[3,6];case 6:return[2]}})})},t.prototype.Al=function(t,n){return e.__awaiter(this,void 0,void 0,function(){var r;return e.__generator(this,function(e){switch(e.label){case 0:this.ef("rejectFailedWrite()"),this.cf(t,n),this._f(t),e.label=1;case 1:return e.trys.push([1,4,,6]),[4,this.N_.Lu(t)];case 2:return r=e.sent(),this.Ud.Gl(t,"rejected",n),[4,this.hf(r)];case 3:return e.sent(),[3,6];case 4:return[4,er(e.sent())];case 5:return e.sent(),[3,6];case 6:return[2]}})})},t.prototype.lf=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:this.$d.q_()||de("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.N_.sa()];case 2:return-1===(n=e.sent())?[2,void t.resolve()]:((r=this.Xd.get(n)||[]).push(t),this.Xd.set(n,r),[3,4]);case 3:return i=e.sent(),o=Qn(i,"Initialization of waitForPendingWrites() operation failed"),t.reject(o),[3,4];case 4:return[2]}})})},t.prototype._f=function(t){(this.Xd.get(t)||[]).forEach(function(t){t.resolve()}),this.Xd.delete(t)},t.prototype.df=function(t){this.Xd.forEach(function(e){e.forEach(function(e){e.reject(new c(h.CANCELLED,t))})}),this.Xd.clear()},t.prototype.rf=function(t,e){var n=this.Jd[this.currentUser.s()];n||(n=new Lt(be)),n=n.Ae(t,e),this.Jd[this.currentUser.s()]=n},t.prototype.cf=function(t,e){var n=this.Jd[this.currentUser.s()];if(n){var r=n.get(t);r&&(e?r.reject(e):r.resolve(),n=n.remove(t)),this.Jd[this.currentUser.s()]=n}},t.prototype.nf=function(t,e){var n=this;void 0===e&&(e=null),this.Ud.Jl(t);for(var r=0,i=this.Kd.get(t);r<i.length;r++){var o=i[r];this.jd.delete(o),e&&this.Wd.ff(o,e)}this.Kd.delete(t),this.tf&&this.Yd.nc(t).forEach(function(t){n.Yd.Ch(t)||n.Tf(t)})},t.prototype.Tf=function(t){var e=this.zd.get(t);null!==e&&(this.$d.rl(e),this.zd=this.zd.remove(t),this.Hd.delete(e),this.uf())},t.prototype.if=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof ci?(this.Yd.yh(i.key,t),this.Ef(i)):i instanceof fi?(de("SyncEngine","Document no longer in limbo: "+i.key),this.Yd.vh(i.key,t),this.Yd.Ch(i.key)||this.Tf(i.key)):ge()}},t.prototype.Ef=function(t){var e=t.key;this.zd.get(e)||(de("SyncEngine","New document in limbo: "+e),this.Gd.push(e),this.uf())},t.prototype.uf=function(){for(;this.Gd.length>0&&this.zd.size<this.Qd;){var t=this.Gd.shift(),e=this.Zd.next();this.Hd.set(e,new yi(t)),this.zd=this.zd.Ae(t,e),this.$d.listen(new Dt(wt.Wt(t.path).ee(),e,2,Pe.dr))}},t.prototype.If=function(){return this.zd},t.prototype.wf=function(){return this.Gd},t.prototype.hf=function(t,n){return e.__awaiter(this,void 0,void 0,function(){var r,i,o,s=this;return e.__generator(this,function(e){switch(e.label){case 0:return r=[],i=[],o=[],this.jd.forEach(function(e,u){o.push(Promise.resolve().then(function(){var e=u.view.Vd(t);return e.yd?s.N_.ju(u.query,!1).then(function(t){var n=t.documents;return u.view.Vd(n,e)}):e}).then(function(t){var e=n&&n.as.get(u.targetId),o=u.view.xn(t,s.tf,e);if(s.if(u.targetId,o.Sd),o.snapshot){s.tf&&s.Ud.td(u.targetId,o.snapshot.fromCache?"not-current":"current"),r.push(o.snapshot);var a=Ve.ar(u.targetId,o.snapshot);i.push(a)}}))}),[4,Promise.all(o)];case 1:return e.sent(),this.Wd.i_(r),[4,this.N_.Bu(i)];case 2:return e.sent(),[2]}})})},t.prototype.ef=function(t){},t.prototype.Pl=function(t){return e.__awaiter(this,void 0,void 0,function(){var n;return e.__generator(this,function(e){switch(e.label){case 0:return this.currentUser.isEqual(t)?[3,3]:[4,this.N_.Du(t)];case 1:return n=e.sent(),this.currentUser=t,this.df("'waitForPendingWrites' promise is rejected due to a user change."),this.Ud.Du(t,n.Fu,n.Nu),[4,this.hf(n.Cu)];case 2:e.sent(),e.label=3;case 3:return[4,this.$d.Pl()];case 4:return e.sent(),[2]}})})},t.prototype.enableNetwork=function(){return this.$d.enableNetwork()},t.prototype.disableNetwork=function(){return this.$d.disableNetwork()},t.prototype.ei=function(t){var e=this.Hd.get(t);if(e&&e.qd)return Wt().add(e.key);var n=Wt(),r=this.Kd.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=o[i],u=this.jd.get(s);n=n.He(u.view.Pd)}return n},t}(),gi=function(t){function n(e,n,r,i,o){var s=this;return(s=t.call(this,e,n,r,i,o)||this).N_=e,s.Rf=void 0,s}return e.__extends(n,t),Object.defineProperty(n.prototype,"tf",{get:function(){return!0===this.Rf},enumerable:!0,configurable:!0}),n.prototype.enableNetwork=function(){return this.N_.ao(!0),t.prototype.enableNetwork.call(this)},n.prototype.disableNetwork=function(){return this.N_.ao(!1),t.prototype.disableNetwork.call(this)},n.prototype.Af=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.N_.ju(t.query,!0)];case 1:return n=e.sent(),r=t.view.Fd(n),[2,(this.Rf&&this.if(t.targetId,r.Sd),r)]}})})},n.prototype.Dd=function(e,n){this.tf&&0===n&&(t.prototype.Dd.call(this,e,n),this.Ud.sd(e)),this.tf||1!==n||t.prototype.Dd.call(this,e,n)},n.prototype.dd=function(t,n,r){return e.__awaiter(this,void 0,void 0,function(){var i;return e.__generator(this,function(e){switch(e.label){case 0:return this.ef("applyBatchState()"),[4,this.N_.zu(t)];case 1:return null===(i=e.sent())?[3,6]:"pending"!==n?[3,3]:[4,this.$d.el()];case 2:return e.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(this.cf(t,r||null),this.N_.Hu(t)):ge(),e.label=4;case 4:return[4,this.hf(i)];case 5:return e.sent(),[3,7];case 6:de("SyncEngine","Cannot apply mutation batch with id: "+t),e.label=7;case 7:return[2]}})})},n.prototype.Vl=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r,i,o,s,u,a,h=this;return e.__generator(this,function(e){switch(e.label){case 0:return!0!==t||!0===this.Rf?[3,3]:(n=this.Ud.Ul(),[4,this.mf(n.W(),!0)]);case 1:return r=e.sent(),this.Rf=!0,[4,this.$d.Vl(!0)];case 2:for(e.sent(),i=0,o=r;i<o.length;i++)s=o[i],this.$d.listen(s);return[3,7];case 3:return!1!==t||!1===this.Rf?[3,7]:(u=[],a=Promise.resolve(),this.Kd.forEach(function(t,e){h.Ud.Xl(e)?u.push(e):a=a.then(function(){return h.nf(e),h.N_.Wu(e,!0)}),h.$d.rl(e)}),[4,a]);case 4:return e.sent(),[4,this.mf(u,!1)];case 5:return e.sent(),this.Pf(),this.Rf=!1,[4,this.$d.Vl(!1)];case 6:e.sent(),e.label=7;case 7:return[2]}})})},n.prototype.Pf=function(){var t=this;this.Hd.forEach(function(e,n){t.$d.rl(n)}),this.Yd.rc(),this.Hd=new Map,this.zd=new Lt(_.N)},n.prototype.mf=function(t,n){return e.__awaiter(this,void 0,void 0,function(){var n,r,i,o,s,u,a,h,c,f,l,p,d;return e.__generator(this,function(e){switch(e.label){case 0:n=[],r=[],i=0,o=t,e.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=this.Kd.get(s))&&0!==a.length?[4,this.N_.Wu(s,!0)]:[3,8]):[3,14];case 2:return e.sent(),[4,this.N_.Qu(a[0].ee())];case 3:u=e.sent(),h=0,c=a,e.label=4;case 4:return h<c.length?(f=c[h],l=this.jd.get(f),[4,this.Af(l)]):[3,7];case 5:(p=e.sent()).snapshot&&r.push(p.snapshot),e.label=6;case 6:return h++,[3,4];case 7:return[3,12];case 8:return[4,this.N_.Yu(s)];case 9:return d=e.sent(),[4,this.N_.Qu(d)];case 10:return u=e.sent(),[4,this.sf(this.Vf(d),s,!1)];case 11:e.sent(),e.label=12;case 12:n.push(u),e.label=13;case 13:return i++,[3,1];case 14:return[2,(this.Wd.i_(r),n)]}})})},n.prototype.Vf=function(t){return new wt(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},n.prototype.bo=function(){return this.N_.bo()},n.prototype.fd=function(t,n,r){return e.__awaiter(this,void 0,void 0,function(){var i,o;return e.__generator(this,function(e){switch(e.label){case 0:return this.Rf?(de("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!this.Kd.has(t))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,this.N_.Kr()];case 3:return i=e.sent(),o=Ht.ls(t,"current"===n),[4,this.hf(i,o)];case 4:return e.sent(),[3,8];case 5:return[4,this.N_.Wu(t,!0)];case 6:return e.sent(),this.nf(t,r),[3,8];case 7:ge(),e.label=8;case 8:return[2]}})})},n.prototype.Td=function(t,n){return e.__awaiter(this,void 0,void 0,function(){var r,i,o,s,u,a,h,c,f,l,p=this;return e.__generator(this,function(d){switch(d.label){case 0:if(!this.Rf)return[3,10];r=0,i=t,d.label=1;case 1:return r<i.length?(o=i[r],this.Kd.has(o)?(de("SyncEngine","Adding an already active target "+o),[3,5]):[4,this.N_.Yu(o)]):[3,6];case 2:return s=d.sent(),[4,this.N_.Qu(s)];case 3:return u=d.sent(),[4,this.sf(this.Vf(s),u.targetId,!1)];case 4:d.sent(),this.$d.listen(u),d.label=5;case 5:return r++,[3,1];case 6:a=function(t){return e.__generator(this,function(e){switch(e.label){case 0:return h.Kd.has(t)?[4,h.N_.Wu(t,!1).then(function(){p.$d.rl(t),p.nf(t)}).catch(er)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=this,c=0,f=n,d.label=7;case 7:return c<f.length?(l=f[c],[5,a(l)]):[3,10];case 8:d.sent(),d.label=9;case 9:return c++,[3,7];case 10:return[2]}})})},n}(vi),mi=function(){this.gf=void 0,this.pf=[]},wi=function(){function t(t){this.ol=t,this.yf=new Ae(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.bf=new Set,this.ol.subscribe(this)}return t.prototype.listen=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r,i,o,s,u;return e.__generator(this,function(e){switch(e.label){case 0:if(n=t.query,r=!1,(i=this.yf.get(n))||(r=!0,i=new mi),!r)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),o=i,[4,this.ol.listen(n)];case 2:return o.gf=e.sent(),[3,4];case 3:return s=e.sent(),u=Qn(s,"Initialization of query '"+t.query+"' failed"),[2,void t.onError(u)];case 4:return this.yf.set(n,i),i.pf.push(t),t.Dd(this.onlineState),i.gf&&t.vf(i.gf)&&this.Sf(),[2]}})})},t.prototype.rl=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r,i,o;return e.__generator(this,function(e){return n=t.query,r=!1,(i=this.yf.get(n))&&(o=i.pf.indexOf(t))>=0&&(i.pf.splice(o,1),r=0===i.pf.length),r?[2,(this.yf.delete(n),this.ol.rl(n))]:[2]})})},t.prototype.i_=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.yf.get(o);if(s){for(var u=0,a=s.pf;u<a.length;u++)a[u].vf(i)&&(e=!0);s.gf=i}}e&&this.Sf()},t.prototype.ff=function(t,e){var n=this.yf.get(t);if(n)for(var r=0,i=n.pf;r<i.length;r++)i[r].onError(e);this.yf.delete(t)},t.prototype.af=function(t){this.onlineState=t;var e=!1;this.yf.forEach(function(n,r){for(var i=0,o=r.pf;i<o.length;i++)o[i].Dd(t)&&(e=!0)}),e&&this.Sf()},t.prototype.Df=function(t){this.bf.add(t),t.next()},t.prototype.Cf=function(t){this.bf.delete(t)},t.prototype.Sf=function(){this.bf.forEach(function(t){t.next()})},t}(),Ei=function(){function t(t,e,n){this.query=t,this.Ff=e,this.Nf=!1,this.$f=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.vf=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Jt(t.query,t.docs,t.ss,e,t.ns,t.fromCache,t.rs,!0)}var o=!1;return this.Nf?this.kf(t)&&(this.Ff.next(t),o=!0):this.Lf(t,this.onlineState)&&(this.Mf(t),o=!0),this.$f=t,o},t.prototype.onError=function(t){this.Ff.error(t)},t.prototype.Dd=function(t){this.onlineState=t;var e=!1;return this.$f&&!this.Nf&&this.Lf(this.$f,t)&&(this.Mf(this.$f),e=!0),e},t.prototype.Lf=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Of&&n||t.docs.B()&&"Offline"!==e)},t.prototype.kf=function(t){if(t.docChanges.length>0)return!0;var e=this.$f&&this.$f.hasPendingWrites!==t.hasPendingWrites;return!(!t.rs&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.Mf=function(t){t=Jt.os(t.query,t.docs,t.ns,t.fromCache),this.Nf=!0,this.Ff.next(t)},t}(),bi=function(){function t(){}return t.prototype.Su=function(t){this.xf=t},t.prototype.Zn=function(t,e,n,i){var o=this;return e.te()||n.isEqual(g.min())?this.Bf(t,e):this.xf.Yn(t,i).next(function(s){var u=o.qf(e,s);return(e.oe()||e.ae())&&o.yd(e.Bt,u,i,n)?o.Bf(t,e):(le()<=r.LogLevel.DEBUG&&de("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),e.toString()),o.xf.Zn(t,e,n).next(function(t){return u.forEach(function(e){t=t.Ae(e.key,e)}),t}))})},t.prototype.qf=function(t,e){var n=new Pt(function(e,n){return t.se(e,n)});return e.forEach(function(e,r){r instanceof yt&&t.matches(r)&&(n=n.add(r))}),n},t.prototype.yd=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.S(r)>0)},t.prototype.Bf=function(t,e){return le()<=r.LogLevel.DEBUG&&de("IndexFreeQueryEngine","Using full collection scan to execute query:",e.toString()),this.xf.Zn(t,e,g.min())},t}(),_i=function(){function t(t,e){this.jn=t,this.hh=e,this.Wn=[],this.Uf=1,this.lastStreamToken=A.ht,this.Qf=new Pt(rr.Xu)}return t.prototype.Go=function(t){return xe.resolve(0===this.Wn.length)},t.prototype.zo=function(t,e,n){var r=e.batchId,i=this.Wf(r,"acknowledged");return me(0===i),this.Wn[i],this.lastStreamToken=n,xe.resolve()},t.prototype.Yo=function(t){return xe.resolve(this.lastStreamToken)},t.prototype.Jo=function(t,e){return this.lastStreamToken=e,xe.resolve()},t.prototype.Xo=function(t,e,n,r){var i=this.Uf;this.Uf++,this.Wn.length>0&&this.Wn[this.Wn.length-1];var o=new ke(i,e,n,r);this.Wn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Qf=this.Qf.add(new rr(a.key,i)),this.jn.Dr(t,a.key.path.L())}return xe.resolve(o)},t.prototype.Zo=function(t,e){return xe.resolve(this.jf(e))},t.prototype.ea=function(t,e){var n=e+1,r=this.Kf(n),i=r<0?0:r;return xe.resolve(this.Wn.length>i?this.Wn[i]:null)},t.prototype.sa=function(){return xe.resolve(0===this.Wn.length?-1:this.Uf-1)},t.prototype.ia=function(t){return xe.resolve(this.Wn.slice())},t.prototype.Gn=function(t,e){var n=this,r=new rr(e,0),i=new rr(e,Number.POSITIVE_INFINITY),o=[];return this.Qf.Ke([r,i],function(t){var e=n.jf(t.oc);o.push(e)}),xe.resolve(o)},t.prototype.Xn=function(t,e){var n=this,r=new Pt(be);return e.forEach(function(t){var e=new rr(t,0),i=new rr(t,Number.POSITIVE_INFINITY);n.Qf.Ke([e,i],function(t){r=r.add(t.oc)})}),xe.resolve(this.Gf(r))},t.prototype.nr=function(t,e){var n=e.path,r=n.length+1,i=n;_.et(i)||(i=i.child(""));var o=new rr(new _(i),0),s=new Pt(be);return this.Qf.Ge(function(t){var e=t.key.path;return!!n.q(e)&&(e.length===r&&(s=s.add(t.oc)),!0)},o),xe.resolve(this.Gf(s))},t.prototype.Gf=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.jf(t);null!==r&&n.push(r)}),n},t.prototype.ra=function(t,e){var n=this;me(0===this.Wf(e.batchId,"removed")),this.Wn.shift();var r=this.Qf;return xe.forEach(e.mutations,function(i){var o=new rr(i.key,e.batchId);return r=r.delete(o),n.hh.Bo(t,i.key)}).next(function(){n.Qf=r})},t.prototype.ha=function(t){},t.prototype.Ch=function(t,e){var n=new rr(e,0),r=this.Qf.ze(n);return xe.resolve(e.isEqual(r&&r.key))},t.prototype.oa=function(t){return this.Wn.length,xe.resolve()},t.prototype.Wf=function(t,e){return this.Kf(t)},t.prototype.Kf=function(t){return 0===this.Wn.length?0:t-this.Wn[0].batchId},t.prototype.jf=function(t){var e=this.Kf(t);return e<0||e>=this.Wn.length?null:this.Wn[e]},t}(),Ti=function(){function t(t,e){this.jn=t,this.zf=e,this.docs=new Lt(_.N),this.size=0}return t.prototype.Nn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.zf(e);return this.docs=this.docs.Ae(r,{Mr:e,size:s,readTime:n}),this.size+=s-o,this.jn.Dr(t,r.path.L())},t.prototype.kn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Ln=function(t,e){var n=this.docs.get(e);return xe.resolve(n?n.Mr:null)},t.prototype.getEntries=function(t,e){var n=this,r=Mt();return e.forEach(function(t){var e=n.docs.get(t);r=r.Ae(t,e?e.Mr:null)}),xe.resolve(r)},t.prototype.Zn=function(t,e,n){for(var r=Ft(),i=new _(e.path.child("")),o=this.docs.ve(i);o.$e();){var s=o.Ne(),u=s.key,a=s.value,h=a.Mr,c=a.readTime;if(!e.path.q(u.path))break;c.S(n)<=0||h instanceof yt&&e.matches(h)&&(r=r.Ae(h.key,h))}return xe.resolve(r)},t.prototype.Hf=function(t,e){return xe.forEach(this.docs,function(t){return e(t)})},t.prototype.Yr=function(e){return new t.Jr(this)},t.prototype.Zr=function(t){return xe.resolve(this.size)},t}();Ti.Jr=function(t){function n(e){var n=this;return(n=t.call(this)||this).th=e,n}return e.__extends(n,t),n.prototype.xn=function(t){var e=this,n=[];return this.Dn.forEach(function(r,i){i?n.push(e.th.Nn(t,i,e.readTime)):e.th.kn(r)}),xe.vn(n)},n.prototype.Mn=function(t,e){return this.th.Ln(t,e)},n.prototype.On=function(t,e){return this.th.getEntries(t,e)},n}(Se);var Ii=function(){function t(t){this.persistence=t,this.Yf=new Ae(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=g.min(),this.highestTargetId=0,this.Jf=0,this.Xf=new nr,this.targetCount=0,this.Zf=He.nh()}return t.prototype.js=function(t,e){return this.Yf.forEach(function(t,n){return e(n)}),xe.resolve()},t.prototype._h=function(t){return xe.resolve(this.lastRemoteSnapshotVersion)},t.prototype.lh=function(t){return xe.resolve(this.Jf)},t.prototype.oh=function(t){return this.highestTargetId=this.Zf.next(),xe.resolve(this.highestTargetId)},t.prototype.dh=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Jf&&(this.Jf=e),xe.resolve()},t.prototype.Th=function(t){this.Yf.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Zf=new He(e),this.highestTargetId=e),t.sequenceNumber>this.Jf&&(this.Jf=t.sequenceNumber)},t.prototype.fh=function(t,e){return this.Th(e),this.targetCount+=1,xe.resolve()},t.prototype.Ih=function(t,e){return this.Th(e),xe.resolve()},t.prototype.wh=function(t,e){return this.Yf.delete(e.target),this.Xf.nc(e.targetId),this.targetCount-=1,xe.resolve()},t.prototype.Ah=function(t,e,n){var r=this,i=0,o=[];return this.Yf.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.Yf.delete(s),o.push(r.Rh(t,u.targetId)),i++)}),xe.vn(o).next(function(){return i})},t.prototype.Vh=function(t){return xe.resolve(this.targetCount)},t.prototype.gh=function(t,e){var n=this.Yf.get(e)||null;return xe.resolve(n)},t.prototype.ph=function(t,e,n){return this.Xf.ec(e,n),xe.resolve()},t.prototype.bh=function(t,e,n){this.Xf.ic(e,n);var r=this.persistence.hh,i=[];return r&&e.forEach(function(e){i.push(r.Bo(t,e))}),xe.vn(i)},t.prototype.Rh=function(t,e){return this.Xf.nc(e),xe.resolve()},t.prototype.Sh=function(t,e){var n=this.Xf.hc(e);return xe.resolve(n)},t.prototype.Ch=function(t,e){return xe.resolve(this.Xf.Ch(e))},t}(),Ni=function(){function t(t){var e=this;this.tT={},this.Bh=new Pe(0),this.qh=!1,this.qh=!0,this.hh=t(this),this.Yh=new Ii(this),this.jn=new Be,this.Qn=new Ti(this.jn,function(t){return e.hh.eT(t)})}return t.prototype.start=function(){return Promise.resolve()},t.prototype.mo=function(){return this.qh=!1,Promise.resolve()},Object.defineProperty(t.prototype,"ro",{get:function(){return this.qh},enumerable:!0,configurable:!0}),t.prototype.ho=function(){},t.prototype.Fo=function(){return this.jn},t.prototype.vo=function(t){var e=this.tT[t.s()];return e||(e=new _i(this.jn,this.hh),this.tT[t.s()]=e),e},t.prototype.Do=function(){return this.Yh},t.prototype.Co=function(){return this.Qn},t.prototype.runTransaction=function(t,e,n){var r=this;de("MemoryPersistence","Starting transaction:",t);var i=new Ai(this.Bh.next());return this.hh.sT(),n(i).next(function(t){return r.hh.iT(i).next(function(){return t})}).yn().then(function(t){return i.Un(),t})},t.prototype.nT=function(t,e){return xe.Sn(Object.values(this.tT).map(function(n){return function(){return n.Ch(t,e)}}))},t}(),Ai=function(t){function n(e){var n=this;return(n=t.call(this)||this).Oh=e,n}return e.__extends(n,t),n}(Le),ki=function(){function t(t){this.persistence=t,this.rT=new nr,this.hT=null}return t.oT=function(e){return new t(e)},Object.defineProperty(t.prototype,"aT",{get:function(){if(this.hT)return this.hT;throw ge()},enumerable:!0,configurable:!0}),t.prototype.yh=function(t,e,n){return this.rT.yh(n,e),this.aT.delete(n),xe.resolve()},t.prototype.vh=function(t,e,n){return this.rT.vh(n,e),this.aT.add(n),xe.resolve()},t.prototype.Bo=function(t,e){return this.aT.add(e),xe.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.rT.nc(e.targetId).forEach(function(t){return n.aT.add(t)});var r=this.persistence.Do();return r.Sh(t,e.targetId).next(function(t){t.forEach(function(t){return n.aT.add(t)})}).next(function(){return r.wh(t,e)})},t.prototype.sT=function(){this.hT=new Set},t.prototype.iT=function(t){var e=this,n=this.persistence.Co().Yr();return xe.forEach(this.aT,function(r){return e.uT(t,r).next(function(t){t||n.kn(r)})}).next(function(){return e.hT=null,n.apply(t)})},t.prototype.Wo=function(t,e){var n=this;return this.uT(t,e).next(function(t){t?n.aT.delete(e):n.aT.add(e)})},t.prototype.eT=function(t){return 0},t.prototype.uT=function(t,e){var n=this;return xe.Sn([function(){return xe.resolve(n.rT.Ch(e))},function(){return n.persistence.Do().Ch(t,e)},function(){return n.persistence.nT(t,e)}])},t}(),Di=function(){function t(){}return t.prototype.initialize=function(t){return e.__awaiter(this,void 0,void 0,function(){var n=this;return e.__generator(this,function(e){switch(e.label){case 0:return this.Ud=this.cT(t),this.persistence=this._T(t),[4,this.persistence.start()];case 1:return e.sent(),this.lT=this.dT(t),this.N_=this.fT(t),this.$d=this.TT(t),this.ol=this.ET(t),this.IT=this.wT(t),this.Ud.g_=function(t){return n.ol.Dd(t,1)},this.$d.ol=this.ol,[4,this.N_.start()];case 2:return e.sent(),[4,this.Ud.start()];case 3:return e.sent(),[4,this.$d.start()];case 4:return e.sent(),[4,this.$d.Vl(this.ol.tf)];case 5:return e.sent(),[2]}})})},t.prototype.wT=function(t){return new wi(this.ol)},t.prototype.dT=function(t){return null},t.prototype.fT=function(t){return new Zn(this.persistence,new bi,t.RT)},t.prototype._T=function(t){return new Ni(ki.oT)},t.prototype.TT=function(t){var e=this;return new Zr(this.N_,t.T_,t.Aa,function(t){return e.ol.Dd(t,0)},t.platform.AT())},t.prototype.cT=function(t){return new hi},t.prototype.ET=function(t){return new vi(this.N_,this.$d,this.Ud,t.RT,t.Qd)},t.prototype.clearPersistence=function(t){throw new c(h.FAILED_PRECONDITION,"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.")},t}(),xi=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),n.prototype.initialize=function(n){return e.__awaiter(this,void 0,void 0,function(){var r=this;return e.__generator(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,n)];case 1:return i.sent(),[4,this.persistence.no(function(t){return e.__awaiter(r,void 0,void 0,function(){return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.ol.Vl(t)];case 1:return e.sent(),this.lT&&(t&&!this.lT.ro?this.lT.start(this.N_):t||this.lT.stop()),[2]}})})})];case 2:return i.sent(),[2]}})})},n.prototype.fT=function(t){return new tr(this.persistence,new bi,t.RT)},n.prototype.ET=function(t){var e=new gi(this.N_,this.$d,this.Ud,t.RT,t.Qd);return this.Ud instanceof ai&&(this.Ud.ol=e),e},n.prototype.dT=function(t){var e=this.persistence.hh.ko;return new Hn(e,t.Aa)},n.prototype._T=function(t){var e=sn.$o(t.mT),n=t.platform.bc(t.mT.ii);return new sn(t.PT.synchronizeTabs,e,t.clientId,t.platform,Jn.hu(t.PT.cacheSizeBytes),t.Aa,n,this.Ud)},n.prototype.cT=function(t){if(t.PT.VT&&t.PT.synchronizeTabs){if(!ai.Gh(t.platform))throw new c(h.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var e=sn.$o(t.mT);return new ai(t.Aa,t.platform,e,t.clientId,t.RT)}return new hi},n.prototype.clearPersistence=function(t){var e=sn.$o(t);return sn.clearPersistence(e)},n}(Di),Si=function(){function t(t,e,n,r){this.platform=t,this.mT=e,this.credentials=n,this.Aa=r,this.clientId=Ee.cn()}return t.prototype.start=function(t,e){var n=this;this.gT();var r=new Ue,i=new Ue,o=!1;return this.credentials.l(function(s){if(!o)return o=!0,de("FirestoreClient","Initializing. user=",s.uid),n.pT(t,e,s,i).then(r.resolve,r.reject);n.Aa.Ua(function(){return n.Pl(s)})}),this.Aa.uo(function(){return r.promise}),i.promise},t.prototype.enableNetwork=function(){var t=this;return this.gT(),this.Aa.enqueue(function(){return t.ol.enableNetwork()})},t.prototype.pT=function(t,n,r,i){return e.__awaiter(this,void 0,void 0,function(){var o,s,u,a,h=this;return e.__generator(this,function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),[4,this.platform.yT(this.mT)];case 1:return o=c.sent(),s=this.platform.bc(this.mT.ii),u=function(t,e,n){return new Jr(t,e,s)}(o,this.credentials),[4,t.initialize({Aa:this.Aa,mT:this.mT,platform:this.platform,T_:u,clientId:this.clientId,RT:r,Qd:100,PT:n})];case 2:return c.sent(),this.persistence=t.persistence,this.Ud=t.Ud,this.N_=t.N_,this.$d=t.$d,this.ol=t.ol,this.lT=t.lT,this.bT=t.IT,this.persistence.ho(function(){return e.__awaiter(h,void 0,void 0,function(){return e.__generator(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),i.resolve(),[3,4];case 3:if(a=c.sent(),i.reject(a),!this.vT(a))throw a;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+a),this.pT(new Di,{VT:!1},r,i))];case 4:return[2]}})})},t.prototype.vT=function(t){return"FirebaseError"===t.name?t.code===h.FAILED_PRECONDITION||t.code===h.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.gT=function(){if(this.Aa.La)throw new c(h.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.Pl=function(t){return this.Aa.Wa(),de("FirestoreClient","Credential Changed. Current user: "+t.uid),this.ol.Pl(t)},t.prototype.disableNetwork=function(){var t=this;return this.gT(),this.Aa.enqueue(function(){return t.ol.disableNetwork()})},t.prototype.terminate=function(){var t=this;return this.Aa.qa(function(){return e.__awaiter(t,void 0,void 0,function(){return e.__generator(this,function(t){switch(t.label){case 0:return this.lT&&this.lT.stop(),[4,this.$d.mo()];case 1:return t.sent(),[4,this.Ud.mo()];case 2:return t.sent(),[4,this.persistence.mo()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},t.prototype.waitForPendingWrites=function(){var t=this;this.gT();var e=new Ue;return this.Aa.uo(function(){return t.ol.lf(e)}),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.gT();var i=new Ei(t,e,n);return this.Aa.uo(function(){return r.bT.listen(i)}),i},t.prototype.rl=function(t){var e=this;this.ST||this.Aa.uo(function(){return e.bT.rl(t)})},t.prototype.DT=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r=this;return e.__generator(this,function(i){switch(i.label){case 0:return this.gT(),n=new Ue,[4,this.Aa.enqueue(function(){return e.__awaiter(r,void 0,void 0,function(){var r,i,o;return e.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.N_.Uu(t)];case 1:return(r=e.sent())instanceof yt?n.resolve(r):r instanceof vt?n.resolve(null):n.reject(new c(h.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=e.sent(),o=Qn(i,"Failed to get document '"+t+" from cache"),n.reject(o),[3,3];case 3:return[2]}})})})];case 1:return[2,(i.sent(),n.promise)]}})})},t.prototype.CT=function(t){return e.__awaiter(this,void 0,void 0,function(){var n,r=this;return e.__generator(this,function(i){switch(i.label){case 0:return this.gT(),n=new Ue,[4,this.Aa.enqueue(function(){return e.__awaiter(r,void 0,void 0,function(){var r,i,o,s,u,a;return e.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.N_.ju(t,!0)];case 1:return r=e.sent(),i=new li(t,r.Ku),o=i.Vd(r.documents),s=i.xn(o,!1),n.resolve(s.snapshot),[3,3];case 2:return u=e.sent(),a=Qn(u,"Failed to execute query '"+t+" against cache"),n.reject(a),[3,3];case 3:return[2]}})})})];case 1:return[2,(i.sent(),n.promise)]}})})},t.prototype.write=function(t){var e=this;this.gT();var n=new Ue;return this.Aa.uo(function(){return e.ol.write(t,n)}),n.promise},t.prototype.ii=function(){return this.mT.ii},t.prototype.Df=function(t){var e=this;this.gT(),this.Aa.uo(function(){return e.bT.Df(t),Promise.resolve()})},t.prototype.Cf=function(t){var e=this;this.ST||this.Aa.uo(function(){return e.bT.Cf(t),Promise.resolve()})},Object.defineProperty(t.prototype,"ST",{get:function(){return this.Aa.La},enumerable:!0,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.gT();var n=new Ue;return this.Aa.uo(function(){return e.ol.runTransaction(e.Aa,t,n),Promise.resolve()}),n.promise},t}(),Ri=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.FT(this.observer.next,t)},t.prototype.error=function(t){this.FT(this.observer.error,t)},t.prototype.NT=function(){this.muted=!0},t.prototype.FT=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}();function Li(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Oi=function(){function t(t,e,n,r){this.firestore=t,this.timestampsInSnapshots=e,this.$T=n,this.converter=r}return t.prototype.kT=function(t){switch(O(t)){case 0:return null;case 1:return t.booleanValue;case 2:return j(t.integerValue||t.doubleValue);case 3:return this.LT(t.timestampValue);case 4:return this.MT(t);case 5:return t.stringValue;case 6:return new Ir(F(t.bytesValue));case 7:return this.OT(t.referenceValue);case 8:return this.xT(t.geoPointValue);case 9:return this.BT(t.arrayValue);case 10:return this.qT(t.mapValue);default:throw ge()}},t.prototype.qT=function(t){var e=this,n={};return I(t.fields||{},function(t,r){n[t]=e.kT(r)}),n},t.prototype.xT=function(t){return new Or(j(t.latitude),j(t.longitude))},t.prototype.BT=function(t){var e=this;return(t.values||[]).map(function(t){return e.kT(t)})},t.prototype.MT=function(t){switch(this.$T){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return S(n)?t(n):n}(t);return null==e?null:this.kT(e);case"estimate":return this.LT(R(t));default:return null}},t.prototype.LT=function(t){var e=M(t),n=new v(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},t.prototype.OT=function(t){var e=w.K(t);me(he(e));var n=new Ne(e.get(1),e.get(3)),r=new _(e.k(5));return n.isEqual(this.firestore.$c)||ye("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore.$c.projectId+"/"+this.firestore.$c.database+") instead."),new Mi(r,this.firestore,this.converter)},t}(),Vi=Jn.uu,Pi=function(){function t(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new c(h.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else cr("settings","non-empty string","host",t.host),this.host=t.host,fr("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(gr("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),fr("settings","object","credentials",t.credentials),this.credentials=t.credentials,fr("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),fr("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?ye("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&ye("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,fr("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Jn._u;else{if(t.cacheSizeBytes!==Vi&&t.cacheSizeBytes<Jn.cu)throw new c(h.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Jn.cu);this.cacheSizeBytes=t.cacheSizeBytes}fr("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Ui=function(){function t(n,r,i){var o=this;if(void 0===i&&(i=new Di),this.UT=null,this.QT=new Wn,this.INTERNAL={delete:function(){return e.__awaiter(o,void 0,void 0,function(){return e.__generator(this,function(t){switch(t.label){case 0:return this.WT(),[4,this.jT.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof n.options){var s=n;this.UT=s,this.$c=t.KT(s),this.GT=s.name,this.zT=new p(r)}else{var u=n;if(!u.projectId)throw new c(h.INVALID_ARGUMENT,"Must provide projectId");this.$c=new Ne(u.projectId,u.database),this.GT="[DEFAULT]",this.zT=new l}this.HT=i,this.YT=new Pi({})}return Object.defineProperty(t.prototype,"JT",{get:function(){return this.XT||(this.XT=new Mr(this.$c,this.YT.ignoreUndefinedProperties)),this.XT},enumerable:!0,configurable:!0}),t.prototype.settings=function(t){or("Firestore.settings",arguments,1),ar("Firestore.settings","object",1,t);var e=new Pi(t);if(this.jT&&!this.YT.isEqual(e))throw new c(h.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this.YT=e,void 0!==e.credentials&&(this.zT=function(t){if(!t)return new l;switch(t.type){case"gapi":var e=t.ZT;return me(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new y(e,t.V||"0");case"provider":return t.ZT;default:throw new c(h.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.WT(),this.jT.enableNetwork()},t.prototype.disableNetwork=function(){return this.WT(),this.jT.disableNetwork()},t.prototype.enablePersistence=function(t){var e,n;if(this.jT)throw new c(h.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1;return t&&(void 0!==t.experimentalTabSynchronization&&ye("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.tE(this.HT,{VT:!0,cacheSizeBytes:this.YT.cacheSizeBytes,synchronizeTabs:r})},t.prototype.clearPersistence=function(){return e.__awaiter(this,void 0,void 0,function(){var t,n=this;return e.__generator(this,function(r){if(void 0!==this.jT&&!this.jT.ST)throw new c(h.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return t=new Ue,[2,(this.QT.Ma(function(){return e.__awaiter(n,void 0,void 0,function(){var n,r;return e.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),n=this.eE(),[4,this.HT.clearPersistence(n)];case 1:return e.sent(),t.resolve(),[3,3];case 2:return r=e.sent(),t.reject(r),[3,3];case 3:return[2]}})})}),t.promise)]})})},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"sE",{get:function(){return this.WT(),this.jT.ST},enumerable:!0,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.WT(),this.jT.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){if(this.WT(),Li(t))return this.iE(t);ar("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.iE(e)},t.prototype.iE=function(t){var e=this,n=new Ri({next:function(){t.next&&t.next()},error:function(t){throw ge()}});return this.jT.Df(n),function(){n.NT(),e.jT.Cf(n)}},t.prototype.WT=function(){return this.jT||this.tE(new Di,{VT:!1}),this.jT},t.prototype.eE=function(){return new Ie(this.$c,this.GT,this.YT.host,this.YT.ssl,this.YT.forceLongPolling)},t.prototype.tE=function(t,e){var n=this.eE();return this.jT=new Si(ce.nt(),n,this.zT,this.QT),this.jT.start(t,e)},t.KT=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new c(h.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new c(h.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ne(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.UT)throw new c(h.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.UT},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){return or("Firestore.collection",arguments,1),ar("Firestore.collection","non-empty string",1,t),this.WT(),new Wi(w.K(t),this)},t.prototype.doc=function(t){return or("Firestore.doc",arguments,1),ar("Firestore.doc","non-empty string",1,t),this.WT(),Mi.nE(w.K(t),this)},t.prototype.collectionGroup=function(t){if(or("Firestore.collectionGroup",arguments,1),ar("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new c(h.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.WT(),new zi(new wt(w.G,t),this)},t.prototype.runTransaction=function(t){var e=this;return or("Firestore.runTransaction",arguments,1),ar("Firestore.runTransaction","function",1,t),this.WT().transaction(function(n){return t(new Ci(e,n))})},t.prototype.batch=function(){return this.WT(),new qi(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(le()){case r.LogLevel.DEBUG:return"debug";case r.LogLevel.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(or("Firestore.setLogLevel",arguments,1),ar("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":pe(r.LogLevel.DEBUG);break;case"error":pe(r.LogLevel.ERROR);break;case"silent":pe(r.LogLevel.SILENT);break;default:throw new c(h.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype.rE=function(){return this.YT.timestampsInSnapshots},t}(),Ci=function(){function t(t,e){this.hE=t,this.oE=e}return t.prototype.get=function(t){var e=this;or("Transaction.get",arguments,1);var n=$i("Transaction.get",t,this.hE);return this.oE.A_([n.kc]).then(function(t){if(!t||1!==t.length)return ge();var r=t[0];if(r instanceof vt)return new Fi(e.hE,n.kc,null,!1,!1,n.aE);if(r instanceof yt)return new Fi(e.hE,n.kc,r,!1,!1,n.aE);throw ge()})},t.prototype.set=function(t,e,n){ur("Transaction.set",arguments,2,3);var r=$i("Transaction.set",t,this.hE);n=Qi("Transaction.set",n);var i=Hi(r.aE,e,"Transaction.set"),o=i[0],s=i[1],u=n.merge||n.mergeFields?this.hE.JT.Dc(s,o,n.mergeFields):this.hE.JT.vc(s,o);return this.oE.set(r.kc,u),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return"string"==typeof e||e instanceof Nr?(sr("Transaction.update",arguments,3),r=$i("Transaction.update",t,this.hE),i=this.hE.JT.Fc("Transaction.update",e,n,o)):(or("Transaction.update",arguments,2),r=$i("Transaction.update",t,this.hE),i=this.hE.JT.Cc("Transaction.update",e)),this.oE.update(r.kc,i),this},t.prototype.delete=function(t){or("Transaction.delete",arguments,1);var e=$i("Transaction.delete",t,this.hE);return this.oE.delete(e.kc),this},t}(),qi=function(){function t(t){this.hE=t,this.uE=[],this.cE=!1}return t.prototype.set=function(t,e,n){ur("WriteBatch.set",arguments,2,3),this._E();var r=$i("WriteBatch.set",t,this.hE);n=Qi("WriteBatch.set",n);var i=Hi(r.aE,e,"WriteBatch.set"),o=i[0],s=i[1],u=n.merge||n.mergeFields?this.hE.JT.Dc(s,o,n.mergeFields):this.hE.JT.vc(s,o);return this.uE=this.uE.concat(u.Ac(r.kc,nt.ft())),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this._E(),"string"==typeof e||e instanceof Nr?(sr("WriteBatch.update",arguments,3),r=$i("WriteBatch.update",t,this.hE),i=this.hE.JT.Fc("WriteBatch.update",e,n,o)):(or("WriteBatch.update",arguments,2),r=$i("WriteBatch.update",t,this.hE),i=this.hE.JT.Cc("WriteBatch.update",e)),this.uE=this.uE.concat(i.Ac(r.kc,nt.exists(!0))),this},t.prototype.delete=function(t){or("WriteBatch.delete",arguments,1),this._E();var e=$i("WriteBatch.delete",t,this.hE);return this.uE=this.uE.concat(new ut(e.kc,nt.ft())),this},t.prototype.commit=function(){return this._E(),this.cE=!0,this.uE.length>0?this.hE.WT().write(this.uE):Promise.resolve()},t.prototype._E=function(){if(this.cE)throw new c(h.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Mi=function(){function t(t,e,n){this.kc=t,this.firestore=e,this.aE=n,this.jT=this.firestore.WT()}return t.nE=function(e,n,r){if(e.length%2!=0)throw new c(h.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.j()+" has "+e.length);return new t(new _(e),n,r)},Object.defineProperty(t.prototype,"id",{get:function(){return this.kc.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Wi(this.kc.path.L(),this.firestore,this.aE)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.kc.path.j()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(or("DocumentReference.collection",arguments,1),ar("DocumentReference.collection","non-empty string",1,t),!t)throw new c(h.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=w.K(t);return new Wi(this.kc.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw mr("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this.kc.isEqual(e.kc)&&this.aE===e.aE},t.prototype.set=function(t,e){ur("DocumentReference.set",arguments,1,2),e=Qi("DocumentReference.set",e);var n=Hi(this.aE,t,"DocumentReference.set"),r=n[0],i=n[1],o=e.merge||e.mergeFields?this.firestore.JT.Dc(i,r,e.mergeFields):this.firestore.JT.vc(i,r);return this.jT.write(o.Ac(this.kc,nt.ft()))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof Nr?(sr("DocumentReference.update",arguments,2),n=this.firestore.JT.Fc("DocumentReference.update",t,e,r)):(or("DocumentReference.update",arguments,1),n=this.firestore.JT.Cc("DocumentReference.update",t)),this.jT.write(n.Ac(this.kc,nt.exists(!0)))},t.prototype.delete=function(){return or("DocumentReference.delete",arguments,0),this.jT.write([new ut(this.kc,nt.ft())])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ur("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||Li(t[i])||(gr("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),fr("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return Li(t[i])?n=t[i]:(ar("DocumentReference.onSnapshot","function",i,t[i]),hr("DocumentReference.onSnapshot","function",i+1,t[i+1]),hr("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.lE(o,n)},t.prototype.lE=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Ri({next:function(t){if(e.next){var r=t.docs.get(n.kc);e.next(new Fi(n.firestore,n.kc,r,t.fromCache,t.hasPendingWrites,n.aE))}},error:r}),o=this.jT.listen(wt.Wt(this.kc.path),i,t);return function(){i.NT(),n.jT.rl(o)}},t.prototype.get=function(t){var e=this;return ur("DocumentReference.get",arguments,0,1),Yi("DocumentReference.get",t),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.WT().DT(e.kc).then(function(t){n(new Fi(e.firestore,e.kc,t,!0,t instanceof yt&&t.At,e.aE))},r):e.dE(n,r,t)})},t.prototype.dE=function(t,e,n){var r=this.lE({includeMetadataChanges:!0,Of:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new c(h.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new c(h.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t.prototype.withConverter=function(e){return new t(this.kc,this.firestore,e)},t}(),ji=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Fi=function(){function t(t,e,n,r,i,o){this.hE=t,this.kc=e,this.fE=n,this.TE=r,this.EE=i,this.aE=o}return t.prototype.data=function(t){if(ur("DocumentSnapshot.data",arguments,0,1),t=Ki("DocumentSnapshot.data",t),this.fE){if(this.aE){var e=new Bi(this.hE,this.kc,this.fE,this.TE,this.EE);return this.aE.fromFirestore(e,t)}return new Oi(this.hE,this.hE.rE(),t.serverTimestamps,void 0).kT(this.fE.Lt())}},t.prototype.get=function(t,e){if(ur("DocumentSnapshot.get",arguments,1,2),e=Ki("DocumentSnapshot.get",e),this.fE){var n=this.fE.data().field(Gr("DocumentSnapshot.get",t));if(null!==n)return new Oi(this.hE,this.hE.rE(),e.serverTimestamps,this.aE).kT(n)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.kc.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Mi(this.kc,this.hE,this.aE)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.fE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new ji(this.EE,this.TE)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw mr("isEqual","DocumentSnapshot",1,e);return this.hE===e.hE&&this.TE===e.TE&&this.kc.isEqual(e.kc)&&(null===this.fE?null===e.fE:this.fE.isEqual(e.fE))&&this.aE===e.aE},t}(),Bi=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),n.prototype.data=function(e){return t.prototype.data.call(this,e)},n}(Fi),zi=function(){function t(t,e,n){this.IE=t,this.firestore=e,this.aE=n}return t.prototype.where=function(e,n,r){or("Query.where",arguments,3),vr("Query.where",3,r);var i,o=function(t,e,n,r){if(!e.some(function(t){return t===r}))throw new c(h.INVALID_ARGUMENT,"Invalid value "+yr(r)+" provided to function Query.where() for its "+Er(2)+" argument. Acceptable values: "+e.join(", "));return r}(0,["<","<=","==",">=",">","array-contains","in","array-contains-any"],0,n),s=Gr("Query.where",e);if(s.Y()){if("array-contains"===o||"array-contains-any"===o)throw new c(h.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o){this.wE(r,o);for(var u=[],a=0,f=r;a<f.length;a++){var l=f[a];u.push(this.RE(l))}i={arrayValue:{values:u}}}else i=this.RE(r)}else"in"!==o&&"array-contains-any"!==o||this.wE(r,o),i=this.firestore.JT.Nc("Query.where",r,"in"===o);var p=Et.create(s,o,i);return this.AE(p),new t(this.IE.Gt(p),this.firestore,this.aE)},t.prototype.orderBy=function(e,n){var r;if(ur("Query.orderBy",arguments,1,2),hr("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new c(h.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}if(null!==this.IE.startAt)throw new c(h.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.IE.endAt)throw new c(h.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Gr("Query.orderBy",e),o=new kt(i,r);return this.mE(o),new t(this.IE.zt(o),this.firestore,this.aE)},t.prototype.limit=function(e){return or("Query.limit",arguments,1),ar("Query.limit","number",1,e),wr("Query.limit",1,e),new t(this.IE.Ht(e),this.firestore,this.aE)},t.prototype.limitToLast=function(e){return or("Query.limitToLast",arguments,1),ar("Query.limitToLast","number",1,e),wr("Query.limitToLast",1,e),new t(this.IE.Yt(e),this.firestore,this.aE)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];sr("Query.startAt",arguments,1);var i=this.PE("Query.startAt",e,n,!0);return new t(this.IE.Jt(i),this.firestore,this.aE)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];sr("Query.startAfter",arguments,1);var i=this.PE("Query.startAfter",e,n,!1);return new t(this.IE.Jt(i),this.firestore,this.aE)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];sr("Query.endBefore",arguments,1);var i=this.PE("Query.endBefore",e,n,!0);return new t(this.IE.Xt(i),this.firestore,this.aE)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];sr("Query.endAt",arguments,1);var i=this.PE("Query.endAt",e,n,!1);return new t(this.IE.Xt(i),this.firestore,this.aE)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw mr("isEqual","Query",1,e);return this.firestore===e.firestore&&this.IE.isEqual(e.IE)},t.prototype.withConverter=function(e){return new t(this.IE,this.firestore,e)},t.prototype.PE=function(t,e,n,r){if(vr(t,1,e),e instanceof Fi){if(n.length>0)throw new c(h.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new c(h.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.VE(i.fE,r)}var o=[e].concat(n);return this.gE(t,o,r)},t.prototype.VE=function(t,e){for(var n=[],r=0,i=this.IE.orderBy;r<i.length;r++){var o=i[r];if(o.field.Y())n.push(B(this.firestore.$c,t.key));else{var s=t.field(o.field);if(S(s))throw new c(h.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=o.field.j();throw new c(h.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new At(n,e)},t.prototype.gE=function(t,e,n){var r=this.IE.xt;if(e.length>r.length)throw new c(h.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.Y()){if("string"!=typeof s)throw new c(h.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.IE._e()&&-1!==s.indexOf("/"))throw new c(h.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.IE.path.child(w.K(s));if(!_.et(u))throw new c(h.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new _(u);i.push(B(this.firestore.$c,a))}else{var f=this.firestore.JT.Nc(t,s);i.push(f)}}return new At(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ur("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||Li(t[i])||(gr("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),fr("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),Li(t[i])?n=t[i]:(ar("Query.onSnapshot","function",i,t[i]),hr("Query.onSnapshot","function",i+1,t[i+1]),hr("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.pE(this.IE),this.lE(r,n)},t.prototype.lE=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Ri({next:function(t){e.next&&e.next(new Gi(n.firestore,n.IE,t,n.aE))},error:r}),o=this.firestore.WT(),s=o.listen(this.IE,i,t);return function(){i.NT(),o.rl(s)}},t.prototype.pE=function(t){if(t.ae()&&0===t.xt.length)throw new c(h.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},t.prototype.get=function(t){var e=this;return ur("Query.get",arguments,0,1),Yi("Query.get",t),this.pE(this.IE),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.WT().CT(e.IE).then(function(t){n(new Gi(e.firestore,e.IE,t,e.aE))},r):e.dE(n,r,t)})},t.prototype.dE=function(t,e,n){var r=this.lE({includeMetadataChanges:!0,Of:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new c(h.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.RE=function(t){if("string"==typeof t){if(""===t)throw new c(h.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.IE._e()&&-1!==t.indexOf("/"))throw new c(h.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.IE.path.child(w.K(t));if(!_.et(e))throw new c(h.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return B(this.firestore.$c,new _(e))}if(t instanceof Mi){var n=t;return B(this.firestore.$c,n.kc)}throw new c(h.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+yr(t)+".")},t.prototype.wE=function(t,e){if(!Array.isArray(t)||0===t.length)throw new c(h.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new c(h.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(t.indexOf(null)>=0)throw new c(h.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter(function(t){return Number.isNaN(t)}).length>0)throw new c(h.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},t.prototype.AE=function(t){if(t instanceof Et){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],r=e.indexOf(t.op)>=0,i=n.indexOf(t.op)>=0;if(t.ue()){var o=this.IE.jt();if(null!==o&&!o.isEqual(t.field))throw new c(h.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.IE.Kt();null!==s&&this.yE(t.field,s)}else if(i||r){var u=null;if(i&&(u=this.IE.ce(n)),null===u&&r&&(u=this.IE.ce(e)),null!=u)throw u===t.op?new c(h.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new c(h.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},t.prototype.mE=function(t){if(null===this.IE.Kt()){var e=this.IE.jt();null!==e&&this.yE(e,t.field)}},t.prototype.yE=function(t,e){if(!e.isEqual(t))throw new c(h.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),Gi=function(){function t(t,e,n,r){this.hE=t,this.bE=e,this.vE=n,this.aE=r,this.SE=null,this.DE=null,this.metadata=new ji(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.vE.docs.B()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.vE.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;ur("QuerySnapshot.forEach",arguments,1,2),ar("QuerySnapshot.forEach","function",1,t),this.vE.docs.forEach(function(r){t.call(e,n.CE(r))})},Object.defineProperty(t.prototype,"query",{get:function(){return new zi(this.bE,this.hE,this.aE)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(gr("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),fr("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.vE.hs)throw new c(h.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.SE&&this.DE===e||(this.SE=function(t,e,n,r){if(n.ss.B()){var i=0;return n.docChanges.map(function(e){var o=new Bi(t,e.doc.key,e.doc,n.fromCache,n.ns.has(e.doc.key),r);return e.doc,{type:"added",doc:o,oldIndex:-1,newIndex:i++}})}var o=n.ss;return n.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var i=new Bi(t,e.doc.key,e.doc,n.fromCache,n.ns.has(e.doc.key),r),s=-1,u=-1;return 0!==e.type&&(s=o.indexOf(e.doc.key),o=o.delete(e.doc.key)),1!==e.type&&(u=(o=o.add(e.doc)).indexOf(e.doc.key)),{type:Ji(e.type),doc:i,oldIndex:s,newIndex:u}})}(this.hE,e,this.vE,this.aE),this.DE=e),this.SE},t.prototype.isEqual=function(e){if(!(e instanceof t))throw mr("isEqual","QuerySnapshot",1,e);return this.hE===e.hE&&this.bE.isEqual(e.bE)&&this.vE.isEqual(e.vE)&&this.aE===e.aE},t.prototype.CE=function(t){return new Bi(this.hE,t.key,t,this.metadata.fromCache,this.vE.ns.has(t.key),this.aE)},t}(),Wi=function(t){function n(e,n,r){var i=this;if((i=t.call(this,wt.Wt(e),n,r)||this).FE=e,e.length%2!=1)throw new c(h.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.j()+" has "+e.length);return i}return e.__extends(n,t),Object.defineProperty(n.prototype,"id",{get:function(){return this.IE.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){var t=this.IE.path.L();return t.B()?null:new Mi(new _(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"path",{get:function(){return this.IE.path.j()},enumerable:!0,configurable:!0}),n.prototype.doc=function(t){if(ur("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Ee.cn()),ar("CollectionReference.doc","non-empty string",1,t),""===t)throw new c(h.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=w.K(t);return Mi.nE(this.IE.path.child(e),this.firestore,this.aE)},n.prototype.add=function(t){or("CollectionReference.add",arguments,1),ar("CollectionReference.add","object",1,this.aE?this.aE.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},n.prototype.withConverter=function(t){return new n(this.FE,this.firestore,t)},n}(zi);function Qi(t,e){if(void 0===e)return{merge:!1};if(gr(t,e,["merge","mergeFields"]),fr(t,"boolean","merge",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new c(h.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+yr(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new c(h.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+o+" was: "+yr(r[o]))}(t,"mergeFields",0,r,function(t){return"string"==typeof t||t instanceof Nr})}(t,0,0,e.mergeFields),void 0!==e.mergeFields&&void 0!==e.merge)throw new c(h.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Ki(t,e){return void 0===e?{}:(gr(t,e,["serverTimestamps"]),lr(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Yi(t,e){hr(t,"object",1,e),e&&(gr(t,e,["source"]),lr(t,0,"source",e.source,["default","server","cache"]))}function $i(t,e,n){if(e instanceof Mi){if(e.firestore!==n)throw new c(h.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw mr(t,"DocumentReference",1,e)}function Ji(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ge()}}function Hi(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}function Xi(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new c(h.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}var Zi=Xi(Ui,"Use firebase.firestore() instead."),to=Xi(Ci,"Use firebase.firestore().runTransaction() instead."),eo=Xi(qi,"Use firebase.firestore().batch() instead."),no=Xi(Mi,"Use firebase.firestore().doc() instead."),ro=Xi(Fi),io=Xi(Bi),oo=Xi(zi),so=Xi(Gi),uo=Xi(Wi,"Use firebase.firestore().collection() instead."),ao=Xi(function(){function t(){}return t.delete=function(){return ir("FieldValue.delete",arguments),new Dr},t.serverTimestamp=function(){return ir("FieldValue.serverTimestamp",arguments),new xr},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return sr("FieldValue.arrayUnion",arguments,1),new Sr(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return sr("FieldValue.arrayRemove",arguments,1),new Rr(t)},t.increment=function(t){return ar("FieldValue.increment","number",1,t),or("FieldValue.increment",arguments,1),new Lr(t)},t.prototype.isEqual=function(t){return this===t},t}(),"Use FieldValue.<field>() instead."),ho=Xi(Ir,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),co={Firestore:Zi,GeoPoint:Or,Timestamp:v,Blob:ho,Transaction:to,WriteBatch:eo,DocumentReference:no,DocumentSnapshot:ro,Query:oo,QueryDocumentSnapshot:io,QuerySnapshot:so,CollectionReference:uo,FieldPath:Nr,FieldValue:ao,setLogLevel:Ui.setLogLevel,CACHE_SIZE_UNLIMITED:Vi},fo=function(){function t(){}return t.prototype.B_=function(t){},t.prototype.mo=function(){},t}(),lo=function(){function t(){var t=this;this.NE=function(){return t.$E()},this.kE=function(){return t.LE()},this.ME=[],this.OE()}return t.prototype.B_=function(t){this.ME.push(t)},t.prototype.mo=function(){window.removeEventListener("online",this.NE),window.removeEventListener("offline",this.kE)},t.prototype.OE=function(){window.addEventListener("online",this.NE),window.addEventListener("offline",this.kE)},t.prototype.$E=function(){de("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.ME;t<e.length;t++)(0,e[t])(0)},t.prototype.LE=function(){de("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.ME;t<e.length;t++)(0,e[t])(1)},t.Gh=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),po=function(){function t(t){this.xE=t.xE,this.BE=t.BE}return t.prototype.e_=function(t){this.qE=t},t.prototype.Yc=function(t){this.UE=t},t.prototype.onMessage=function(t){this.QE=t},t.prototype.close=function(){this.BE()},t.prototype.send=function(t){this.xE(t)},t.prototype.WE=function(){this.qE()},t.prototype.jE=function(t){this.UE(t)},t.prototype.KE=function(t){this.QE(t)},t}(),yo={BatchGetDocuments:"batchGet",Commit:"commit"},vo="gl-js/ fire/"+u,go=function(){function t(t){this.ii=t.ii;var e=t.ssl?"https":"http";this.GE=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype.zE=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=vo},t.prototype.d_=function(t,e,n){var r=this,i=this.HE(t);return new Promise(function(o,u){var a=new s.XhrIo;a.listenOnce(s.EventType.COMPLETE,function(){try{switch(a.getLastErrorCode()){case s.ErrorCode.NO_ERROR:var e=a.getResponseJson();de("Connection","XHR received:",JSON.stringify(e)),o(e);break;case s.ErrorCode.TIMEOUT:de("Connection",'RPC "'+t+'" timed out'),u(new c(h.DEADLINE_EXCEEDED,"Request time out"));break;case s.ErrorCode.HTTP_ERROR:var n=a.getStatus();if(de("Connection",'RPC "'+t+'" failed with status:',n,"response text:",a.getResponseText()),n>0){var r=a.getResponseJson().error;if(r&&r.status&&r.message){var i=function(t){var e=r.status.toLowerCase().replace("_","-");return Object.values(h).indexOf(e)>=0?e:h.UNKNOWN}();u(new c(i,r.message))}else u(new c(h.UNKNOWN,"Server responded with status "+a.getStatus()))}else de("Connection",'RPC "'+t+'" failed'),u(new c(h.UNAVAILABLE,"Connection failed."));break;default:ge()}}finally{de("Connection",'RPC "'+t+'" completed.')}});var f=Object.assign({},e);delete f.database;var l=JSON.stringify(f);de("Connection","XHR sending: ",i+" "+l);var p={"Content-Type":"text/plain"};r.zE(p,n),a.send(i,"POST",l,p,15)})},t.prototype.f_=function(t,e,n){return this.d_(t,e,n)},t.prototype.s_=function(t,e){var n=[this.GE,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=s.createWebChannelTransport(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ii.projectId+"/databases/"+this.ii.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.zE(o.initMessageHeaders,e),i.isMobileCordova()||i.isReactNative()||i.isElectron()||i.isIE()||i.isUWP()||i.isBrowserExtension()||(o.httpHeadersOverwriteParam="$httpHeaders");var u=n.join("");de("Connection","Creating WebChannel: "+u+" "+o);var a=r.createWebChannel(u,o),f=!1,l=!1,p=new po({xE:function(t){l?de("Connection","Not sending because WebChannel is closed:",t):(f||(de("Connection","Opening WebChannel transport."),a.open(),f=!0),de("Connection","WebChannel sending:",t),a.send(t))},BE:function(){return a.close()}}),d=function(t,e){a.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return d(s.WebChannel.EventType.OPEN,function(){l||de("Connection","WebChannel transport opened.")}),d(s.WebChannel.EventType.CLOSE,function(){l||(l=!0,de("Connection","WebChannel transport closed"),p.jE())}),d(s.WebChannel.EventType.ERROR,function(t){l||(l=!0,de("Connection","WebChannel transport errored:",t),p.jE(new c(h.UNAVAILABLE,"The operation could not be completed")))}),d(s.WebChannel.EventType.MESSAGE,function(t){var e;if(!l){var n=t.data[0];me(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){de("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=lt[o];if(void 0!==e)return Rt(e)}(),u=i.message;void 0===s&&(s=h.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),l=!0,p.jE(new c(s,u)),a.close()}else de("Connection","WebChannel received:",n),p.KE(n)}}),setTimeout(function(){p.WE()},0),p},t.prototype.HE=function(t){var e=yo[t];return this.GE+"/v1/projects/"+this.ii.projectId+"/databases/"+this.ii.database+"/documents:"+e},t}();function mo(t){!function(t,e){t.INTERNAL.registerComponent(new o.Component("firestore",function(t){return function(t,e){return new Ui(t,e,new xi)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},co)))}(t),t.registerVersion("@firebase/firestore","1.14.6")}ce.an(new(function(){function t(){this.ac="undefined"!=typeof atob}return Object.defineProperty(t.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),t.prototype.yT=function(t){return Promise.resolve(new go(t))},t.prototype.AT=function(){return lo.Gh()?new lo:new fo},t.prototype.bc=function(t){return new ae(t,{hi:!0})},t.prototype.un=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t.prototype._n=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n},t}())),mo(n),exports.__PRIVATE_registerFirestore=mo;
},{"tslib":"CvJj","@firebase/app":"QzTI","@firebase/logger":"srlT","@firebase/util":"rrEo","@firebase/component":"YHdR","@firebase/webchannel-wrapper":"VoiF"}],"MGW6":[function(require,module,exports) {
"use strict";require("@firebase/firestore");
},{"@firebase/firestore":"NkAH"}],"v51U":[function(require,module,exports) {
module.exports="/arrow-down-white.5a64bee5.png";
},{}],"n7hx":[function(require,module,exports) {
module.exports="/icon-standalone.2558c175.svg";
},{}],"wqla":[function(require,module,exports) {
"use strict";function e(e,t,r){return[[e[0]*(1-r)+t[0]*r,e[1]*(1-r)+t[1]*r],[e[0]*r+t[0]*(1-r),e[1]*r+t[1]*(1-r)]]}function t(r,n=1,o=.25){if(n>10&&(n=10),0==n)return r;const u=r.length,s=[];for(let t=0;t<u;t++){const n=r[t],f=r[(t+1)%u],[c,i]=e(n,f,o);s.push(c,i)}return t(s,o,n-1)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r=t;exports.default=r;
},{}],"A2T1":[function(require,module,exports) {
"use strict";var e=require("preact"),t=require("preact/hooks"),n=p(require("react-use/lib/useInterval")),o=p(require("react-use/lib/useRafState")),a=p(require("d3-contour/src/contours")),i=p(require("nano-memoize")),r=require("@turf/helpers"),l=h(require("firebase/app"));require("firebase/firestore");var s=p(require("./assets/arrow-down-white.png")),d=p(require("./icons/icon-standalone.svg")),c=p(require("./utils/chaikin"));function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function h(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}function p(e){return e&&e.__esModule?e:{default:e}}function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}l.initializeApp({projectId:"check-weather-sg"});const f=l.firestore(),g=217,y=120,v=[103.8475,1.3011],w=1.156,b=1.475,x=103.565,M=104.13,F=Math.abs(104.13-103.565),C=Math.abs(1.475-1.156),P=(0,r.polygon)([[[-180,90],[180,90],[180,-90],[-180,-90],[-180,90]],[[103.565,1.475],[104.13,1.475],[104.13,1.156],[103.565,1.156],[103.565,1.475]]]),E=["#40FFFD","#3BEEEC","#32D0D2","#2CB9BD","#229698","#1C827D","#1B8742","#229F44","#27B240","#2CC53B","#30D43E","#38EF46","#3BFB49","#59FA61","#FEFB63","#FDFA53","#FDEB50","#FDD74A","#FCC344","#FAB03F","#FAA23D","#FB8938","#FB7133","#F94C2D","#F9282A","#DD1423","#BE0F1D","#B21867","#D028A6","#F93DF5"],_=E.length,B={type:"Polygon",coordinates:[[[103.56983184814452,1.1984523335134731],[103.71986389160156,1.1459349466540576],[104.13459777832031,1.2763684180848154],[104.0789794921875,1.3580576343735706],[104.09442901611328,1.3913503559342686],[104.08344268798828,1.4260154737416286],[104.04155731201172,1.4462651532861726],[103.97151947021484,1.4229265238497912],[103.9368438720703,1.4304772829308758],[103.89667510986328,1.4263586901405338],[103.86817932128906,1.4555318956783565],[103.81153106689452,1.4788701887242242],[103.75968933105469,1.4469515799492016],[103.72535705566406,1.4596504356431457],[103.67523193359375,1.4308204986633148],[103.65943908691406,1.4067952740787528],[103.61721038818358,1.323391529857783],[103.56983184814452,1.1984523335134731]]]};mapboxgl.accessToken="pk.eyJ1IjoiY2hlZWF1biIsImEiOiJjam9weHp6MTUwZThvM3FwM3pjd2J1ZGU5In0.gW0WGZAbconHv5JYwSFI6w",window.$map&&window.$map.remove();const D=[103.565,1.156,104.13,1.475],z=()=>({padding:window.innerWidth>640&&window.innerHeight>640?120:0}),A=window.$map=new mapboxgl.Map({container:"map",center:v,style:"mapbox://styles/cheeaun/ck7rpspsa2mwh1imt7s5ual7l",minZoom:8,maxZoom:14,renderWorldCopies:!1,boxZoom:!1,pitchWithRotate:!1,dragRotate:!1,touchPitch:!1,attributionControl:!1,bounds:D,fitBoundsOptions:z()});A.touchZoomRotate.disableRotation(),A.addControl(new mapboxgl.NavigationControl({showCompass:!1}),"top-right"),A.addControl(new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),"top-right");class S{onAdd(e){this._map=e,this._container=document.createElement("div"),this._container.className="mapboxgl-ctrl mapboxgl-ctrl-group";const t=document.createElement("button");return t.type="button",t.title="Snap to boundary",t.innerHTML='<svg height="100%" width="100%" viewBox="0 0 24 24" fill="#333"><path d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm-7 7H3v4c0 1.1.9 2 2 2h4v-2H5v-4zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2V5zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2zm0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2v4z"/></svg>',t.onclick=(t=>{t.preventDefault(),this._container.hidden=!0,e.fitBounds(D,z(),{snap:!0})}),this._container.appendChild(t),this._container.hidden=!0,e.on("moveend",e=>{e.snap||(this._container.hidden=!1)}),this._container}onRemove(){this._container.parentNode.removeChild(this._container),this._map=void 0}}A.addControl(new S,"top-right");const I=document.getElementById("loader");A.on("dataloading",e=>{I.hidden=!1});let k=null;A.on("data",e=>{clearTimeout(k),k=setTimeout(()=>{I.hidden=!0},500)});const j=document.getElementById("legend"),q=document.getElementById("info-button"),O=document.getElementById("legend-close");q.onclick=(e=>{e.preventDefault(),j.hidden=!j.hidden}),O.onclick=(e=>{e.preventDefault(),j.hidden=!0});const L=(0,i.default)(e=>{return(e.match(/\d{4}$/)||[""])[0].replace(/(\d{2})(\d{2})/,(e,t,n)=>{let o=parseInt(t,10);const a=o>=12?"PM":"AM";return 0==o&&(o=12),o>12&&(o-=12),o+":"+n+" "+a})}),T=(0,i.default)(e=>(0,r.round)(103.565+e/217*F,4)),$=(0,i.default)(e=>(0,r.round)(1.475-e/120*C,4)),H=(0,i.default)((e,t)=>{const n=t.trimEnd().split(/\n/g),o=new Array(26040).fill(0);for(let a=0,i=n.length;a<i;a++){const e=n[a];for(let t=e.search(/[^\s]/),n=e.length;t<n;t++){const n=e[t];if(n&&" "!==n){const e=n.charCodeAt()-33;o[217*a+t]=e}}}return o},{maxArgs:1}),R=(0,a.default)().size([217,120]).thresholds([4,10,20,30,40,50,60,70,80,85,90,95,97.5]).smooth(!1),W=(0,i.default)((e,t)=>{const n=[],o=R(t);for(let a=0,i=o.length;a<i;a++){const{type:t,value:i,coordinates:r}=o[a];r.length&&n.push({type:"Feature",properties:{intensity:i,id:e},geometry:{type:t,coordinates:r.map(e=>e.map(e=>(e.pop(),(0,c.default)(e.map(([e,t])=>[T(e),$(t)])))))}})}return n},{maxArgs:1}),Z=(0,i.default)((e,t,n)=>{const o=[];for(let a=0,i=t.length;a<i;a++)o[a]=(t[a]+n[a])/2;return o},{maxArgs:1}),V=()=>{fetch("https://api.checkweather.sg/v2/observations").then(e=>e.json()).then(e=>{const t=e.map(e=>{const{id:t,lng:n,lat:o,...a}=e;return(0,r.point)([n,o],a,{id:t})}),n=(0,r.featureCollection)(t);A.getSource("observations").setData(n)})},N=(e,t,n=!1)=>{n&&e(),setTimeout(requestAnimationFrame,t,()=>{e(),N(e,t)})},U=({values:t=[],maxValue:n=null,smoothIterations:o=1,style:a={},...i})=>{if(!t.length)return null;const r=t.length-1,l=n||Math.max(...t);let s="";return(0,c.default)(t.map((e,t)=>{return[Math.round(t/r*100),Math.round(e/l*100)]}),o).forEach((e,t)=>{t>0&&(s+=","),s+=`${e[0]}% ${100-e[1]}%`}),(0,e.h)("div",m({},i,{style:{...a,clipPath:`polygon(0 100%, ${s}, 100% 100%)`}}))},J=()=>{let e="";for(let t=0;t<120;t++){for(let t=0;t<217;t++){const n=~~Math.round(t/217*100);e+=String.fromCharCode(n+33)}e+="\n"}return e};function G(e,t=1){let n;return function(...o){clearTimeout(n),n=setTimeout(()=>e.call(this,...o),t)}}const X=new Promise(e=>{A.once("styledata",e)}),Y=25,K=f.collection("weather").orderBy("id","desc").limit(25);let Q=!0;const ee=()=>{const[a,i]=(0,t.useState)(!1),[l,s]=(0,o.default)(null),[d,c]=(0,o.default)([]),[u,h]=(0,t.useState)(!1),[p,m]=(0,t.useState)(!1),[f,g]=(0,t.useState)(document.hidden);(0,t.useEffect)(()=>{document.addEventListener("visibilitychange",()=>{g(document.hidden)},!1)},[]);const y=G(e=>{Q&&console.timeEnd("Fetch Snapshots"),i(!1);const t=()=>{console.time("Process Snapshots");const t=[],n=[],o=e.docs.reverse();o.forEach((e,a)=>{const i=e.data(),r=H(e.id,i.radar),l=W(e.id,r);n.push(...l);const s=o[a+1];if(s){const t=s.data(),o=H(s.id,t.radar),a=`${(Number(e.id)+Number(s.id))/2}`,i=Z(a,r,o),l=W(a,i);n.push(...l)}t.push(i)});const a=(0,r.featureCollection)(n);X.then(()=>{A.getFilter("rainradar")||A.setFilter("rainradar",["==","id",e.docs[0].id],{validate:!1}),A.getSource("rainradar").setData(a),l||s(t.length),c(t)}),console.timeEnd("Process Snapshots")};if(Q){const n=e.docs[0],o=n.data().radar,a=H(n.id,o),i=W(n.id,a);X.then(()=>{A.getSource("rainradar").setData((0,r.featureCollection)(i)),Q=!1,A.once("idle",()=>requestAnimationFrame(t))})}else t()},300);(0,t.useEffect)(()=>{let e=()=>{};return f?(h(!1),Q=!1):(console.log("Start Snapshots"),console.time("Fetch Snapshots"),i(!0),e=K.onSnapshot(y)),()=>e()},[f]);const v=d.length;if(v<=1)return null;(0,t.useEffect)(()=>{if(l&&v){const e=Math.round(l),t=.5*Math.round(l/.5);let n=d[e-1].id;if(t!==e){const e=d[Math.floor(t)-1],o=d[Math.ceil(t)-1];if(e&&o){n=`${(e.dt+o.dt)/2}`}}m(!1),A.setFilter("rainradar",["==","id",n],{validate:!1});const o=l<v-1;A.setPaintProperty("tempreadings","text-opacity",o?.3:1),A.setPaintProperty("humidreadings","text-opacity",o?.3:1),A.setPaintProperty("rainreadings","text-opacity",o?.3:1),A.setPaintProperty("windirections","icon-opacity",o?.1:.3)}},[l,d]),(0,t.useEffect)(()=>{l<v&&!u&&m(!0)},[d]);const{id:w}=d[Math.round(l)-1],b=d.map(e=>e.coverage_percentage.sg),x=Math.max(...b);(0,n.default)(()=>{const e=l>=v;e&&x<5?h(!1):s(e?1:l+.5)},u?l===v?2e3:100:null);const M=(l-1)/(v-1)*100,F=Math.max(x/100*40,30),C=Math.max(x/100*24,16);return(0,e.h)("div",{id:"player-content",class:a?"loading":""},(0,e.h)("div",{id:"player-button",class:u?"playing":"",onClick:()=>{p?s(v):(l!==v||u||s(1),h(!u))}},(0,e.h)("div",{id:"player-icon"},(0,e.h)("svg",{width:C,height:C,viewBox:"0 0 24 24"},(0,e.h)("path",{d:p?"M4 18l8.5-6L4 6v12zm9-12v12l8.5-6L13 6z":u?"M6 19h4V5H6v14zm8-14v14h4V5h-4z":"M8 5v14l11-7z"})))),(0,e.h)("div",{id:"player-range"},(0,e.h)("div",{id:"player-time",class:l===v?"now":"",style:{left:`${M}%`,transform:`translateX(-${M}%)`}},L(w)),(0,e.h)(U,{values:b,maxValue:100,smoothIterations:2,style:{height:F},id:"player-sparkline"}),(0,e.h)("progress",{value:l,max:v}),(0,e.h)("div",{id:"player-labels"},(0,e.h)("span",null,L(d[0].id)),(0,e.h)("span",null,L(d[Math.round(v/2)-1].id)),(0,e.h)("span",null,L(d[v-1].id))),(0,e.h)("input",{type:"range",min:"1",max:v,step:"any",value:l,onInput:e=>{h(!1),s(e.target.value)},onMouseUp:()=>s(Math.round(l)),onTouchEnd:e=>{s(Math.round(l));const t=e.changedTouches[0];if(t){const{width:e,x:n}=t.target.getBoundingClientRect(),o=8,a=e-2*o,i=(t.clientX-o-n)/a*(v-1)+1;s(Math.max(1,Math.min(v,Math.round(i))))}},onTouchCancel:()=>s(Math.round(l))})))};(0,e.render)((0,e.h)(ee,null),document.getElementById("player")),(async()=>{await X,A.addSource("observations",{type:"geojson",data:{type:"FeatureCollection",features:[]},tolerance:5,buffer:0}),A.addSource("rainradar",{type:"geojson",data:{type:"FeatureCollection",features:[]}});const e=A.getStyle().layers;let t;for(let o=0;o<e.length;o++){const{id:n,type:a,layout:i}=e[o];if("symbol"===a&&i["text-field"]&&(t||(t=e[o].id)),"symbol"===a){const e=A.getPaintProperty(n,"text-opacity");A.setPaintProperty(n,"text-opacity",["case",["within",B],e||1,0]);const t=A.getPaintProperty(n,"icon-opacity");"number"==typeof t&&A.setPaintProperty(n,"icon-opacity",["case",["within",B],t||1,0])}}const n=["interpolate-lab",["linear"],["number",["get","intensity"],0],0,"transparent",...E.reduce((e,t,n)=>{const o=(n+1)/_*100;return e.push(o,t),e},[])];A.addLayer({id:"rainradar",type:"fill",source:"rainradar",layout:{"fill-sort-key":["number",["get","intensity"],0]},paint:{"fill-antialias":!1,"fill-color":n,"fill-opacity":["interpolate",["linear"],["zoom"],8,["case",[">",["number",["get","intensity"],0],90],1,.4],12,.05]}},"water-overlay"),A.addLayer({id:"tempreadings",type:"symbol",source:"observations",minzoom:8.5,filter:["all",["has","temp_celcius"],[">","temp_celcius",0]],layout:{"text-field":"{temp_celcius}°","text-allow-overlap":!0,"text-ignore-placement":!0,"text-size":["interpolate",["linear"],["zoom"],8,10,14,28],"text-padding":1},paint:{"text-color":"yellow","text-halo-color":"#000","text-halo-width":1.5}}),A.loadImage(s.default,(e,t)=>{A.addImage("arrow",t)}),A.addLayer({id:"windirections",type:"symbol",source:"observations",filter:["has","wind_direction"],layout:{"icon-image":"arrow","icon-rotate":["get","wind_direction"],"icon-allow-overlap":!0,"icon-ignore-placement":!0,"icon-size":["interpolate",["linear"],["zoom"],8,.05,14,.6]},paint:{"icon-opacity":.3}},"tempreadings"),A.addLayer({id:"humidreadings",type:"symbol",source:"observations",minzoom:10,filter:["all",["has","relative_humidity"],[">","relative_humidity",0]],layout:{"text-field":"{relative_humidity}%","text-ignore-placement":!0,"text-size":["interpolate",["linear"],["zoom"],8,8,14,14*1.1],"text-offset":[0,-1.2],"text-padding":0},paint:{"text-color":"orange","text-halo-color":"#000","text-halo-width":1.5}}),A.addLayer({id:"rainreadings",type:"symbol",source:"observations",minzoom:12,filter:["all",["has","rain_mm"],[">","rain_mm",0]],layout:{"text-field":"{rain_mm}mm","text-size":["interpolate",["linear"],["zoom"],8,8,14,14*1.1],"text-ignore-placement":!0,"text-offset":[0,1.2],"text-padding":0},paint:{"text-color":"aqua","text-halo-color":"#000","text-halo-width":1.5}}),N(V,12e4,!0),A.addLayer({id:"bbox",type:"fill",source:{type:"geojson",tolerance:10,buffer:0,data:P},paint:{"fill-color":"rgba(0,0,0,.5)","fill-antialias":!1}},t)})(),"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js")});const te=navigator.vendor&&-1!==navigator.vendor.indexOf("Apple");te&&setTimeout(function(){const e=window.devicePixelRatio,t=document.createElement("canvas"),n=t.width=window.screen.width*e,o=t.height=window.screen.height*e,a=t.getContext("2d");a.fillStyle="#343332",a.fillRect(0,0,n,o);const i=new Image;i.onload=(()=>{const e=i.width/i.height;i.width=n/2,i.height=n/2/e,a.drawImage(i,(n-i.width)/2,(o-i.height)/2,i.width,i.height),document.head.insertAdjacentHTML("beforeend",`<link rel="apple-touch-startup-image" href="${t.toDataURL()}">`)}),i.src=d.default},5e3);
},{"preact":"u8ui","preact/hooks":"qsmZ","react-use/lib/useInterval":"Uf5o","react-use/lib/useRafState":"hVOD","d3-contour/src/contours":"oKpg","nano-memoize":"sajJ","@turf/helpers":"il2D","firebase/app":"YEwQ","firebase/firestore":"MGW6","./assets/arrow-down-white.png":"v51U","./icons/icon-standalone.svg":"n7hx","./utils/chaikin":"wqla","./sw.js":[["sw.js","NqYy"],"sw.js.map","NqYy"]}]},{},["A2T1"], null)
//# sourceMappingURL=/app.eb27b14c.js.map